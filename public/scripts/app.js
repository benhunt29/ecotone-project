var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(t,e,o,n){o.html5Mode(!0),t.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),e.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$http","$mdDialog",function(t,e){function o(t){console.log("Text changed to ",t)}function n(t){void 0==t&&(s.category="",s.subcategory="",s.warmId="",s.weight="",s.conversion="",s.result="")}function r(){var e={warmId:s.warmId||s.category.secondaries[0].warm_id,weight:parseFloat(s.weight)*s.conversion};t.post("/calculations",e).then(function(t){s.result=Math.floor(1e3*Math.abs(t.data))/1e3})}function l(t){return t?s.list.filter(a(t)):s.list}function a(t){var e=t.toLowerCase();return function(t){return-1!=t.primary_cat.indexOf(e)}}function c(){console.log("SUBMIT!"),console.log(s.submission),t.post("/suggestion",s.submission).then(function(t){e.hide()})}function i(t){console.log("NEW SUGGESTION!",s.searchText),e.show({templateUrl:"/views/submit-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:s.searchText}})}t.get("/materials").then(function(t){var e=t.data;e.forEach(function(t){t.primary_cat=t.primary_cat.toLowerCase()}),s.list=e});var s=this;s.list="",s.result="",s.querySearch=l,s.selectedItemChange=n,s.searchTextChange=o,s.newSuggestion=i,s.submitSuggestion=c,s.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],s.submission={email:"",material:"",notes:""},s.newCalculation=r}]),app.controller("adminCtrl",["$http",function(t){function e(e){var n=e.id;console.log(n),t.put("/suggestion/complete/"+n).then(function(t){o()})}function o(){t.get("/suggestion").then(function(t){var e=t.data;console.log(e),n.suggestions=e})}o();var n=this;n.suggestions="",n.markComplete=e}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(t,e,o){t.user={},t.processForm=function(n){console.log("Posting..."),e({method:"POST",url:"/register",data:t.user,dataType:"json"}).then(function(t){console.log(t),o.path("/login"),alert("Your account has been created.")})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,o,n,r){t.login=function(){e({method:"POST",url:"/login",data:t.form}).then(function(t){o.saveToken(t.data.token),r.user=o.getUser(),n.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(t,e,o,n,r){o.user=t.getUser(),o.user&&o.user.username&&n.path("/"),e.logout=function(){t.logout(),o.user=t.getUser(),n.path("/")}}]),app.controller("projectsCtrl",["$scope","$http",function(t,e){e.get("/project").then(function(e){console.log(e),t.projectList=e.data}),t.deleteProjectItem=function(o){console.log("Deleting...",t.projectlist.lineID),e.update("/project").then(function(t){console.log("Item was deleted.",t)})}}]),app.controller("dashboardCtrl",["$scope","$http",function(t,e){e.get("/project").then(function(e){console.log(e),t.projectList=e.data})}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var o=e.split(".")[1],n=o.replace("-","+").replace("_","/");return JSON.parse(t.atob(n))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e,console.log("Saved token:",t.localStorage.jwtToken)},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),o=Math.round((new Date).getTime()/1e3)<=e.exp;return o||this.logout(),o}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,o){return{request:function(t){return t.headers=t.headers||{},o.isAuthed()&&(t.headers.Authorization="Bearer "+o.getToken()),t},response:function(o){return 401===o.status&&e.path("/login"),o||t.when(o)},responseError:function(o){return 401===o.status?e.path("/login"):console.log(o),t.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkaHR0cCIsIiRtZERpYWxvZyIsInNlYXJjaFRleHRDaGFuZ2UiLCJ0ZXh0IiwiY29uc29sZSIsImxvZyIsInNlbGVjdGVkSXRlbUNoYW5nZSIsIml0ZW0iLCJ1bmRlZmluZWQiLCJzZWxmIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1JZCIsIndlaWdodCIsImNvbnZlcnNpb24iLCJyZXN1bHQiLCJuZXdDYWxjdWxhdGlvbiIsImNhbGN1bGF0ZSIsInNlY29uZGFyaWVzIiwid2FybV9pZCIsInBhcnNlRmxvYXQiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwiTWF0aCIsImZsb29yIiwiYWJzIiwiZGF0YSIsInF1ZXJ5U2VhcmNoIiwicXVlcnkiLCJsaXN0IiwiZmlsdGVyIiwiY3JlYXRlRmlsdGVyRm9yIiwibG93ZXJjYXNlUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsIm9iaiIsInByaW1hcnlfY2F0IiwiaW5kZXhPZiIsInN1Ym1pdFN1Z2dlc3Rpb24iLCJzdWJtaXNzaW9uIiwicmVzIiwiaGlkZSIsIm5ld1N1Z2dlc3Rpb24iLCJzdWdnZXN0aW9uIiwic2VhcmNoVGV4dCIsInNob3ciLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiY29udHJvbGxlckFzIiwibG9jYWxzIiwibWF0ZXJpYWwiLCJnZXQiLCJmb3JFYWNoIiwidGhpcyIsInVuaXRzIiwibmFtZSIsImVtYWlsIiwibm90ZXMiLCJtYXJrQ29tcGxldGUiLCJpZCIsInB1dCIsImluaXQiLCJzdWdnZXN0aW9ucyIsIiRzY29wZSIsIiRsb2NhdGlvbiIsInVzZXIiLCJwcm9jZXNzRm9ybSIsIm1ldGhvZCIsInVybCIsImRhdGFUeXBlIiwicGF0aCIsImFsZXJ0IiwiYXV0aFNlcnZpY2UiLCIkcm9vdFNjb3BlIiwibG9naW4iLCJmb3JtIiwic2F2ZVRva2VuIiwidG9rZW4iLCJnZXRVc2VyIiwidXNlcm5hbWUiLCJsb2dvdXQiLCJwcm9qZWN0TGlzdCIsImRlbGV0ZVByb2plY3RJdGVtIiwibGluZUlEIiwicHJvamVjdGxpc3QiLCJ1cGRhdGUiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInBhcnNlSnd0IiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiZ2V0VG9rZW4iLCJpc0F1dGhlZCIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwiZmFjdG9yeSIsIiRxIiwicmVxdWVzdCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwic3RhdHVzIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsS0FBTUMsUUFBUUMsT0FBTyxjQUFlLFVBQVcsYUFBYyxhQUFjLG9CQUUvRUYsS0FBSUcsUUFBUSxxQkFBc0IsaUJBQWtCLG9CQUFxQixnQkFBaUIsU0FBU0MsRUFBb0JDLEVBQWdCQyxFQUFtQkMsR0FDdEpELEVBQWtCRSxXQUFVLEdBRzVCSixFQUFtQkssTUFBTSxXQUNwQkMsZUFBZSxTQUNmQyxjQUFjLGFBQWNDLFVBQVUsUUFDdENDLFlBQWEsVUFHbEJSLEVBQWVTLEtBQUssS0FFWkMsWUFBYSx5QkFDYkMsV0FBWSwwQkFDYkYsS0FBSyxVQUVKQyxZQUFhLG9CQUNiQyxXQUFZLGNBQ2JGLEtBQUssYUFFSkMsWUFBYSx1QkFDYkMs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LElBQ0RoRCxLQUFLMkIsU0FFRnFCLEVBRVAsT0FBTyxHQUlmaEQsS0FBSzJCLE9BQVMsaUJBQ0hPLEdBQVFTLGFBQWFDLFVBSWhDNUMsS0FBS3lCLFFBQVUsV0FDWCxNQUFPekIsTUFBS21DLFNBQVNuQyxLQUFLNkMsZ0JBSWxDcEgsSUFBSTRILFFBQVEsbUJBQW9CLEtBQU0sWUFBYSxjQUFlLFNBQVVDLEVBQUkzQyxFQUFXUSxHQUN2RixPQUNJb0MsUUFBUyxTQUFVM0gsR0FLZixNQUpBQSxHQUFPNEgsUUFBVTVILEVBQU80SCxZQUNwQnJDLEVBQVkyQixhQUNabEgsRUFBTzRILFFBQVFDLGNBQWdCLFVBQVl0QyxFQUFZMEIsWUFFcERqSCxHQUVYdUMsU0FBVSxTQUFVQSxHQU9oQixNQUx3QixPQUFwQkEsRUFBU3VGLFFBR1QvQyxFQUFVTSxLQUFLLFVBRVo5QyxHQUFZbUYsRUFBRy9HLEtBQUs0QixJQUM1QndGLGNBQWUsU0FBVXhGLEdBT3hCLE1BTndCLE9BQXBCQSxFQUFTdUYsT0FDVC9DLEVBQVVNLEtBQUssVUFHZmpFLFFBQVFDLElBQUlrQixHQUVUbUYsRUFBR00sT0FBT3pGIiwiZmlsZSI6InNjcmlwdHMvYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdlY290b25lQXBwJywgWyduZ1JvdXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcycsICd2YWxpZGF0aW9uLm1hdGNoJ10pO1xuXG5hcHAuY29uZmlnKFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywgJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJGh0dHBQcm92aWRlcil7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy9zZXQgdGhlbWUgYW5kIGNvbG9yIHBhbGV0dGVcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2dyZWVuJylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2JsdWUtZ3JleScsIHsnZGVmYXVsdCc6JzYwMCd9KVxuICAgICAgICAud2FyblBhbGV0dGUgKCdvcmFuZ2UnKTtcblxuICAgIC8vcm91dGVzIGZvciB2aWV3c1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jYWxjdWxhdG9yLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhbGN1bGF0ZUN0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FkbWluJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWRtaW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWRtaW5DdHJsIGFzIGN0cmwnXG5cbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwnXG4gICAgICAgIH0pLndoZW4oJy9wcm9qZWN0cycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2plY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWJvdXQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hYm91dC5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcHJpdmFjeScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3ByaXZhY3kuaHRtbCdcbiAgICAgICAgfSkud2hlbignL3NvdXJjZXMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zb3VyY2VzLmh0bWwnXG4gICAgICAgIH0pLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG5cbiAgICAvLyRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignY2FsY3VsYXRlQ3RybCcsIFsnJGh0dHAnLCAnJG1kRGlhbG9nJywgZnVuY3Rpb24oICRodHRwLCAkbWREaWFsb2cgKSB7XG4gICAgLy8gSU5JVFxuICAgICRodHRwLmdldCgnL21hdGVyaWFscycpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgdmFyIGxpc3QgPSByZXNwb25zZS5kYXRhO1xuXG4gICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgIGl0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAvLyAvaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBpdGVtLnByaW1hcnlfY2F0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYubGlzdCA9IGxpc3Q7XG5cbiAgICB9KTtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5saXN0ID0gJyc7XG4gICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICBzZWxmLnF1ZXJ5U2VhcmNoID0gcXVlcnlTZWFyY2g7XG4gICAgc2VsZi5zZWxlY3RlZEl0ZW1DaGFuZ2UgPSBzZWxlY3RlZEl0ZW1DaGFuZ2U7XG4gICAgc2VsZi5zZWFyY2hUZXh0Q2hhbmdlICAgPSBzZWFyY2hUZXh0Q2hhbmdlO1xuICAgIHNlbGYubmV3U3VnZ2VzdGlvbiA9IG5ld1N1Z2dlc3Rpb247XG4gICAgc2VsZi5zdWJtaXRTdWdnZXN0aW9uID0gc3VibWl0U3VnZ2VzdGlvbjtcbiAgICBzZWxmLnVuaXRzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnbGJzJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDAuMDAwNVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAna2lsb3MnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDExMDIzMVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAndG9ucycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdtZXRyaWMgdG9ucycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAxLjEwMjMxXG4gICAgICAgIH1cbiAgICBdO1xuICAgIHNlbGYuc3VibWlzc2lvbiA9IHtcbiAgICAgICAgZW1haWw6ICcnLFxuICAgICAgICBtYXRlcmlhbDogJycsXG4gICAgICAgIG5vdGVzOiAnJ1xuICAgIH07XG4gICAgc2VsZi5uZXdDYWxjdWxhdGlvbiA9IG5ld0NhbGN1bGF0aW9uO1xuXG5cbiAgICBmdW5jdGlvbiBzZWFyY2hUZXh0Q2hhbmdlKHRleHQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1RleHQgY2hhbmdlZCB0byAnLCB0ZXh0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1DaGFuZ2UoaXRlbSkge1xuICAgICAgICBpZiAoIGl0ZW0gPT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgc2VsZi5jYXRlZ29yeSA9ICcnO1xuICAgICAgICAgICAgc2VsZi5zdWJjYXRlZ29yeSA9ICcnO1xuICAgICAgICAgICAgc2VsZi53YXJtSWQgPSAnJztcbiAgICAgICAgICAgIHNlbGYud2VpZ2h0ID0gJyc7XG4gICAgICAgICAgICBzZWxmLmNvbnZlcnNpb24gPSAnJztcbiAgICAgICAgICAgIHNlbGYucmVzdWx0ID0gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXdDYWxjdWxhdGlvbigpIHtcblxuICAgICAgICB2YXIgY2FsY3VsYXRlID0ge1xuICAgICAgICAgICAgd2FybUlkOiBzZWxmLndhcm1JZCB8fCBzZWxmLmNhdGVnb3J5LnNlY29uZGFyaWVzWzBdLndhcm1faWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoc2VsZi53ZWlnaHQpICogc2VsZi5jb252ZXJzaW9uXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2NhbGN1bGF0aW9ucycsIGNhbGN1bGF0ZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgc2VsZi5yZXN1bHQgPSBNYXRoLmZsb29yKE1hdGguYWJzKHJlc3BvbnNlLmRhdGEpICogMTAwMCkgLyAxMDAwO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzYXZlVG9Qcm9qZWN0KCl7XG4gICAgICAgIHZhciBsaW5lSXRlbSA9IHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiBzZWxmLmNhdGVnb3J5LFxuICAgICAgICAgICAgc3ViY2F0ZWdvcnk6IHNlbGYuc3ViY2F0ZWdvcnksXG4gICAgICAgICAgICB3YXJtX0lkOiBzZWxmLndhcm1JZCxcbiAgICAgICAgICAgIHdlaWdodDogcGFyc2VGbG9hdChzZWxmLndlaWdodCkqc2VsZi5jb252ZXJzaW9uLFxuICAgICAgICAgICAgdW5pdHM6IHNlbGYudW5pdC5uYW1lXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKGxpbmVJdGVtKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FkZFRvUHJvamVjdCcpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcXVlcnlTZWFyY2gocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5ID8gc2VsZi5saXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSA6IHNlbGYubGlzdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy9xdWVyeS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHF1ZXJ5LnNsaWNlKDEpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyRm4ob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gKG9iai5wcmltYXJ5X2NhdC5pbmRleE9mKGxvd2VyY2FzZVF1ZXJ5KSAhPSAtMSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3VibWl0U3VnZ2VzdGlvbigpe1xuICAgICAgICBjb25zb2xlLmxvZygnU1VCTUlUIScpO1xuICAgICAgICBjb25zb2xlLmxvZyhzZWxmLnN1Ym1pc3Npb24pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvc3VnZ2VzdGlvbicsIHNlbGYuc3VibWlzc2lvbikudGhlbihmdW5jdGlvbiggcmVzICl7XG4gICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld1N1Z2dlc3Rpb24oIHN1Z2dlc3Rpb24gKXtcbiAgICAgICAgY29uc29sZS5sb2coJ05FVyBTVUdHRVNUSU9OIScsIHNlbGYuc2VhcmNoVGV4dCk7XG5cbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3Mvc3VibWl0LW1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgICAgICAgICAgbG9jYWxzOiB7bWF0ZXJpYWw6IHNlbGYuc2VhcmNoVGV4dH1cbiAgICAgICAgfSlcblxuICAgIH1cblxuXG59XSk7XG5cbi8qKlxuICogQURNSU5cbiAqL1xuYXBwLmNvbnRyb2xsZXIoJ2FkbWluQ3RybCcsIFsnJGh0dHAnLCBmdW5jdGlvbiggJGh0dHAgKXtcbiAgICAvLyBJTklUXG4gICAgaW5pdCgpO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuc3VnZ2VzdGlvbnMgPSAnJztcbiAgICBzZWxmLm1hcmtDb21wbGV0ZSA9IG1hcmtDb21wbGV0ZTtcblxuICAgIGZ1bmN0aW9uIG1hcmtDb21wbGV0ZSggc3VnZ2VzdGlvbiApIHtcbiAgICAgICAgdmFyIGlkID0gc3VnZ2VzdGlvbi5pZDtcbiAgICAgICAgY29uc29sZS5sb2coaWQpO1xuICAgICAgICAkaHR0cC5wdXQoJy9zdWdnZXN0aW9uL2NvbXBsZXRlLycgKyBpZCkudGhlbihmdW5jdGlvbiggcmVzICkge1xuICAgICAgICAgICAgaW5pdCgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAkaHR0cC5nZXQoJy9zdWdnZXN0aW9uJykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICB2YXIgc3VnZ2VzdGlvbnMgPSByZXMuZGF0YTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN1Z2dlc3Rpb25zKTtcbiAgICAgICAgICAgIHNlbGYuc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucztcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cbn1dKTtcblxuLy8gUmVnaXN0ZXIgSFRNTCAtIE1hZGVsaW5lXG5hcHAuY29udHJvbGxlcignY3JlYXRlQWNjb3VudEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUudXNlciA9IHt9O1xuXG4gICAgJHNjb3BlLnByb2Nlc3NGb3JtID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJQb3N0aW5nLi4uXCIpO1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUudXNlcixcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICAgICAgICAgIGFsZXJ0KFwiWW91ciBhY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQuXCIpXG4gICAgICAgIH0pXG4gICAgfTtcbn1dKTtcblxuXG4vLyBMb2dpbiBIVE1MIC0gS2F0ZVxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSkge1xuICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLmZvcm1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YS50b2tlbik7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICB9KVxuICAgIH1cbn1dKTtcblxuLy8gQ2hhbmdlIE5hdmlnYXRpb24gT3B0aW9ucyB3aXRoIExvZ2luXG5hcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCAnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJywgJyRodHRwJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsICRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCAkaHR0cCl7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgfVxufV0pO1xuXG4vLyBQcm9qZWN0IEhUTUwgLSBEYXNoYm9hcmQgSFRNTCAtIEtpbVxuYXBwLmNvbnRyb2xsZXIoJ3Byb2plY3RzQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgICRodHRwLmdldCgnL3Byb2plY3QnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICRzY29wZS5wcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vcmVzcG9uc2UuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAvLyAgICBpdGVtLnByb2plY3RfbmFtZSA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcblxuICAgICRzY29wZS5kZWxldGVQcm9qZWN0SXRlbSA9IGZ1bmN0aW9uIChsaW5lSUQpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEZWxldGluZy4uLlwiLCAkc2NvcGUucHJvamVjdGxpc3QubGluZUlEKTtcbiAgICAgICAgJGh0dHAudXBkYXRlKCcvcHJvamVjdCcpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAvL2ZpbmRPbmUgYW5kIGRlbGV0ZSBieSBJRCB1c2luZyBwcm9qZWN0bGlzdC5saW5lSURcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXRlbSB3YXMgZGVsZXRlZC5cIiwgcmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8kc2NvcGUuY2FsY3VsYXRlUHJvamVjdFRvdGFsKCl7XG4gICAgICAgIC8vLy9mb3JFYWNoIHByb2plY3RcbiAgICAgICAgLy8gICAgdmFyIHByb2plY3RUb3RhbCs9cHJvamVjdExpc3QuY28yX29mZnNldDtcbiAgICAgICAgLy8gICAgcmV0dXJuIHByb2plY3RUb3RhbDtcbiAgICAgICAgLy8vL3NhdmUgdG8gcHJvamVjdD8gb3IganVzdCByZWNhbGMgZWFjaCB0aW1lP1xuICAgICAgICAvL31cbiAgICB9O1xufV0pO1xuXG5cbi8vRGFzaGJvYXJkIFBhZ2UgLSBLaW0vTWFkZWxlaW5lXG5hcHAuY29udHJvbGxlcignZGFzaGJvYXJkQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vbG9hZCBwcm9qZWN0IGxpc3Qgb24gcGFnZSBsb2FkXG4gICAgJGh0dHAuZ2V0KCcvcHJvamVjdCcpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAkc2NvcGUucHJvamVjdExpc3QgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAvL3Jlc3BvbnNlLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgLy8gICAgaXRlbS5wcm9qZWN0X25hbWUgPSBpdGVtLnByaW1hcnlfY2F0LnRvTG93ZXJDYXNlKCk7XG4gICAgfSk7XG59XSk7XG5cblxuLy8gU2VydmljZXMgZm9yIGF1dGhlbnRpY2F0aW9uXG5hcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdyl7XG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSk7XG5cbmFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
