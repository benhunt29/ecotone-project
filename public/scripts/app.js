var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(t,e,o,r){o.html5Mode(!0),t.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),e.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:""}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$http",function(t){function e(t){console.log("Text changed to ",t)}function o(t){void 0==t&&(l.category="",l.subcategory="",l.warmId="",l.weight="",l.conversion="",l.result="")}function r(){var e={warmId:l.warmId||l.category.secondaries[0].warm_id,weight:parseFloat(l.weight)*l.conversion};t.post("/calculations",e).then(function(t){l.result=Math.floor(1e3*Math.abs(t.data))/1e3})}function n(t){return t?l.list.filter(a(t)):l.list}function a(t){var e=t.toLowerCase();return function(t){return-1!=t.primary_cat.indexOf(e)}}t.get("/materials").then(function(t){var e=t.data;e.forEach(function(t){t.primary_cat=t.primary_cat.toLowerCase()}),l.list=e});var l=this;l.list="",l.result="",l.querySearch=n,l.selectedItemChange=o,l.searchTextChange=e,l.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],l.newCalculation=r}]),app.controller("adminCtrl",["$http",function(t){t.get("/suggestions").then(function(t){var o=t.data;console.log(o),e.suggestions=o});var e=this;e.suggestions=""}]),app.controller("loginCtrl",["$scope","$http","authService",function(t,e,o){t.login=function(){e({method:"POST",url:"/login",data:t.user}).then(function(t){o.saveToken(t.data.token)})}}]),app.controller("createAccountCtrl",["$scope","$http",function(t,e){t.user={},t.processForm=function(o){console.log("Posting..."),e({method:"POST",url:"/register",data:t.user,dataType:"json"}).then(function(t){console.log(t),alert("Your account has been created.")})}}]),app.controller("projectsCtrl",["$scope","$http",function(t,e){e.get("/project").then(function(e){console.log(e),t.projectList=e.data})}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var o=e.split(".")[1],r=o.replace("-","+").replace("_","/");return JSON.parse(t.atob(r))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e,console.log("Saved token:",t.localStorage.jwtToken)},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),o=Math.round((new Date).getTime()/1e3)<=e.exp;return o||this.logout(),o}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,o){return{request:function(t){return t.headers=t.headers||{},o.isAuthed()&&(t.headers.Authorization="Bearer "+o.getToken()),t},response:function(o){return 401===o.status&&e.path("/login"),o||t.when(o)},responseError:function(o){return 401===o.status?e.path("/login"):console.log(o),t.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkaHR0cCIsInNlYXJjaFRleHRDaGFuZ2UiLCJ0ZXh0IiwiY29uc29sZSIsImxvZyIsInNlbGVjdGVkSXRlbUNoYW5nZSIsIml0ZW0iLCJ1bmRlZmluZWQiLCJzZWxmIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1JZCIsIndlaWdodCIsImNvbnZlcnNpb24iLCJyZXN1bHQiLCJuZXdDYWxjdWxhdGlvbiIsImNhbGN1bGF0ZSIsInNlY29uZGFyaWVzIiwid2FybV9pZCIsInBhcnNlRmxvYXQiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwiTWF0aCIsImZsb29yIiwiYWJzIiwiZGF0YSIsInF1ZXJ5U2VhcmNoIiwicXVlcnkiLCJsaXN0IiwiZmlsdGVyIiwiY3JlYXRlRmlsdGVyRm9yIiwibG93ZXJjYXNlUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsIm9iaiIsInByaW1hcnlfY2F0IiwiaW5kZXhPZiIsImdldCIsImZvckVhY2giLCJ0aGlzIiwidW5pdHMiLCJuYW1lIiwicmVzIiwic3VnZ2VzdGlvbnMiLCIkc2NvcGUiLCJhdXRoU2VydmljZSIsImxvZ2luIiwibWV0aG9kIiwidXJsIiwidXNlciIsInNhdmVUb2tlbiIsInRva2VuIiwicHJvY2Vzc0Zvcm0iLCJkYXRhVHlwZSIsImFsZXJ0IiwicHJvamVjdExpc3QiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInBhcnNlSnd0IiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiZ2V0VG9rZW4iLCJpc0F1dGhlZCIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImZhY3RvcnkiLCIkcSIsIiRsb2NhdGlvbiIsInJlcXVlc3QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsInN0YXR1cyIsInBhdGgiLCJyZXNwb25zZUVycm9yIiwicmVqZWN0Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxLQUFNQyxRQUFRQyxPQUFPLGNBQWUsVUFBVyxhQUFjLGNBRWpFRixLQUFJRyxRQUFRLHFCQUFzQixpQkFBa0Isb0JBQXFCLGdCQUFpQixTQUFTQyxFQUFvQkMsRUFBZ0JDLEVBQW1CQyxHQUN0SkQsRUFBa0JFLFdBQVUsR0FHNUJKLEVBQW1CSyxNQUFNLFdBQ3BCQyxlQUFlLFNBQ2ZDLGNBQWMsYUFBY0MsVUFBVSxRQUN0Q0MsWUFBYSxVQUdsQlIsRUFBZVMsS0FBSyxLQUVaQyxZQUFhLHlCQUNiQyxXQUFZLDBCQUNiRixLQUFLLFVBRUpDLFlBQWEsb0JBQ2JDLFdBQVksS0FDYkYsS0FBSyxhQUVKQyxZQUFhLHVCQUNiQyxXQUFZLHNCQUNiRixLQUFLLFVBRUpDLFlBQWEsb0JBQ2JDLFdBQVksc0JBRWJGLEtBQUssWUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxLQUNiRixLQUFLLGNBRUpDLFlBQWEsd0JBQ2JDLFdBQVksaUJBQ2JGLEtBQUssYUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxpQkFDYkYsS0FBSyxVQUVKQyxZQUFhLHNCQUNkRCxLQUFLLFlBRUpDLFlBQWEsc0JBQ2JDLFdBQVksS0FDYkYsS0FBSyxZQUVKQyxZQUFhLHdCQUNkRCxLQUFLLFlBRUpDLFlBQWEsd0JBQ2RFLFdBQ0NDLFdBQVksU0FNeEJsQixJQUFJZ0IsV0FBVyxpQkFBa0IsUUFB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Iiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdlY290b25lQXBwJywgWyduZ1JvdXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcyddKTtcblxuYXBwLmNvbmZpZyhbJyRtZFRoZW1pbmdQcm92aWRlcicsICckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJG1kVGhlbWluZ1Byb3ZpZGVyLCAkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpe1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vc2V0IHRoZW1lIGFuZCBjb2xvciBwYWxldHRlXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcbiAgICAgICAgLnByaW1hcnlQYWxldHRlKCdncmVlbicpXG4gICAgICAgIC5hY2NlbnRQYWxldHRlKCdibHVlLWdyZXknLCB7J2RlZmF1bHQnOic2MDAnfSlcbiAgICAgICAgLndhcm5QYWxldHRlICgnb3JhbmdlJyk7XG5cbiAgICAvL3JvdXRlcyBmb3Igdmlld3NcbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY2FsY3VsYXRvci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsIGFzIGN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9sb2dpbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL3JlZ2lzdGVyJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcmVnaXN0ZXIuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY3JlYXRlQWNjb3VudEN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9hZG1pbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2FkbWluLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2FkbWluQ3RybCBhcyBjdHJsJ1xuXG4gICAgICAgIH0pLndoZW4oJy9hY2NvdW50JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWNjb3VudC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9kYXNoYm9hcmQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcHJvamVjdHMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcm9qZWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RzQ3RybCdcbiAgICAgICAgfSkud2hlbignL2Fib3V0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWJvdXQuaHRtbCdcbiAgICAgICAgfSkud2hlbignL2NvbnRhY3QnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jb250YWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL3ByaXZhY3knLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcml2YWN5Lmh0bWwnXG4gICAgICAgIH0pLndoZW4oJy9zb3VyY2VzJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3Mvc291cmNlcy5odG1sJ1xuICAgICAgICB9KS5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICAgIH0pO1xuXG4gICAgLy8kaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdhdXRoSW50ZXJjZXB0b3InKTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2NhbGN1bGF0ZUN0cmwnLCBbJyRodHRwJywgZnVuY3Rpb24oICRodHRwICkge1xuICAgIC8vIElOSVRcbiAgICAkaHR0cC5nZXQoJy9tYXRlcmlhbHMnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHZhciBsaXN0ID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICBpdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgLy8gL2l0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgaXRlbS5wcmltYXJ5X2NhdC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLmxpc3QgPSBsaXN0O1xuXG4gICAgfSk7XG5cbiAgICAvLyBTZWxmIGRlY1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHNlbGYubGlzdCA9ICcnO1xuICAgIHNlbGYucmVzdWx0ID0gJyc7XG4gICAgc2VsZi5xdWVyeVNlYXJjaCA9IHF1ZXJ5U2VhcmNoO1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtQ2hhbmdlID0gc2VsZWN0ZWRJdGVtQ2hhbmdlO1xuICAgIHNlbGYuc2VhcmNoVGV4dENoYW5nZSAgID0gc2VhcmNoVGV4dENoYW5nZTtcbiAgICBzZWxmLnVuaXRzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnbGJzJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDAuMDAwNVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAna2lsb3MnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDExMDIzMVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAndG9ucycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdtZXRyaWMgdG9ucycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAxLjEwMjMxXG4gICAgICAgIH1cbiAgICBdO1xuICAgIHNlbGYubmV3Q2FsY3VsYXRpb24gPSBuZXdDYWxjdWxhdGlvbjtcblxuXG4gICAgZnVuY3Rpb24gc2VhcmNoVGV4dENoYW5nZSh0ZXh0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IGNoYW5nZWQgdG8gJywgdGV4dCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlKGl0ZW0pIHtcbiAgICAgICAgaWYgKCBpdGVtID09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHNlbGYuY2F0ZWdvcnkgPSAnJztcbiAgICAgICAgICAgIHNlbGYuc3ViY2F0ZWdvcnkgPSAnJztcbiAgICAgICAgICAgIHNlbGYud2FybUlkID0gJyc7XG4gICAgICAgICAgICBzZWxmLndlaWdodCA9ICcnO1xuICAgICAgICAgICAgc2VsZi5jb252ZXJzaW9uID0gJyc7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3Q2FsY3VsYXRpb24oKSB7XG5cbiAgICAgICAgdmFyIGNhbGN1bGF0ZSA9IHtcbiAgICAgICAgICAgIHdhcm1JZDogc2VsZi53YXJtSWQgfHwgc2VsZi5jYXRlZ29yeS5zZWNvbmRhcmllc1swXS53YXJtX2lkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSAqIHNlbGYuY29udmVyc2lvblxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9jYWxjdWxhdGlvbnMnLCBjYWxjdWxhdGUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHNlbGYucmVzdWx0ID0gTWF0aC5mbG9vcihNYXRoLmFicyhyZXNwb25zZS5kYXRhKSAqIDEwMDApIC8gMTAwMDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVRvUHJvamVjdCgpe1xuICAgICAgICB2YXIgbGluZUl0ZW0gPSB7XG4gICAgICAgICAgICBjYXRlZ29yeTogc2VsZi5jYXRlZ29yeSxcbiAgICAgICAgICAgIHN1YmNhdGVnb3J5OiBzZWxmLnN1YmNhdGVnb3J5LFxuICAgICAgICAgICAgd2FybV9JZDogc2VsZi53YXJtSWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoc2VsZi53ZWlnaHQpKnNlbGYuY29udmVyc2lvbixcbiAgICAgICAgICAgIHVuaXRzOiBzZWxmLnVuaXQubmFtZVxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhsaW5lSXRlbSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9hZGRUb1Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYubGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiBzZWxmLmxpc3Q7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCkgLy9xdWVyeS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHF1ZXJ5LnNsaWNlKDEpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyRm4ob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gKG9iai5wcmltYXJ5X2NhdC5pbmRleE9mKGxvd2VyY2FzZVF1ZXJ5KSAhPSAtMSk7XG4gICAgICAgIH07XG4gICAgfVxufV0pO1xuXG4vKipcbiAqIEFETUlOXG4gKi9cbmFwcC5jb250cm9sbGVyKCdhZG1pbkN0cmwnLCBbJyRodHRwJywgZnVuY3Rpb24oICRodHRwICl7XG4gICAgLy8gSU5JVFxuICAgICRodHRwLmdldCgnL3N1Z2dlc3Rpb25zJykudGhlbihmdW5jdGlvbiggcmVzICkge1xuICAgICAgICB2YXIgc3VnZ2VzdGlvbnMgPSByZXMuZGF0YTtcbiAgICAgICAgY29uc29sZS5sb2coc3VnZ2VzdGlvbnMpO1xuICAgICAgICBzZWxmLnN1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbnM7XG4gICAgfSk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5zdWdnZXN0aW9ucyA9ICcnO1xuXG5cbn1dKTtcblxuLy8gTG9naW4gSFRNTCAtIEthdGVcbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUudXNlclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhLnRva2VuKTtcbiAgICAgICAgfSlcbiAgICB9XG59XSk7XG5cbi8vIFJlZ2lzdGVyIEhUTUwgLSBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUFjY291bnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7XG5cbi8vIFByb2plY3QgSFRNTCAtIERhc2hib2FyZCBIVE1MIC0gS2ltXG5hcHAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgLy9sb2FkIHByb2plY3QgbGlzdCBvbiBwYWdlIGxvYWRcbiAgICAkaHR0cC5nZXQoJy9wcm9qZWN0JykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICRzY29wZS5wcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vcmVzcG9uc2UuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAvLyAgICBpdGVtLnByb2plY3RfbmFtZSA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcblxufV0pO1xuXG4vLyBTZXJ2aWNlcyBmb3IgYXV0aGVudGljYXRpb25cbmFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KXtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
