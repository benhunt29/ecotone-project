<<<<<<< HEAD
var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,n,r){n.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl as ctrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("adminCtrl",["$http","$scope","$parse",function(e,t,n){function r(){var n=t.csv.result;console.log(n),e.post("/bulk",n).then(function(e){console.log(e)})}function o(t){var n=t.id;console.log(n),e.put("/suggestion/complete/"+n).then(function(e){a()})}function a(){e.get("/suggestion").then(function(e){var t=e.data;console.log(t),l.suggestions=t})}a();var l=this;l.suggestions="",l.markComplete=o,l.submitCSV=r,t.csv={content:null,header:!0,headerVisible:!0,separator:",",separatorVisible:!0,result:null,encoding:"ISO-8859-1",encodingVisible:!0};var i="";t.toPrettyJSON=function(e,t){var r=JSON.stringify(e),o=null;try{o=n(r)({})}catch(a){return i}var l=JSON.stringify(o,null,Number(t));return i=l,l}}]),app.controller("calculateCtrl",["$http","$mdDialog","$rootScope","authService","$location",function(e,t,n,r,o){function a(e){console.log("Text changed to ",e)}function l(e){void 0==e&&(h.category="",h.subcategory="",h.warmId="",h.weight="",h.conversion="",h.result="")}function i(){var t={warmId:h.warmId||h.category.secondaries[0].warm_id,weight:parseFloat(h.weight)*h.conversion};e.post("/calculations",t).then(function(e){h.result=Math.floor(1e3*Math.abs(e.data))/1e3})}function s(e){return e?h.list.filter(c(e)):h.list}function c(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function u(){e.post("/suggestion",h.submission).then(function(e){t.hide()})}function p(e){document.getElementById("sidenav").focus(),t.show({templateUrl:"/views/submit-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:h.searchText}})}n.user=r.getUser(),n.user&&n.user.username&&o.path("/"),e.get("/materials").then(function(e){var t=e.data;t.forEach(function(e){e.primary_cat=e.primary_cat.toLowerCase()}),h.list=t});var h=this;h.list="",h.isDisabled=!1,h.result="",h.querySearch=s,h.selectedItemChange=l,h.searchTextChange=a,h.newSuggestion=p,h.submitSuggestion=u,h.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],h.submission={email:"",material:"",notes:""},h.newCalculation=i}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(e,t,n){e.user={},e.processForm=function(r){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),n.path("/login"),alert("Your account has been created.")})}}]),app.directive("ngCsvImport",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{content:"=?",header:"=?",headerVisible:"=?",separator:"=?",separatorVisible:"=?",result:"=?",encoding:"=?",encodingVisible:"=?"},template:'<div><div ng-show="headerVisible"><div class="label">Header</div><input type="checkbox" ng-model="header"></div><div ng-show="encoding && encodingVisible"><div class="label">Encoding</div><span>{{encoding}}</span></div><div ng-show="separator && separatorVisible"><div class="label">Seperator</div><span><input class="separator-input" type="text" ng-change="changeSeparator" ng-model="separator"><span></div><div><input class="btn cta gray" type="file"/></div></div>',link:function(e,t){e.separatorVisible=e.separatorVisible||!1,e.headerVisible=e.headerVisible||!1,angular.element(t[0].querySelector(".separator-input")).on("keyup",function(t){if(null!=e.content){var r={csv:e.content,header:e.header,separator:t.target.value,encoding:e.encoding};e.result=n(r),e.$apply()}}),t.on("change",function(t){var r=new FileReader;if(e.filename=t.target.files[0].name,r.onload=function(t){e.$apply(function(){var r={csv:t.target.result.replace(/\r\n|\r/g,"\n"),header:e.header,separator:e.separator};e.content=r.csv,e.result=n(r),e.result.filename=e.filename})},"file"!==t.target.type||null==t.target.files&&null==t.srcElement.files){if(null!=e.content){var o={csv:e.content,header:!e.header,separator:e.separator};e.result=n(o)}}else r.readAsText((t.srcElement||t.target).files[0],e.encoding)});var n=function(e){var t=e.csv.split("\n"),n=[],r=0,o=t[0].split(e.separator).length,a=[];e.header&&(a=t[0].split(e.separator),r=1);for(var l=r;l<t.length;l++){var i={},s=t[l].split(new RegExp(e.separator+'(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)'));if(s.length===o){if(e.header)for(var c=0;c<a.length;c++)i[a[c]]=s[c];else for(var u=0;u<s.length;u++)i[u]=s[u];n.push(i)}}return n}}}}),app.controller("dashboardCtrl",["$mdDialog","$rootScope","$scope","$http",function(e,t,n,r){var o=t.user;r.get("/project/"+o.id).then(function(e){console.log(e),n.projectList=e.data}),n.showDelete=function(t){console.log("CLICK");var r=e.confirm().title("Are you sure you want to delete your project?").content("This is permanent.").ariaLabel("Delete project permanently").ok("Delete").cancel("Cancel").targetEvent(t);e.show(r).then(function(){n.alert="Your project has been deleted."},function(){n.alert="Your project has not been deleted."})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(e,t,n,r,o){e.login=function(){t({method:"POST",url:"/login",data:e.form}).then(function(e){n.saveToken(e.data.token),o.user=n.getUser(),r.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,n,r,o){n.user=e.getUser(),n.user&&n.user.username&&r.path("/"),t.logout=function(){e.logout(),n.user=e.getUser(),r.path("/")}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){function n(e){return e?i.projectList.filter(r(e)):i.projectList}function r(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function o(e){console.log("Text changed to ",e)}function a(e){void 0==e&&(i.project_name="",i.project_description="")}function l(){console.log("Deleting...",i.projectList.ID)}var i=this;i.projectList="",i.result="",i.querySearch=n,i.selectedItemChange=a,i.searchTextChange=o,i.projectTotal=0,i.deleteProjectItem=l,i.id=0,i.getProjectList=function(){t.get("/project",userid).then(function(e){console.log(e);var t=e.data;t.forEach(function(e){e.project_name=e.project_name.toLowerCase()}),i.projectList=t})},e.showDelete=function(t){console.log("CLICK");var n=$mdDialog.confirm().title("Are you sure you want to delete this item?").content("This will be permanent.").ariaLabel("Delete item permanently").ok("Delete").cancel("Cancel").targetEvent(t);$mdDialog.show(n).then(function(){e.alert="Your item has been deleted."},function(){e.alert="Your item has not been deleted."})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var n=t.split(".")[1],r=n.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),n=Math.round((new Date).getTime()/1e3)<=t.exp;return n||this.logout(),n}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},n.isAuthed()&&(e.headers.Authorization="Bearer "+n.getToken()),e},response:function(n){return 401===n.status&&t.path("/login"),n||e.when(n)},responseError:function(n){return 401===n.status?t.path("/login"):console.log(n),e.reject(n)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzY3JpcHRzL2FkbWluQ3RybC5qcyIsInNjcmlwdHMvY2FsY3VsYXRlQ3RybC5qcyIsInNjcmlwdHMvY3JlYXRlQWNjb3VudEN0cmwuanMiLCJzY3JpcHRzL2NzdkltcG9ydC5qcyIsInNjcmlwdHMvZGFzaGJvYXJkQ3RybC5qcyIsInNjcmlwdHMvbG9naW5DdHJsLmpzIiwic2NyaXB0cy9uYXZDdHJsLmpzIiwic2NyaXB0cy9wcm9qZWN0c0N0cmwuanMiLCJzY3JpcHRzL3NlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkaHR0cCIsIiRzY29wZSIsIiRwYXJzZSIsInN1Ym1pdENTViIsImNzdk9iamVjdCIsImNzdiIsInJlc3VsdCIsImNvbnNvbGUiLCJsb2ciLCJwb3N0IiwidGhlbiIsInJlcyIsIm1hcmtDb21wbGV0ZSIsInN1Z2dlc3Rpb24iLCJpZCIsInB1dCIsImluaXQiLCJnZXQiLCJzdWdnZXN0aW9ucyIsImRhdGEiLCJzZWxmIiwidGhpcyIsImNvbnRlbnQiLCJoZWFkZXIiLCJoZWFkZXJWaXNpYmxlIiwic2VwYXJhdG9yIiwic2VwYXJhdG9yVmlzaWJsZSIsImVuY29kaW5nIiwiZW5jb2RpbmdWaXNpYmxlIiwiX2xhc3RHb29kUmVzdWx0IiwidG9QcmV0dHlKU09OIiwianNvbiIsInRhYldpZHRoIiwib2JqU3RyIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9iaiIsImUiLCJOdW1iZXIiLCIkbWREaWFsb2ciLCIkcm9vdFNjb3BlIiwiYXV0aFNlcnZpY2UiLCIkbG9jYXRpb24iLCJzZWFyY2hUZXh0Q2hhbmdlIiwidGV4dCIsInNlbGVjdGVkSXRlbUNoYW5nZSIsIml0ZW0iLCJ1bmRlZmluZWQiLCJjYXRlZ29yeSIsInN1YmNhdGVnb3J5Iiwid2FybUlkIiwid2VpZ2h0IiwiY29udmVyc2lvbiIsIm5ld0NhbGN1bGF0aW9uIiwiY2FsY3VsYXRlIiwic2Vjb25kYXJpZXMiLCJ3YXJtX2lkIiwicGFyc2VGbG9hdCIsInJlc3BvbnNlIiwiTWF0aCIsImZsb29yIiwiYWJzIiwicXVlcnlTZWFyY2giLCJxdWVyeSIsImxpc3QiLCJmaWx0ZXIiLCJjcmVhdGVGaWx0ZXJGb3IiLCJsb3dlcmNhc2VRdWVyeSIsInRvTG93ZXJDYXNlIiwicHJpbWFyeV9jYXQiLCJpbmRleE9mIiwic3VibWl0U3VnZ2VzdGlvbiIsInN1Ym1pc3Npb24iLCJoaWRlIiwibmV3U3VnZ2VzdGlvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb2N1cyIsInNob3ciLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiY29udHJvbGxlckFzIiwibG9jYWxzIiwibWF0ZXJpYWwiLCJzZWFyY2hUZXh0IiwidXNlciIsImdldFVzZXIiLCJ1c2VybmFtZSIsInBhdGgiLCJmb3JFYWNoIiwiaXNEaXNhYmxlZCIsInVuaXRzIiwibmFtZSIsImVtYWlsIiwibm90ZXMiLCJwcm9jZXNzRm9ybSIsIm1ldGhvZCIsInVybCIsImRhdGFUeXBlIiwiYWxlcnQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInRyYW5zY2x1ZGUiLCJyZXBsYWNlIiwic2NvcGUiLCJ0ZW1wbGF0ZSIsImxpbmsiLCJlbGVtZW50IiwicXVlcnlTZWxlY3RvciIsIm9uIiwidGFyZ2V0IiwidmFsdWUiLCJjc3ZUb0pTT04iLCIkYXBwbHkiLCJvbkNoYW5nZUV2ZW50IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsImZpbGVuYW1lIiwiZmlsZXMiLCJvbmxvYWQiLCJvbkxvYWRFdmVudCIsInR5cGUiLCJzcmNFbGVtZW50IiwicmVhZEFzVGV4dCIsImxpbmVzIiwic3BsaXQiLCJzdGFydCIsImNvbHVtbkNvdW50IiwibGVuZ3RoIiwiaGVhZGVycyIsImkiLCJjdXJyZW50bGluZSIsIlJlZ0V4cCIsImoiLCJrIiwicHVzaCIsInByb2plY3RMaXN0Iiwic2hvd0RlbGV0ZSIsImV2IiwiY29uZmlybSIsInRpdGxlIiwiYXJpYUxhYmVsIiwib2siLCJjYW5jZWwiLCJ0YXJnZXRFdmVudCIsImxvZ2luIiwiZm9ybSIsInNhdmVUb2tlbiIsInRva2VuIiwibG9nb3V0IiwicHJvamVjdF9uYW1lIiwicHJvamVjdF9kZXNjcmlwdGlvbiIsImRlbGV0ZVByb2plY3RJdGVtIiwiSUQiLCJwcm9qZWN0VG90YWwiLCJnZXRQcm9qZWN0TGlzdCIsInVzZXJpZCIsInNlcnZpY2UiLCIkd2luZG93IiwicGFyc2VKd3QiLCJiYXNlNjRVcmwiLCJiYXNlNjQiLCJwYXJzZSIsImF0b2IiLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImZhY3RvcnkiLCIkcSIsInJlcXVlc3QiLCJBdXRob3JpemF0aW9uIiwic3RhdHVzIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxjQUFBLFVBQUEsYUFBQSxhQUFBLG9CQUVBRixLQUFBRyxRQUFBLHFCQUFBLGlCQUFBLG9CQUFBLGdCQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FELEVBQUFFLFdBQUEsR0FHQUosRUFBQUssTUFBQSxXQUNBQyxlQUFBLFNBQ0FDLGNBQUEsYUFBQUMsVUFBQSxRQUNBQyxZQUFBLFVBR0FSLEVBQUFTLEtBQUEsS0FFQUMsWUFBQSx5QkFDQUMsV0FBQSwwQkFDQUYsS0FBQSxVQUVBQyxZQUFBLG9CQUNBQyxXQUFBLGNBQ0FGLEtBQUEsYUFFQUMsWUFBQSx1QkFDQUMsV0FBQSxzQkFDQUYsS0FBQSxVQUVBQyxZQUFBLG9CQUNBQyxXQUFBLHNCQUVBRixLQUFBLFlBRUFDLFlBQUEsc0JBQ0FDLFdBQUEsS0FDQUYsS0FBQSxjQUVBQyxZQUFBLHdCQUNBQyxXQUFBLGtCQUNBRixLQUFBLGFBRUFDLFlBQUEsc0JBQ0FDLFdBQUEseUJBQ0FGLEtBQUEsVUFFQUMsWUFBQSxzQkFDQUQsS0FBQSxZQUVBQyxZQUFBLHNCQUNBQyxXQUFBLEtBQ0FGLEtBQUEsWUFFQUMsWUFBQSx3QkFDQUQsS0FBQSxZQUVBQyxZQUFBLHdCQUNBRSxXQUNBQyxXQUFBLFNDcERBbEIsSUFBQWdCLFdBQUEsYUFBQSxRQUFBLFNBQUEsU0FBQSxTQUFBRyxFQUFBQyxFQUFBQyxHQVNBLFFBQUFDLEtBQ0EsR0FBQUMsR0FBQUgsRUFBQUksSUFBQUMsTUFDQUMsU0FBQUMsSUFBQUosR0FFQUosRUFBQVMsS0FBQSxRQUFBTCxHQUFBTSxLQUFBLFNBQUFDLEdBQ0FKLFFBQUFDLElBQUFHLEtBSUEsUUFBQUMsR0FBQUMsR0FDQSxHQUFBQyxHQUFBRCxFQUFBQyxFQUNBUCxTQUFBQyxJQUFBTSxHQUNBZCxFQUFBZSxJQUFBLHdCQUFBRCxHQUFBSixLQUFBLFNBQUFDLEdBQ0FLLE1BSUEsUUFBQUEsS0FDQWhCLEVBQUFpQixJQUFBLGVBQUFQLEtBQUEsU0FBQUMsR0FDQSxHQUFBTyxHQUFBUCxFQUFBUSxJQUNBWixTQUFBQyxJQUFBVSxHQUNBRSxFQUFBRixZQUFBQSxJQTVCQUYsR0FFQSxJQUFBSSxHQUFBQyxJQUNBRCxHQUFBRixZQUFBLEdBQ0FFLEVBQUFSLGFBQUFBLEVBQ0FRLEVBQUFqQixVQUFBQSxFQTJCQUYsRUFBQUksS0FDQWlCLFFBQUEsS0FDQUMsUUFBQSxFQUNBQyxlQUFBLEVBQ0FDLFVBQUEsSUFDQUMsa0JBQUEsRUFDQXBCLE9BQUEsS0FDQXFCLFNBQUEsYUFDQUMsaUJBQUEsRUFHQSxJQUFBQyxHQUFBLEVBQ0E1QixHQUFBNkIsYUFBQSxTQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLEtBQUFDLFVBQUFKLEdBQ0FLLEVBQUEsSUFDQSxLQUNBQSxFQUFBbEMsRUFBQStCLE9BQ0EsTUFBQUksR0FFQSxNQUFBUixHQUdBLEdBQUF2QixHQUFBNEIsS0FBQUMsVUFBQUMsRUFBQSxLQUFBRSxPQUFBTixHQUdBLE9BRkFILEdBQUF2QixFQUVBQSxNQzlEQXpCLElBQUFnQixXQUFBLGlCQUFBLFFBQUEsWUFBQSxhQUFBLGNBQUEsWUFBQSxTQUFBRyxFQUFBdUMsRUFBQUMsRUFBQUMsRUFBQUMsR0EyREEsUUFBQUMsR0FBQUMsR0FDQXJDLFFBQUFDLElBQUEsbUJBQUFvQyxHQUdBLFFBQUFDLEdBQUFDLEdBQ0FDLFFBQUFELElBQ0ExQixFQUFBNEIsU0FBQSxHQUNBNUIsRUFBQTZCLFlBQUEsR0FDQTdCLEVBQUE4QixPQUFBLEdBQ0E5QixFQUFBK0IsT0FBQSxHQUNBL0IsRUFBQWdDLFdBQUEsR0FDQWhDLEVBQUFkLE9BQUEsSUFJQSxRQUFBK0MsS0FFQSxHQUFBQyxJQUNBSixPQUFBOUIsRUFBQThCLFFBQUE5QixFQUFBNEIsU0FBQU8sWUFBQSxHQUFBQyxRQUNBTCxPQUFBTSxXQUFBckMsRUFBQStCLFFBQUEvQixFQUFBZ0MsV0FHQXBELEdBQUFTLEtBQUEsZ0JBQUE2QyxHQUFBNUMsS0FBQSxTQUFBZ0QsR0FDQXRDLEVBQUFkLE9BQUFxRCxLQUFBQyxNQUFBLElBQUFELEtBQUFFLElBQUFILEVBQUF2QyxPQUFBLE1Ba0JBLFFBQUEyQyxHQUFBQyxHQUNBLE1BQUFBLEdBQUEzQyxFQUFBNEMsS0FBQUMsT0FBQUMsRUFBQUgsSUFBQTNDLEVBQUE0QyxLQUdBLFFBQUFFLEdBQUFILEdBQ0EsR0FBQUksR0FBQUosRUFBQUssYUFFQSxPQUFBLFVBQUFoQyxHQUNBLE1BQUEsSUFBQUEsRUFBQWlDLFlBQUFDLFFBQUFILElBSUEsUUFBQUksS0FDQXZFLEVBQUFTLEtBQUEsY0FBQVcsRUFBQW9ELFlBQUE5RCxLQUFBLFNBQUFDLEdBQ0E0QixFQUFBa0MsU0FJQSxRQUFBQyxHQUFBN0QsR0FDQThELFNBQUFDLGVBQUEsV0FBQUMsUUFFQXRDLEVBQUF1QyxNQUNBbEYsWUFBQSwyQkFDQW1GLHFCQUFBLEVBQ0FsRixXQUFBLGdCQUNBbUYsYUFBQSxPQUNBQyxRQUFBQyxTQUFBOUQsRUFBQStELGNBM0hBM0MsRUFBQTRDLEtBQUEzQyxFQUFBNEMsVUFFQTdDLEVBQUE0QyxNQUFBNUMsRUFBQTRDLEtBQUFFLFVBQ0E1QyxFQUFBNkMsS0FBQSxLQUlBdkYsRUFBQWlCLElBQUEsY0FBQVAsS0FBQSxTQUFBZ0QsR0FDQSxHQUFBTSxHQUFBTixFQUFBdkMsSUFFQTZDLEdBQUF3QixRQUFBLFNBQUExQyxHQUNBQSxFQUFBdUIsWUFBQXZCLEVBQUF1QixZQUFBRCxnQkFJQWhELEVBQUE0QyxLQUFBQSxHQUtBLElBQUE1QyxHQUFBQyxJQUVBRCxHQUFBNEMsS0FBQSxHQUNBNUMsRUFBQXFFLFlBQUEsRUFDQXJFLEVBQUFkLE9BQUEsR0FDQWMsRUFBQTBDLFlBQUFBLEVBQ0ExQyxFQUFBeUIsbUJBQUFBLEVBQ0F6QixFQUFBdUIsaUJBQUFBLEVBQ0F2QixFQUFBc0QsY0FBQUEsRUFDQXRELEVBQUFtRCxpQkFBQUEsRUFDQW5ELEVBQUFzRSxRQUVBQyxLQUFBLE1BQ0F2QyxXQUFBLE9BR0F1QyxLQUFBLFFBQ0F2QyxXQUFBLFlBR0F1QyxLQUFBLE9BQ0F2QyxXQUFBLElBR0F1QyxLQUFBLGNBQ0F2QyxXQUFBLFVBR0FoQyxFQUFBb0QsWUFDQW9CLE1BQUEsR0FDQVYsU0FBQSxHQUNBVyxNQUFBLElBRUF6RSxFQUFBaUMsZUFBQUEsS0N2REF4RSxJQUFBZ0IsV0FBQSxxQkFBQSxTQUFBLFFBQUEsWUFBQSxTQUFBSSxFQUFBRCxFQUFBMEMsR0FDQXpDLEVBQUFtRixRQUVBbkYsRUFBQTZGLFlBQUEsU0FBQVYsR0FDQTdFLFFBQUFDLElBQUEsY0FDQVIsR0FDQStGLE9BQUEsT0FDQUMsSUFBQSxZQUNBN0UsS0FBQWxCLEVBQUFtRixLQUNBYSxTQUFBLFNBQ0F2RixLQUFBLFNBQUFnRCxHQUNBbkQsUUFBQUMsSUFBQWtELEdBQ0FoQixFQUFBNkMsS0FBQSxVQUNBVyxNQUFBLHdDQ2RBckgsSUFBQXNILFVBQUEsY0FBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsWUFBQSxFQUNBQyxTQUFBLEVBQ0FDLE9BQ0FqRixRQUFBLEtBQ0FDLE9BQUEsS0FDQUMsY0FBQSxLQUNBQyxVQUFBLEtBQ0FDLGlCQUFBLEtBQ0FwQixPQUFBLEtBQ0FxQixTQUFBLEtBQ0FDLGdCQUFBLE1BRUE0RSxTQUFBLHFkQUlBQyxLQUFBLFNBQUFGLEVBQUFHLEdBQ0FILEVBQUE3RSxpQkFBQTZFLEVBQUE3RSxtQkFBQSxFQUNBNkUsRUFBQS9FLGNBQUErRSxFQUFBL0UsZ0JBQUEsRUFFQTFDLFFBQUE0SCxRQUFBQSxFQUFBLEdBQUFDLGNBQUEscUJBQUFDLEdBQUEsUUFBQSxTQUFBdkUsR0FDQSxHQUFBLE1BQUFrRSxFQUFBakYsUUFBQSxDQUNBLEdBQUFBLElBQ0FqQixJQUFBa0csRUFBQWpGLFFBQ0FDLE9BQUFnRixFQUFBaEYsT0FDQUUsVUFBQVksRUFBQXdFLE9BQUFDLE1BQ0FuRixTQUFBNEUsRUFBQTVFLFNBRUE0RSxHQUFBakcsT0FBQXlHLEVBQUF6RixHQUNBaUYsRUFBQVMsWUFJQU4sRUFBQUUsR0FBQSxTQUFBLFNBQUFLLEdBQ0EsR0FBQUMsR0FBQSxHQUFBQyxXQWVBLElBZEFaLEVBQUFhLFNBQUFILEVBQUFKLE9BQUFRLE1BQUEsR0FBQTFCLEtBQ0F1QixFQUFBSSxPQUFBLFNBQUFDLEdBQ0FoQixFQUFBUyxPQUFBLFdBQ0EsR0FBQTFGLElBQ0FqQixJQUFBa0gsRUFBQVYsT0FBQXZHLE9BQUFnRyxRQUFBLFdBQUEsTUFDQS9FLE9BQUFnRixFQUFBaEYsT0FDQUUsVUFBQThFLEVBQUE5RSxVQUVBOEUsR0FBQWpGLFFBQUFBLEVBQUFqQixJQUNBa0csRUFBQWpHLE9BQUF5RyxFQUFBekYsR0FDQWlGLEVBQUFqRyxPQUFBOEcsU0FBQWIsRUFBQWEsWUFJQSxTQUFBSCxFQUFBSixPQUFBVyxNQUFBLE1BQUFQLEVBQUFKLE9BQUFRLE9BQUEsTUFBQUosRUFBQVEsV0FBQUosT0FHQSxHQUFBLE1BQUFkLEVBQUFqRixRQUFBLENBQ0EsR0FBQUEsSUFDQWpCLElBQUFrRyxFQUFBakYsUUFDQUMsUUFBQWdGLEVBQUFoRixPQUNBRSxVQUFBOEUsRUFBQTlFLFVBRUE4RSxHQUFBakcsT0FBQXlHLEVBQUF6RixRQVJBNEYsR0FBQVEsWUFBQVQsRUFBQVEsWUFBQVIsRUFBQUosUUFBQVEsTUFBQSxHQUFBZCxFQUFBNUUsV0FhQSxJQUFBb0YsR0FBQSxTQUFBekYsR0FDQSxHQUFBcUcsR0FBQXJHLEVBQUFqQixJQUFBdUgsTUFBQSxNQUNBdEgsS0FDQXVILEVBQUEsRUFDQUMsRUFBQUgsRUFBQSxHQUFBQyxNQUFBdEcsRUFBQUcsV0FBQXNHLE9BRUFDLElBQ0ExRyxHQUFBQyxTQUNBeUcsRUFBQUwsRUFBQSxHQUFBQyxNQUFBdEcsRUFBQUcsV0FDQW9HLEVBQUEsRUFHQSxLQUFBLEdBQUFJLEdBQUFKLEVBQUFJLEVBQUFOLEVBQUFJLE9BQUFFLElBQUEsQ0FDQSxHQUFBN0YsTUFDQThGLEVBQUFQLEVBQUFNLEdBQUFMLE1BQUEsR0FBQU8sUUFBQTdHLEVBQUFHLFVBQUEsc0NBQ0EsSUFBQXlHLEVBQUFILFNBQUFELEVBQUEsQ0FDQSxHQUFBeEcsRUFBQUMsT0FDQSxJQUFBLEdBQUE2RyxHQUFBLEVBQUFBLEVBQUFKLEVBQUFELE9BQUFLLElBQ0FoRyxFQUFBNEYsRUFBQUksSUFBQUYsRUFBQUUsT0FHQSxLQUFBLEdBQUFDLEdBQUEsRUFBQUEsRUFBQUgsRUFBQUgsT0FBQU0sSUFDQWpHLEVBQUFpRyxHQUFBSCxFQUFBRyxFQUdBL0gsR0FBQWdJLEtBQUFsRyxJQUdBLE1BQUE5QixRQzlGQXpCLElBQUFnQixXQUFBLGlCQUFBLFlBQUEsYUFBQSxTQUFBLFFBQUEsU0FBQTBDLEVBQUFDLEVBQUF2QyxFQUFBRCxHQUNBLEdBQUFvRixHQUFBNUMsRUFBQTRDLElBSUFwRixHQUFBaUIsSUFBQSxZQUFBbUUsRUFBQXRFLElBQUFKLEtBQUEsU0FBQWdELEdBQ0FuRCxRQUFBQyxJQUFBa0QsR0FDQXpELEVBQUFzSSxZQUFBN0UsRUFBQXZDLE9BTUFsQixFQUFBdUksV0FBQSxTQUFBQyxHQUVBbEksUUFBQUMsSUFBQSxRQUNBLElBQUFrSSxHQUFBbkcsRUFBQW1HLFVBQ0FDLE1BQUEsaURBQ0FySCxRQUFBLHNCQUNBc0gsVUFBQSw4QkFDQUMsR0FBQSxVQUNBQyxPQUFBLFVBQ0FDLFlBQUFOLEVBQ0FsRyxHQUFBdUMsS0FBQTRELEdBQUFoSSxLQUFBLFdBQ0FULEVBQUFpRyxNQUFBLGtDQUNBLFdBQ0FqRyxFQUFBaUcsTUFBQSwyQ0N6QkFySCxJQUFBZ0IsV0FBQSxhQUFBLFNBQUEsUUFBQSxjQUFBLFlBQUEsYUFBQSxTQUFBSSxFQUFBRCxFQUFBeUMsRUFBQUMsRUFBQUYsR0FDQXZDLEVBQUErSSxNQUFBLFdBQ0FoSixHQUNBK0YsT0FBQSxPQUNBQyxJQUFBLFNBQ0E3RSxLQUFBbEIsRUFBQWdKLE9BQ0F2SSxLQUFBLFNBQUFnRCxHQUNBakIsRUFBQXlHLFVBQUF4RixFQUFBdkMsS0FBQWdJLE9BQ0EzRyxFQUFBNEMsS0FBQTNDLEVBQUE0QyxVQUNBM0MsRUFBQTZDLEtBQUEsV0NUQTFHLElBQUFnQixXQUFBLFdBQUEsY0FBQSxTQUFBLGFBQUEsWUFBQSxRQUFBLFNBQUE0QyxFQUFBeEMsRUFBQXVDLEVBQUFFLEVBQUExQyxHQUNBd0MsRUFBQTRDLEtBQUEzQyxFQUFBNEMsVUFFQTdDLEVBQUE0QyxNQUFBNUMsRUFBQTRDLEtBQUFFLFVBQ0E1QyxFQUFBNkMsS0FBQSxLQUdBdEYsRUFBQW1KLE9BQUEsV0FDQTNHLEVBQUEyRyxTQUNBNUcsRUFBQTRDLEtBQUEzQyxFQUFBNEMsVUFDQTNDLEVBQUE2QyxLQUFBLFNDVkExRyxJQUFBZ0IsV0FBQSxnQkFBQSxTQUFBLFFBQUEsU0FBQUksRUFBQUQsR0E4QkEsUUFBQThELEdBQUFDLEdBQ0EsTUFBQUEsR0FBQTNDLEVBQUFtSCxZQUFBdEUsT0FBQUMsRUFBQUgsSUFBQTNDLEVBQUFtSCxZQUdBLFFBQUFyRSxHQUFBSCxHQUNBLEdBQUFJLEdBQUFKLEVBQUFLLGFBRUEsT0FBQSxVQUFBaEMsR0FDQSxNQUFBLElBQUFBLEVBQUFpQyxZQUFBQyxRQUFBSCxJQUlBLFFBQUF4QixHQUFBQyxHQUNBckMsUUFBQUMsSUFBQSxtQkFBQW9DLEdBR0EsUUFBQUMsR0FBQUMsR0FDQUMsUUFBQUQsSUFDQTFCLEVBQUFpSSxhQUFBLEdBQ0FqSSxFQUFBa0ksb0JBQUEsSUErQkEsUUFBQUMsS0FDQWhKLFFBQUFDLElBQUEsY0FBQVksRUFBQW1ILFlBQUFpQixJQTlFQSxHQUFBcEksR0FBQUMsSUFDQUQsR0FBQW1ILFlBQUEsR0FDQW5ILEVBQUFkLE9BQUEsR0FDQWMsRUFBQTBDLFlBQUFBLEVBQ0ExQyxFQUFBeUIsbUJBQUFBLEVBQ0F6QixFQUFBdUIsaUJBQUFBLEVBQ0F2QixFQUFBcUksYUFBQSxFQUNBckksRUFBQW1JLGtCQUFBQSxFQUNBbkksRUFBQU4sR0FBQSxFQUlBTSxFQUFBc0ksZUFBQSxXQUVBMUosRUFBQWlCLElBQUEsV0FBQTBJLFFBQUFqSixLQUFBLFNBQUFnRCxHQUNBbkQsUUFBQUMsSUFBQWtELEVBQ0EsSUFBQTZFLEdBQUE3RSxFQUFBdkMsSUFDQW9ILEdBQUEvQyxRQUFBLFNBQUExQyxHQUNBQSxFQUFBdUcsYUFBQXZHLEVBQUF1RyxhQUFBakYsZ0JBS0FoRCxFQUFBbUgsWUFBQUEsS0EyQkF0SSxFQUFBdUksV0FBQSxTQUFBQyxHQUNBbEksUUFBQUMsSUFBQSxRQUNBLElBQUFrSSxHQUFBbkcsVUFBQW1HLFVBQ0FDLE1BQUEsOENBQ0FySCxRQUFBLDJCQUNBc0gsVUFBQSwyQkFDQUMsR0FBQSxVQUNBQyxPQUFBLFVBQ0FDLFlBQUFOLEVBQ0FsRyxXQUFBdUMsS0FBQTRELEdBQUFoSSxLQUFBLFdBQ0FULEVBQUFpRyxNQUFBLCtCQUNBLFdBQ0FqRyxFQUFBaUcsTUFBQSx3Q0NqRUFySCxJQUFBK0ssUUFBQSxlQUFBLFVBQUEsU0FBQUMsR0FDQXhJLEtBQUF5SSxTQUFBLFNBQUFYLEdBQ0EsR0FBQUEsRUFBQSxDQUNBLEdBQUFZLEdBQUFaLEVBQUF2QixNQUFBLEtBQUEsR0FDQW9DLEVBQUFELEVBQUF6RCxRQUFBLElBQUEsS0FBQUEsUUFBQSxJQUFBLElBQ0EsT0FBQXBFLE1BQUErSCxNQUFBSixFQUFBSyxLQUFBRixJQUNBLFVBR0EzSSxLQUFBNkgsVUFBQSxTQUFBQyxHQUNBVSxFQUFBTSxhQUFBQyxTQUFBakIsRUFDQTVJLFFBQUFDLElBQUEsZUFBQXFKLEVBQUFNLGFBQUFDLFdBR0EvSSxLQUFBZ0osU0FBQSxXQUNBLE1BQUFSLEdBQUFNLGFBQUFDLFVBR0EvSSxLQUFBaUosU0FBQSxXQUNBLEdBQUFuQixHQUFBOUgsS0FBQWdKLFVBQ0EsSUFBQWxCLEVBQUEsQ0FDQSxHQUFBb0IsR0FBQWxKLEtBQUF5SSxTQUFBWCxHQUNBcUIsRUFBQTdHLEtBQUE4RyxPQUFBLEdBQUFDLE9BQUFDLFVBQUEsTUFBQUosRUFBQUssR0FJQSxPQUhBSixJQUNBbkosS0FBQStILFNBRUFvQixFQUVBLE9BQUEsR0FJQW5KLEtBQUErSCxPQUFBLGlCQUNBUyxHQUFBTSxhQUFBQyxVQUlBL0ksS0FBQWdFLFFBQUEsV0FDQSxNQUFBaEUsTUFBQXlJLFNBQUF6SSxLQUFBZ0osZ0JBSUF4TCxJQUFBZ00sUUFBQSxtQkFBQSxLQUFBLFlBQUEsY0FBQSxTQUFBQyxFQUFBcEksRUFBQUQsR0FDQSxPQUNBc0ksUUFBQSxTQUFBL0wsR0FLQSxNQUpBQSxHQUFBZ0osUUFBQWhKLEVBQUFnSixZQUNBdkYsRUFBQTZILGFBQ0F0TCxFQUFBZ0osUUFBQWdELGNBQUEsVUFBQXZJLEVBQUE0SCxZQUVBckwsR0FFQTBFLFNBQUEsU0FBQUEsR0FPQSxNQUxBLE9BQUFBLEVBQUF1SCxRQUdBdkksRUFBQTZDLEtBQUEsVUFFQTdCLEdBQUFvSCxFQUFBbkwsS0FBQStELElBQ0F3SCxjQUFBLFNBQUF4SCxHQU9BLE1BTkEsT0FBQUEsRUFBQXVILE9BQ0F2SSxFQUFBNkMsS0FBQSxVQUdBaEYsUUFBQUMsSUFBQWtELEdBRUFvSCxFQUFBSyxPQUFBekgiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiICAgIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZWNvdG9uZUFwcCcsIFsnbmdSb3V0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnLCAndmFsaWRhdGlvbi5tYXRjaCddKTtcblxuYXBwLmNvbmZpZyhbJyRtZFRoZW1pbmdQcm92aWRlcicsICckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJG1kVGhlbWluZ1Byb3ZpZGVyLCAkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpe1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vc2V0IHRoZW1lIGFuZCBjb2xvciBwYWxldHRlXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcbiAgICAgICAgLnByaW1hcnlQYWxldHRlKCdncmVlbicpXG4gICAgICAgIC5hY2NlbnRQYWxldHRlKCdibHVlLWdyZXknLCB7J2RlZmF1bHQnOic2MDAnfSlcbiAgICAgICAgLndhcm5QYWxldHRlICgnb3JhbmdlJyk7XG5cbiAgICAvL3JvdXRlcyBmb3Igdmlld3NcbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY2FsY3VsYXRvci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsIGFzIGN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9sb2dpbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICAgICAgfSkud2hlbignL3JlZ2lzdGVyJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcmVnaXN0ZXIuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY3JlYXRlQWNjb3VudEN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9hZG1pbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2FkbWluLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2FkbWluQ3RybCBhcyBjdHJsJ1xuXG4gICAgICAgIH0pLndoZW4oJy9hY2NvdW50JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWNjb3VudC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9kYXNoYm9hcmQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfSkud2hlbignL3Byb2plY3RzJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcHJvamVjdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL2Fib3V0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWJvdXQuaHRtbCdcbiAgICAgICAgfSkud2hlbignL2NvbnRhY3QnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jb250YWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL3ByaXZhY3knLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcml2YWN5Lmh0bWwnXG4gICAgICAgIH0pLndoZW4oJy9zb3VyY2VzJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3Mvc291cmNlcy5odG1sJ1xuICAgICAgICB9KS5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICAgIH0pO1xuXG4gICAgLy8kaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdhdXRoSW50ZXJjZXB0b3InKTtcbn1dKTsiLCIvKipcbiAqIEFETUlOXG4gKi9cbmFwcC5jb250cm9sbGVyKCdhZG1pbkN0cmwnLCBbJyRodHRwJywgJyRzY29wZScsJyRwYXJzZScsIGZ1bmN0aW9uKCAkaHR0cCwgJHNjb3BlLCAkcGFyc2UgKXtcbiAgICAvLyBJTklUXG4gICAgaW5pdCgpO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuc3VnZ2VzdGlvbnMgPSAnJztcbiAgICBzZWxmLm1hcmtDb21wbGV0ZSA9IG1hcmtDb21wbGV0ZTtcbiAgICBzZWxmLnN1Ym1pdENTViA9IHN1Ym1pdENTVjtcblxuICAgIGZ1bmN0aW9uIHN1Ym1pdENTViggKXtcbiAgICAgICAgdmFyIGNzdk9iamVjdCA9ICRzY29wZS5jc3YucmVzdWx0O1xuICAgICAgICBjb25zb2xlLmxvZyhjc3ZPYmplY3QpO1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9idWxrJywgY3N2T2JqZWN0KS50aGVuKGZ1bmN0aW9uKCByZXMgKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFya0NvbXBsZXRlKCBzdWdnZXN0aW9uICkge1xuICAgICAgICB2YXIgaWQgPSBzdWdnZXN0aW9uLmlkO1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgICAgICRodHRwLnB1dCgnL3N1Z2dlc3Rpb24vY29tcGxldGUvJyArIGlkKS50aGVuKGZ1bmN0aW9uKCByZXMgKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRodHRwLmdldCgnL3N1Z2dlc3Rpb24nKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIHZhciBzdWdnZXN0aW9ucyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgc2VsZi5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuY3N2ID0ge1xuICAgICAgICBjb250ZW50OiBudWxsLFxuICAgICAgICBoZWFkZXI6IHRydWUsXG4gICAgICAgIGhlYWRlclZpc2libGU6IHRydWUsXG4gICAgICAgIHNlcGFyYXRvcjogJywnLFxuICAgICAgICBzZXBhcmF0b3JWaXNpYmxlOiB0cnVlLFxuICAgICAgICByZXN1bHQ6IG51bGwsXG4gICAgICAgIGVuY29kaW5nOiAnSVNPLTg4NTktMScsXG4gICAgICAgIGVuY29kaW5nVmlzaWJsZTogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdmFyIF9sYXN0R29vZFJlc3VsdCA9ICcnO1xuICAgICRzY29wZS50b1ByZXR0eUpTT04gPSBmdW5jdGlvbiAoanNvbiwgdGFiV2lkdGgpIHtcbiAgICAgICAgdmFyIG9ialN0ciA9IEpTT04uc3RyaW5naWZ5KGpzb24pO1xuICAgICAgICB2YXIgb2JqID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9iaiA9ICRwYXJzZShvYmpTdHIpKHt9KTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIGVhdCAkcGFyc2UgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBfbGFzdEdvb2RSZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkob2JqLCBudWxsLCBOdW1iZXIodGFiV2lkdGgpKTtcbiAgICAgICAgX2xhc3RHb29kUmVzdWx0ID0gcmVzdWx0O1xuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxufV0pOyIsImFwcC5jb250cm9sbGVyKCdjYWxjdWxhdGVDdHJsJywgWyckaHR0cCcsICckbWREaWFsb2cnLCAnJHJvb3RTY29wZScsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCBmdW5jdGlvbiggJGh0dHAsICRtZERpYWxvZywgJHJvb3RTY29wZSwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiApIHtcblxuICAgIC8vIENoZWNrIHVzZXJcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG5cbiAgICAvLyBJTklUXG4gICAgJGh0dHAuZ2V0KCcvbWF0ZXJpYWxzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICB2YXIgbGlzdCA9IHJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIC8vIC9pdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGl0ZW0ucHJpbWFyeV9jYXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5saXN0ID0gbGlzdDtcblxuICAgIH0pO1xuXG4gICAgLy8gU2VsZiBkZWNcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBzZWxmLmxpc3QgPSAnJztcbiAgICBzZWxmLmlzRGlzYWJsZWQgPSBmYWxzZTtcbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgICA9IHNlYXJjaFRleHRDaGFuZ2U7XG4gICAgc2VsZi5uZXdTdWdnZXN0aW9uID0gbmV3U3VnZ2VzdGlvbjtcbiAgICBzZWxmLnN1Ym1pdFN1Z2dlc3Rpb24gPSBzdWJtaXRTdWdnZXN0aW9uO1xuICAgIHNlbGYudW5pdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDA1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdraWxvcycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMTEwMjMxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ21ldHJpYyB0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDEuMTAyMzFcbiAgICAgICAgfVxuICAgIF07XG4gICAgc2VsZi5zdWJtaXNzaW9uID0ge1xuICAgICAgICBlbWFpbDogJycsXG4gICAgICAgIG1hdGVyaWFsOiAnJyxcbiAgICAgICAgbm90ZXM6ICcnXG4gICAgfTtcbiAgICBzZWxmLm5ld0NhbGN1bGF0aW9uID0gbmV3Q2FsY3VsYXRpb247XG5cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLnN1YmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLndhcm1JZCA9ICcnO1xuICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAnJztcbiAgICAgICAgICAgIHNlbGYuY29udmVyc2lvbiA9ICcnO1xuICAgICAgICAgICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld0NhbGN1bGF0aW9uKCkge1xuXG4gICAgICAgIHZhciBjYWxjdWxhdGUgPSB7XG4gICAgICAgICAgICB3YXJtSWQ6IHNlbGYud2FybUlkIHx8IHNlbGYuY2F0ZWdvcnkuc2Vjb25kYXJpZXNbMF0ud2FybV9pZCxcbiAgICAgICAgICAgIHdlaWdodDogcGFyc2VGbG9hdChzZWxmLndlaWdodCkgKiBzZWxmLmNvbnZlcnNpb25cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvY2FsY3VsYXRpb25zJywgY2FsY3VsYXRlKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9IE1hdGguZmxvb3IoTWF0aC5hYnMocmVzcG9uc2UuZGF0YSkgKiAxMDAwKSAvIDEwMDA7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhdmVUb1Byb2plY3QoKXtcbiAgICAgICAgdmFyIGxpbmVJdGVtID0ge1xuICAgICAgICAgICAgY2F0ZWdvcnk6IHNlbGYuY2F0ZWdvcnksXG4gICAgICAgICAgICBzdWJjYXRlZ29yeTogc2VsZi5zdWJjYXRlZ29yeSxcbiAgICAgICAgICAgIHdhcm1fSWQ6IHNlbGYud2FybUlkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSpzZWxmLmNvbnZlcnNpb24sXG4gICAgICAgICAgICB1bml0czogc2VsZi51bml0Lm5hbWVcbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5sb2cobGluZUl0ZW0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvYWRkVG9Qcm9qZWN0JykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBxdWVyeVNlYXJjaChxdWVyeSkge1xuICAgICAgICByZXR1cm4gcXVlcnkgPyBzZWxmLmxpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogc2VsZi5saXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvL3F1ZXJ5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcXVlcnkuc2xpY2UoMSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAob2JqLnByaW1hcnlfY2F0LmluZGV4T2YobG93ZXJjYXNlUXVlcnkpICE9IC0xKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWJtaXRTdWdnZXN0aW9uKCl7XG4gICAgICAgICRodHRwLnBvc3QoJy9zdWdnZXN0aW9uJywgc2VsZi5zdWJtaXNzaW9uKS50aGVuKGZ1bmN0aW9uKCByZXMgKXtcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld1N1Z2dlc3Rpb24oIHN1Z2dlc3Rpb24gKXtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpZGVuYXYnKS5mb2N1cygpO1xuXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3N1Ym1pdC1tb2RhbC5odG1sJyxcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICdjdHJsJyxcbiAgICAgICAgICAgIGxvY2Fsczoge21hdGVyaWFsOiBzZWxmLnNlYXJjaFRleHR9XG4gICAgICAgIH0pXG5cbiAgICB9XG5cblxufV0pOyIsIi8vIFJlZ2lzdGVyIEhUTUwgLSBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUFjY291bnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7IiwiYXBwLmRpcmVjdGl2ZSgnbmdDc3ZJbXBvcnQnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBzY29wZTp7XG4gICAgICAgICAgICBjb250ZW50Oic9PycsXG4gICAgICAgICAgICBoZWFkZXI6ICc9PycsXG4gICAgICAgICAgICBoZWFkZXJWaXNpYmxlOiAnPT8nLFxuICAgICAgICAgICAgc2VwYXJhdG9yOiAnPT8nLFxuICAgICAgICAgICAgc2VwYXJhdG9yVmlzaWJsZTogJz0/JyxcbiAgICAgICAgICAgIHJlc3VsdDogJz0/JyxcbiAgICAgICAgICAgIGVuY29kaW5nOiAnPT8nLFxuICAgICAgICAgICAgZW5jb2RpbmdWaXNpYmxlOiAnPT8nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlOiAnPGRpdj48ZGl2IG5nLXNob3c9XCJoZWFkZXJWaXNpYmxlXCI+PGRpdiBjbGFzcz1cImxhYmVsXCI+SGVhZGVyPC9kaXY+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiaGVhZGVyXCI+PC9kaXY+JytcbiAgICAgICAgJzxkaXYgbmctc2hvdz1cImVuY29kaW5nICYmIGVuY29kaW5nVmlzaWJsZVwiPjxkaXYgY2xhc3M9XCJsYWJlbFwiPkVuY29kaW5nPC9kaXY+PHNwYW4+e3tlbmNvZGluZ319PC9zcGFuPjwvZGl2PicrXG4gICAgICAgICc8ZGl2IG5nLXNob3c9XCJzZXBhcmF0b3IgJiYgc2VwYXJhdG9yVmlzaWJsZVwiPjxkaXYgY2xhc3M9XCJsYWJlbFwiPlNlcGVyYXRvcjwvZGl2PjxzcGFuPjxpbnB1dCBjbGFzcz1cInNlcGFyYXRvci1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgbmctY2hhbmdlPVwiY2hhbmdlU2VwYXJhdG9yXCIgbmctbW9kZWw9XCJzZXBhcmF0b3JcIj48c3Bhbj48L2Rpdj4nK1xuICAgICAgICAnPGRpdj48aW5wdXQgY2xhc3M9XCJidG4gY3RhIGdyYXlcIiB0eXBlPVwiZmlsZVwiLz48L2Rpdj48L2Rpdj4nLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCkge1xuICAgICAgICAgICAgc2NvcGUuc2VwYXJhdG9yVmlzaWJsZSA9IHNjb3BlLnNlcGFyYXRvclZpc2libGUgfHwgZmFsc2U7XG4gICAgICAgICAgICBzY29wZS5oZWFkZXJWaXNpYmxlID0gc2NvcGUuaGVhZGVyVmlzaWJsZSB8fCBmYWxzZTtcblxuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLnNlcGFyYXRvci1pbnB1dCcpKS5vbigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBzY29wZS5jb250ZW50ICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3N2OiBzY29wZS5jb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXBhcmF0b3I6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc6IHNjb3BlLmVuY29kaW5nXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VsdCA9IGNzdlRvSlNPTihjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVsZW1lbnQub24oJ2NoYW5nZScsIGZ1bmN0aW9uKG9uQ2hhbmdlRXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICBzY29wZS5maWxlbmFtZSA9IG9uQ2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKG9uTG9hZEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzdjogb25Mb2FkRXZlbnQudGFyZ2V0LnJlc3VsdC5yZXBsYWNlKC9cXHJcXG58XFxyL2csJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogc2NvcGUuaGVhZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcGFyYXRvcjogc2NvcGUuc2VwYXJhdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY29udGVudCA9IGNvbnRlbnQuY3N2O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0ID0gY3N2VG9KU09OKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0LmZpbGVuYW1lID0gc2NvcGUuZmlsZW5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAoIChvbkNoYW5nZUV2ZW50LnRhcmdldC50eXBlID09PSBcImZpbGVcIikgJiYgKG9uQ2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzICE9IG51bGwgfHwgb25DaGFuZ2VFdmVudC5zcmNFbGVtZW50LmZpbGVzICE9IG51bGwpICkgIHtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoKG9uQ2hhbmdlRXZlbnQuc3JjRWxlbWVudCB8fCBvbkNoYW5nZUV2ZW50LnRhcmdldCkuZmlsZXNbMF0sIHNjb3BlLmVuY29kaW5nKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIHNjb3BlLmNvbnRlbnQgIT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzdjogc2NvcGUuY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICFzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwYXJhdG9yOiBzY29wZS5zZXBhcmF0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQgPSBjc3ZUb0pTT04oY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmFyIGNzdlRvSlNPTiA9IGZ1bmN0aW9uKGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGluZXM9Y29udGVudC5jc3Yuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5Db3VudCA9IGxpbmVzWzBdLnNwbGl0KGNvbnRlbnQuc2VwYXJhdG9yKS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChjb250ZW50LmhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPWxpbmVzWzBdLnNwbGl0KGNvbnRlbnQuc2VwYXJhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9c3RhcnQ7IGk8bGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudGxpbmU9bGluZXNbaV0uc3BsaXQobmV3IFJlZ0V4cChjb250ZW50LnNlcGFyYXRvcisnKD8hW15cIl0qXCIoPzooPzpbXlwiXSpcIil7Mn0pKlteXCJdKiQpJykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnRsaW5lLmxlbmd0aCA9PT0gY29sdW1uQ291bnQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudC5oZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqPTA7IGo8aGVhZGVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpbaGVhZGVyc1tqXV0gPSBjdXJyZW50bGluZVtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGs9MDsgazxjdXJyZW50bGluZS5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpba10gPSBjdXJyZW50bGluZVtrXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChvYmopO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfX0pOyIsImFwcC5jb250cm9sbGVyKCdkYXNoYm9hcmRDdHJsJywgWyckbWREaWFsb2cnLCAnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkbWREaWFsb2csICRyb290U2NvcGUsICRzY29wZSwgJGh0dHApIHtcbiAgICB2YXIgdXNlcj0kcm9vdFNjb3BlLnVzZXI7XG5cblxuICAgIC8vbG9hZCBwcm9qZWN0IGxpc3Qgb24gcGFnZSBsb2FkXG4gICAgJGh0dHAuZ2V0KCcvcHJvamVjdC8nICsgdXNlci5pZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICRzY29wZS5wcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vcmVzcG9uc2UuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAvLyAgICBpdGVtLnByb2plY3RfbmFtZSA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcbi8vdGhpcyBpcyBmb3IgdGhlIGRlbGV0ZSBtb2RhbCBhbGVydCBmb3IgZGVsZXRpbmcgYSBwcm9qZWN0LS0gc3RpbGwgbm90IHdvcmtpbmcgY29ycmVjdFxuXG4gICAgJHNjb3BlLnNob3dEZWxldGUgPSBmdW5jdGlvbihldikge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdDTElDSycpO1xuICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgICAgIC50aXRsZSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB5b3VyIHByb2plY3Q/JylcbiAgICAgICAgICAgIC5jb250ZW50KCdUaGlzIGlzIHBlcm1hbmVudC4nKVxuICAgICAgICAgICAgLmFyaWFMYWJlbCgnRGVsZXRlIHByb2plY3QgcGVybWFuZW50bHknKVxuICAgICAgICAgICAgLm9rKCdEZWxldGUnKVxuICAgICAgICAgICAgLmNhbmNlbCgnQ2FuY2VsJylcbiAgICAgICAgICAgIC50YXJnZXRFdmVudChldik7XG4gICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBwcm9qZWN0IGhhcyBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBwcm9qZWN0IGhhcyBub3QgYmVlbiBkZWxldGVkLic7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvL25lZWQgdG8gY2hlY2sgaWYgd2UgbmVlZCB0aGlzIVxuLy8gICAgZnVuY3Rpb24gRGlhbG9nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZykge1xuLy8gICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbigpIHtcbi8vICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcbi8vICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmFuc3dlciA9IGZ1bmN0aW9uKGFuc3dlcikge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKGFuc3dlcik7XG4vLyAgICB9O1xuLy99XG5cbn1dKTsiLCIvLyBMb2dpbiBIVE1MIC0gS2F0ZVxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSkge1xuICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLmZvcm1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YS50b2tlbik7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICB9KVxuICAgIH1cbn1dKTsiLCIvLyBDaGFuZ2UgTmF2aWdhdGlvbiBPcHRpb25zIHdpdGggTG9naW5cbmFwcC5jb250cm9sbGVyKCduYXZDdHJsJywgWydhdXRoU2VydmljZScsICckc2NvcGUnLCAnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnJGh0dHAnLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sICRodHRwKXtcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG59XSk7XG4iLCIvLyBQcm9qZWN0IFBhZ2UgLSAgS2ltL01hZGVsZWluZVxuYXBwLmNvbnRyb2xsZXIoJ3Byb2plY3RzQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuXG4gICAgLy8gU2VsZiBkZWNcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5wcm9qZWN0TGlzdCA9ICcnO1xuICAgIHNlbGYucmVzdWx0ID0gJyc7XG4gICAgc2VsZi5xdWVyeVNlYXJjaCA9IHF1ZXJ5U2VhcmNoO1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtQ2hhbmdlID0gc2VsZWN0ZWRJdGVtQ2hhbmdlO1xuICAgIHNlbGYuc2VhcmNoVGV4dENoYW5nZSA9IHNlYXJjaFRleHRDaGFuZ2U7XG4gICAgc2VsZi5wcm9qZWN0VG90YWw9IDA7XG4gICAgc2VsZi5kZWxldGVQcm9qZWN0SXRlbSA9IGRlbGV0ZVByb2plY3RJdGVtO1xuICAgIHNlbGYuaWQgPSAwO1xuXG5cbiAgICAvL2xvYWQgcHJvamVjdCBsaXN0IG9uIHBhZ2UgbG9hZFxuICAgIHNlbGYuZ2V0UHJvamVjdExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy9uZWVkIHRvIGZpZ3VyZSBvdXQgaG93IHRvIHBhc3MgdGhlIHVzZXJpZCBmcm9tIHRoZSBsb2dpbiBwYWdlLS11c2UgdGhlIHNhbWUgY29udHJvbGxlcj9cbiAgICAgICAgJGh0dHAuZ2V0KCcvcHJvamVjdCcsIHVzZXJpZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIHZhciBwcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBwcm9qZWN0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5wcm9qZWN0X25hbWUgPSBpdGVtLnByb2plY3RfbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIC8vaXRlbS5wcm9qZWN0X2Rlc2NyaXB0aW9uID0gaXRlbS5wcm9qZWN0X2Rlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIC8vaXRlbS5pdGVtSWQgPSBpdGVtLmlkO1xuICAgICAgICAgICAgICAgIC8vaXRlbS5jbzJfb2Zmc2V0ID0gaXRlbS5jbzJfb2Zmc2V0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLnByb2plY3RMaXN0ID0gcHJvamVjdExpc3Q7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBxdWVyeVNlYXJjaChxdWVyeSkge1xuICAgICAgICByZXR1cm4gcXVlcnkgPyBzZWxmLnByb2plY3RMaXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSA6IHNlbGYucHJvamVjdExpc3Q7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmoucHJpbWFyeV9jYXQuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLnByb2plY3RfbmFtZSA9ICcnO1xuICAgICAgICAgICAgc2VsZi5wcm9qZWN0X2Rlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuc2hvd0RlbGV0ZSA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDTElDSycpO1xuICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgICAgIC50aXRsZSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGl0ZW0/JylcbiAgICAgICAgICAgIC5jb250ZW50KCdUaGlzIHdpbGwgYmUgcGVybWFuZW50LicpXG4gICAgICAgICAgICAuYXJpYUxhYmVsKCdEZWxldGUgaXRlbSBwZXJtYW5lbnRseScpXG4gICAgICAgICAgICAub2soJ0RlbGV0ZScpXG4gICAgICAgICAgICAuY2FuY2VsKCdDYW5jZWwnKVxuICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIGl0ZW0gaGFzIGJlZW4gZGVsZXRlZC4nO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIGl0ZW0gaGFzIG5vdCBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSk7XG4gICAgfTtcbi8vICAgIGZ1bmN0aW9uIERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2cpIHtcbi8vICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5hbnN3ZXIgPSBmdW5jdGlvbihhbnN3ZXIpIHtcbi8vICAgICAgICAkbWREaWFsb2cuaGlkZShhbnN3ZXIpO1xuLy8gICAgfTtcbi8vfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlUHJvamVjdEl0ZW0oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGVsZXRpbmcuLi5cIiwgc2VsZi5wcm9qZWN0TGlzdC5JRCk7XG4gICAgICAgIC8vJGh0dHAudXBkYXRlKCcvcHJvamVjdCcpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIC8vZmluZE9uZSBhbmQgZGVsZXRlIGJ5IGlkIHVzaW5nIHByb2plY3RsaXN0LmlkXG4gICAgICAgIC8vICAgIGNvbnNvbGUubG9nKFwiSXRlbSB3YXMgZGVsZXRlZC5cIiwgcmVzcG9uc2UpO1xuICAgICAgICAvLyAgICBzZWxmLmdldFByb2plY3RMaXN0KCk7XG4gICAgfTtcblxuICAgIC8vc2VsZi5jYWxjdWxhdGVQcm9qZWN0VG90YWwoKXtcbiAgICAvLy8vZm9yRWFjaCBwcm9qZWN0XG4gICAgLy8gICAgdmFyIHByb2plY3RUb3RhbCs9cHJvamVjdExpc3QuY28yX29mZnNldDtcbiAgICAvLyAgICByZXR1cm4gcHJvamVjdFRvdGFsO1xuICAgIC8vfVxuICAgIC8vfTtcbn1dKTsiLCIvLyBTZXJ2aWNlcyBmb3IgYXV0aGVudGljYXRpb25cbmFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KXtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
=======
var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,n,r){n.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl as ctrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("adminCtrl",["$http","$scope","$parse",function(e,t,n){function r(t){var n=t.id;console.log(n),e.put("/suggestion/complete/"+n).then(function(e){o()})}function o(){e.get("/suggestion").then(function(e){var t=e.data;console.log(t),a.suggestions=t})}o();var a=this;a.suggestions="",a.markComplete=r,t.csv={content:null,header:!0,headerVisible:!0,separator:",",separatorVisible:!0,result:null,encoding:"ISO-8859-1",encodingVisible:!0};var l="";t.toPrettyJSON=function(e,t){var r=JSON.stringify(e),o=null;try{o=n(r)({})}catch(a){return l}var i=JSON.stringify(o,null,Number(t));return l=i,i}}]),app.controller("calculateCtrl",["$http","$mdDialog","$rootScope","authService","$location",function(e,t,n,r,o){function a(e){console.log("Text changed to ",e)}function l(e){void 0==e&&(h.category="",h.subcategory="",h.warmId="",h.weight="",h.conversion="",h.result="")}function i(){var t={warmId:h.warmId||h.category.secondaries[0].warm_id,weight:parseFloat(h.weight)*h.conversion};e.post("/calculations",t).then(function(e){h.result=Math.floor(1e3*Math.abs(e.data))/1e3})}function s(e){return e?h.list.filter(c(e)):h.list}function c(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function u(){e.post("/suggestion",h.submission).then(function(e){t.hide()})}function p(e){document.getElementById("sidenav").focus(),t.show({templateUrl:"/views/submit-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:h.searchText}})}n.user=r.getUser(),n.user&&n.user.username&&o.path("/"),e.get("/materials").then(function(e){var t=e.data;t.forEach(function(e){e.primary_cat=e.primary_cat.toLowerCase()}),h.list=t});var h=this;h.list="",h.isDisabled=!1,h.result="",h.querySearch=s,h.selectedItemChange=l,h.searchTextChange=a,h.newSuggestion=p,h.submitSuggestion=u,h.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],h.submission={email:"",material:"",notes:""},h.newCalculation=i}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(e,t,n){e.user={},e.processForm=function(r){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),n.path("/login"),alert("Your account has been created.")})}}]),app.directive("ngCsvImport",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{content:"=?",header:"=?",headerVisible:"=?",separator:"=?",separatorVisible:"=?",result:"=?",encoding:"=?",encodingVisible:"=?"},template:'<div><div ng-show="headerVisible"><div class="label">Header</div><input type="checkbox" ng-model="header"></div><div ng-show="encoding && encodingVisible"><div class="label">Encoding</div><span>{{encoding}}</span></div><div ng-show="separator && separatorVisible"><div class="label">Seperator</div><span><input class="separator-input" type="text" ng-change="changeSeparator" ng-model="separator"><span></div><div><input class="btn cta gray" type="file"/></div></div>',link:function(e,t){e.separatorVisible=e.separatorVisible||!1,e.headerVisible=e.headerVisible||!1,angular.element(t[0].querySelector(".separator-input")).on("keyup",function(t){if(null!=e.content){var r={csv:e.content,header:e.header,separator:t.target.value,encoding:e.encoding};e.result=n(r),e.$apply()}}),t.on("change",function(t){var r=new FileReader;if(e.filename=t.target.files[0].name,r.onload=function(t){e.$apply(function(){var r={csv:t.target.result.replace(/\r\n|\r/g,"\n"),header:e.header,separator:e.separator};e.content=r.csv,e.result=n(r),e.result.filename=e.filename})},"file"!==t.target.type||null==t.target.files&&null==t.srcElement.files){if(null!=e.content){var o={csv:e.content,header:!e.header,separator:e.separator};e.result=n(o)}}else r.readAsText((t.srcElement||t.target).files[0],e.encoding)});var n=function(e){var t=e.csv.split("\n"),n=[],r=0,o=t[0].split(e.separator).length,a=[];e.header&&(a=t[0].split(e.separator),r=1);for(var l=r;l<t.length;l++){var i={},s=t[l].split(new RegExp(e.separator+'(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)'));if(s.length===o){if(e.header)for(var c=0;c<a.length;c++)i[a[c]]=s[c];else for(var u=0;u<s.length;u++)i[u]=s[u];n.push(i)}}return n}}}}),app.controller("dashboardCtrl",["$mdDialog","$rootScope","$scope","$http",function(e,t,n,r){var o=t.user;r.get("/project/"+o.id).then(function(e){console.log(e),n.projectList=e.data}),n.showDelete=function(t){console.log("CLICK");var r=e.confirm().title("Are you sure you want to delete your project?").content("This is permanent.").ariaLabel("Delete project permanently").ok("Delete").cancel("Cancel").targetEvent(t);e.show(r).then(function(){n.alert="Your project has been deleted."},function(){n.alert="Your project has not been deleted."})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(e,t,n,r,o){e.login=function(){t({method:"POST",url:"/login",data:e.form}).then(function(e){n.saveToken(e.data.token),o.user=n.getUser(),r.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,n,r,o){n.user=e.getUser(),n.user&&n.user.username&&r.path("/"),t.logout=function(){e.logout(),n.user=e.getUser(),r.path("/")}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){function n(e){return e?i.projectList.filter(r(e)):i.projectList}function r(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function o(e){console.log("Text changed to ",e)}function a(e){void 0==e&&(i.project_name="",i.project_description="")}function l(){console.log("Deleting...",i.projectList.ID)}var i=this;i.projectList="",i.result="",i.querySearch=n,i.selectedItemChange=a,i.searchTextChange=o,i.projectTotal=0,i.deleteProjectItem=l,i.id=0,i.getProjectList=function(){t.get("/project",userid).then(function(e){console.log(e);var t=e.data;t.forEach(function(e){e.project_name=e.project_name.toLowerCase()}),i.projectList=t})},e.showDelete=function(t){console.log("CLICK");var n=$mdDialog.confirm().title("Are you sure you want to delete this item?").content("This will be permanent.").ariaLabel("Delete item permanently").ok("Delete").cancel("Cancel").targetEvent(t);$mdDialog.show(n).then(function(){e.alert="Your item has been deleted."},function(){e.alert="Your item has not been deleted."})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var n=t.split(".")[1],r=n.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),n=Math.round((new Date).getTime()/1e3)<=t.exp;return n||this.logout(),n}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},n.isAuthed()&&(e.headers.Authorization="Bearer "+n.getToken()),e},response:function(n){return 401===n.status&&t.path("/login"),n||e.when(n)},responseError:function(n){return 401===n.status?t.path("/login"):console.log(n),e.reject(n)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzY3JpcHRzL2FkbWluQ3RybC5qcyIsInNjcmlwdHMvY2FsY3VsYXRlQ3RybC5qcyIsInNjcmlwdHMvY3JlYXRlQWNjb3VudEN0cmwuanMiLCJzY3JpcHRzL2NzdkltcG9ydC5qcyIsInNjcmlwdHMvZGFzaGJvYXJkQ3RybC5qcyIsInNjcmlwdHMvbG9naW5DdHJsLmpzIiwic2NyaXB0cy9uYXZDdHJsLmpzIiwic2NyaXB0cy9wcm9qZWN0c0N0cmwuanMiLCJzY3JpcHRzL3NlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkaHR0cCIsIiRzY29wZSIsIiRwYXJzZSIsIm1hcmtDb21wbGV0ZSIsInN1Z2dlc3Rpb24iLCJpZCIsImNvbnNvbGUiLCJsb2ciLCJwdXQiLCJ0aGVuIiwicmVzIiwiaW5pdCIsImdldCIsInN1Z2dlc3Rpb25zIiwiZGF0YSIsInNlbGYiLCJ0aGlzIiwiY3N2IiwiY29udGVudCIsImhlYWRlciIsImhlYWRlclZpc2libGUiLCJzZXBhcmF0b3IiLCJzZXBhcmF0b3JWaXNpYmxlIiwicmVzdWx0IiwiZW5jb2RpbmciLCJlbmNvZGluZ1Zpc2libGUiLCJfbGFzdEdvb2RSZXN1bHQiLCJ0b1ByZXR0eUpTT04iLCJqc29uIiwidGFiV2lkdGgiLCJvYmpTdHIiLCJKU09OIiwic3RyaW5naWZ5Iiwib2JqIiwiZSIsIk51bWJlciIsIiRtZERpYWxvZyIsIiRyb290U2NvcGUiLCJhdXRoU2VydmljZSIsIiRsb2NhdGlvbiIsInNlYXJjaFRleHRDaGFuZ2UiLCJ0ZXh0Iiwic2VsZWN0ZWRJdGVtQ2hhbmdlIiwiaXRlbSIsInVuZGVmaW5lZCIsImNhdGVnb3J5Iiwic3ViY2F0ZWdvcnkiLCJ3YXJtSWQiLCJ3ZWlnaHQiLCJjb252ZXJzaW9uIiwibmV3Q2FsY3VsYXRpb24iLCJjYWxjdWxhdGUiLCJzZWNvbmRhcmllcyIsIndhcm1faWQiLCJwYXJzZUZsb2F0IiwicG9zdCIsInJlc3BvbnNlIiwiTWF0aCIsImZsb29yIiwiYWJzIiwicXVlcnlTZWFyY2giLCJxdWVyeSIsImxpc3QiLCJmaWx0ZXIiLCJjcmVhdGVGaWx0ZXJGb3IiLCJsb3dlcmNhc2VRdWVyeSIsInRvTG93ZXJDYXNlIiwicHJpbWFyeV9jYXQiLCJpbmRleE9mIiwic3VibWl0U3VnZ2VzdGlvbiIsInN1Ym1pc3Npb24iLCJoaWRlIiwibmV3U3VnZ2VzdGlvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb2N1cyIsInNob3ciLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiY29udHJvbGxlckFzIiwibG9jYWxzIiwibWF0ZXJpYWwiLCJzZWFyY2hUZXh0IiwidXNlciIsImdldFVzZXIiLCJ1c2VybmFtZSIsInBhdGgiLCJmb3JFYWNoIiwiaXNEaXNhYmxlZCIsInVuaXRzIiwibmFtZSIsImVtYWlsIiwibm90ZXMiLCJwcm9jZXNzRm9ybSIsIm1ldGhvZCIsInVybCIsImRhdGFUeXBlIiwiYWxlcnQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInRyYW5zY2x1ZGUiLCJyZXBsYWNlIiwic2NvcGUiLCJ0ZW1wbGF0ZSIsImxpbmsiLCJlbGVtZW50IiwicXVlcnlTZWxlY3RvciIsIm9uIiwidGFyZ2V0IiwidmFsdWUiLCJjc3ZUb0pTT04iLCIkYXBwbHkiLCJvbkNoYW5nZUV2ZW50IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsImZpbGVuYW1lIiwiZmlsZXMiLCJvbmxvYWQiLCJvbkxvYWRFdmVudCIsInR5cGUiLCJzcmNFbGVtZW50IiwicmVhZEFzVGV4dCIsImxpbmVzIiwic3BsaXQiLCJzdGFydCIsImNvbHVtbkNvdW50IiwibGVuZ3RoIiwiaGVhZGVycyIsImkiLCJjdXJyZW50bGluZSIsIlJlZ0V4cCIsImoiLCJrIiwicHVzaCIsInByb2plY3RMaXN0Iiwic2hvd0RlbGV0ZSIsImV2IiwiY29uZmlybSIsInRpdGxlIiwiYXJpYUxhYmVsIiwib2siLCJjYW5jZWwiLCJ0YXJnZXRFdmVudCIsImxvZ2luIiwiZm9ybSIsInNhdmVUb2tlbiIsInRva2VuIiwibG9nb3V0IiwicHJvamVjdF9uYW1lIiwicHJvamVjdF9kZXNjcmlwdGlvbiIsImRlbGV0ZVByb2plY3RJdGVtIiwiSUQiLCJwcm9qZWN0VG90YWwiLCJnZXRQcm9qZWN0TGlzdCIsInVzZXJpZCIsInNlcnZpY2UiLCIkd2luZG93IiwicGFyc2VKd3QiLCJiYXNlNjRVcmwiLCJiYXNlNjQiLCJwYXJzZSIsImF0b2IiLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImZhY3RvcnkiLCIkcSIsInJlcXVlc3QiLCJBdXRob3JpemF0aW9uIiwic3RhdHVzIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxjQUFBLFVBQUEsYUFBQSxhQUFBLG9CQUVBRixLQUFBRyxRQUFBLHFCQUFBLGlCQUFBLG9CQUFBLGdCQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FELEVBQUFFLFdBQUEsR0FHQUosRUFBQUssTUFBQSxXQUNBQyxlQUFBLFNBQ0FDLGNBQUEsYUFBQUMsVUFBQSxRQUNBQyxZQUFBLFVBR0FSLEVBQUFTLEtBQUEsS0FFQUMsWUFBQSx5QkFDQUMsV0FBQSwwQkFDQUYsS0FBQSxVQUVBQyxZQUFBLG9CQUNBQyxXQUFBLGNBQ0FGLEtBQUEsYUFFQUMsWUFBQSx1QkFDQUMsV0FB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QUFqQixFQUNBM0ksUUFBQUMsSUFBQSxlQUFBb0osRUFBQU0sYUFBQUMsV0FHQWxKLEtBQUFtSixTQUFBLFdBQ0EsTUFBQVIsR0FBQU0sYUFBQUMsVUFHQWxKLEtBQUFvSixTQUFBLFdBQ0EsR0FBQW5CLEdBQUFqSSxLQUFBbUosVUFDQSxJQUFBbEIsRUFBQSxDQUNBLEdBQUFvQixHQUFBckosS0FBQTRJLFNBQUFYLEdBQ0FxQixFQUFBN0csS0FBQThHLE9BQUEsR0FBQUMsT0FBQUMsVUFBQSxNQUFBSixFQUFBSyxHQUlBLE9BSEFKLElBQ0F0SixLQUFBa0ksU0FFQW9CLEVBRUEsT0FBQSxHQUlBdEosS0FBQWtJLE9BQUEsaUJBQ0FTLEdBQUFNLGFBQUFDLFVBSUFsSixLQUFBbUUsUUFBQSxXQUNBLE1BQUFuRSxNQUFBNEksU0FBQTVJLEtBQUFtSixnQkFJQXRMLElBQUE4TCxRQUFBLG1CQUFBLEtBQUEsWUFBQSxjQUFBLFNBQUFDLEVBQUFySSxFQUFBRCxHQUNBLE9BQ0F1SSxRQUFBLFNBQUE3TCxHQUtBLE1BSkFBLEdBQUE4SSxRQUFBOUksRUFBQThJLFlBQ0F4RixFQUFBOEgsYUFDQXBMLEVBQUE4SSxRQUFBZ0QsY0FBQSxVQUFBeEksRUFBQTZILFlBRUFuTCxHQUVBd0UsU0FBQSxTQUFBQSxHQU9BLE1BTEEsT0FBQUEsRUFBQXVILFFBR0F4SSxFQUFBOEMsS0FBQSxVQUVBN0IsR0FBQW9ILEVBQUFqTCxLQUFBNkQsSUFDQXdILGNBQUEsU0FBQXhILEdBT0EsTUFOQSxPQUFBQSxFQUFBdUgsT0FDQXhJLEVBQUE4QyxLQUFBLFVBR0EvRSxRQUFBQyxJQUFBaUQsR0FFQW9ILEVBQUFLLE9BQUF6SCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdlY290b25lQXBwJywgWyduZ1JvdXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcycsICd2YWxpZGF0aW9uLm1hdGNoJ10pO1xuXG5hcHAuY29uZmlnKFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywgJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJGh0dHBQcm92aWRlcil7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy9zZXQgdGhlbWUgYW5kIGNvbG9yIHBhbGV0dGVcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2dyZWVuJylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2JsdWUtZ3JleScsIHsnZGVmYXVsdCc6JzYwMCd9KVxuICAgICAgICAud2FyblBhbGV0dGUgKCdvcmFuZ2UnKTtcblxuICAgIC8vcm91dGVzIGZvciB2aWV3c1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jYWxjdWxhdG9yLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhbGN1bGF0ZUN0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FkbWluJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWRtaW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWRtaW5DdHJsIGFzIGN0cmwnXG5cbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcHJvamVjdHMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcm9qZWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RzQ3RybCBhcyBjdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWJvdXQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hYm91dC5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcHJpdmFjeScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3ByaXZhY3kuaHRtbCdcbiAgICAgICAgfSkud2hlbignL3NvdXJjZXMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zb3VyY2VzLmh0bWwnXG4gICAgICAgIH0pLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG5cbiAgICAvLyRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xufV0pOyIsIi8qKlxuICogQURNSU5cbiAqL1xuYXBwLmNvbnRyb2xsZXIoJ2FkbWluQ3RybCcsIFsnJGh0dHAnLCAnJHNjb3BlJywnJHBhcnNlJywgZnVuY3Rpb24oICRodHRwLCAkc2NvcGUsICRwYXJzZSApe1xuICAgIC8vIElOSVRcbiAgICBpbml0KCk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5zdWdnZXN0aW9ucyA9ICcnO1xuICAgIHNlbGYubWFya0NvbXBsZXRlID0gbWFya0NvbXBsZXRlO1xuXG4gICAgZnVuY3Rpb24gbWFya0NvbXBsZXRlKCBzdWdnZXN0aW9uICkge1xuICAgICAgICB2YXIgaWQgPSBzdWdnZXN0aW9uLmlkO1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgICAgICRodHRwLnB1dCgnL3N1Z2dlc3Rpb24vY29tcGxldGUvJyArIGlkKS50aGVuKGZ1bmN0aW9uKCByZXMgKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRodHRwLmdldCgnL3N1Z2dlc3Rpb24nKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIHZhciBzdWdnZXN0aW9ucyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgc2VsZi5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuY3N2ID0ge1xuICAgICAgICBjb250ZW50OiBudWxsLFxuICAgICAgICBoZWFkZXI6IHRydWUsXG4gICAgICAgIGhlYWRlclZpc2libGU6IHRydWUsXG4gICAgICAgIHNlcGFyYXRvcjogJywnLFxuICAgICAgICBzZXBhcmF0b3JWaXNpYmxlOiB0cnVlLFxuICAgICAgICByZXN1bHQ6IG51bGwsXG4gICAgICAgIGVuY29kaW5nOiAnSVNPLTg4NTktMScsXG4gICAgICAgIGVuY29kaW5nVmlzaWJsZTogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdmFyIF9sYXN0R29vZFJlc3VsdCA9ICcnO1xuICAgICRzY29wZS50b1ByZXR0eUpTT04gPSBmdW5jdGlvbiAoanNvbiwgdGFiV2lkdGgpIHtcbiAgICAgICAgdmFyIG9ialN0ciA9IEpTT04uc3RyaW5naWZ5KGpzb24pO1xuICAgICAgICB2YXIgb2JqID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9iaiA9ICRwYXJzZShvYmpTdHIpKHt9KTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIGVhdCAkcGFyc2UgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBfbGFzdEdvb2RSZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkob2JqLCBudWxsLCBOdW1iZXIodGFiV2lkdGgpKTtcbiAgICAgICAgX2xhc3RHb29kUmVzdWx0ID0gcmVzdWx0O1xuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxufV0pOyIsImFwcC5jb250cm9sbGVyKCdjYWxjdWxhdGVDdHJsJywgWyckaHR0cCcsICckbWREaWFsb2cnLCAnJHJvb3RTY29wZScsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCBmdW5jdGlvbiggJGh0dHAsICRtZERpYWxvZywgJHJvb3RTY29wZSwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiApIHtcblxuICAgIC8vIENoZWNrIHVzZXJcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG5cbiAgICAvLyBJTklUXG4gICAgJGh0dHAuZ2V0KCcvbWF0ZXJpYWxzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICB2YXIgbGlzdCA9IHJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIC8vIC9pdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGl0ZW0ucHJpbWFyeV9jYXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5saXN0ID0gbGlzdDtcblxuICAgIH0pO1xuXG4gICAgLy8gU2VsZiBkZWNcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBzZWxmLmxpc3QgPSAnJztcbiAgICBzZWxmLmlzRGlzYWJsZWQgPSBmYWxzZTtcbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgICA9IHNlYXJjaFRleHRDaGFuZ2U7XG4gICAgc2VsZi5uZXdTdWdnZXN0aW9uID0gbmV3U3VnZ2VzdGlvbjtcbiAgICBzZWxmLnN1Ym1pdFN1Z2dlc3Rpb24gPSBzdWJtaXRTdWdnZXN0aW9uO1xuICAgIHNlbGYudW5pdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDA1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdraWxvcycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMTEwMjMxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ21ldHJpYyB0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDEuMTAyMzFcbiAgICAgICAgfVxuICAgIF07XG4gICAgc2VsZi5zdWJtaXNzaW9uID0ge1xuICAgICAgICBlbWFpbDogJycsXG4gICAgICAgIG1hdGVyaWFsOiAnJyxcbiAgICAgICAgbm90ZXM6ICcnXG4gICAgfTtcbiAgICBzZWxmLm5ld0NhbGN1bGF0aW9uID0gbmV3Q2FsY3VsYXRpb247XG5cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLnN1YmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLndhcm1JZCA9ICcnO1xuICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAnJztcbiAgICAgICAgICAgIHNlbGYuY29udmVyc2lvbiA9ICcnO1xuICAgICAgICAgICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld0NhbGN1bGF0aW9uKCkge1xuXG4gICAgICAgIHZhciBjYWxjdWxhdGUgPSB7XG4gICAgICAgICAgICB3YXJtSWQ6IHNlbGYud2FybUlkIHx8IHNlbGYuY2F0ZWdvcnkuc2Vjb25kYXJpZXNbMF0ud2FybV9pZCxcbiAgICAgICAgICAgIHdlaWdodDogcGFyc2VGbG9hdChzZWxmLndlaWdodCkgKiBzZWxmLmNvbnZlcnNpb25cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvY2FsY3VsYXRpb25zJywgY2FsY3VsYXRlKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9IE1hdGguZmxvb3IoTWF0aC5hYnMocmVzcG9uc2UuZGF0YSkgKiAxMDAwKSAvIDEwMDA7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhdmVUb1Byb2plY3QoKXtcbiAgICAgICAgdmFyIGxpbmVJdGVtID0ge1xuICAgICAgICAgICAgY2F0ZWdvcnk6IHNlbGYuY2F0ZWdvcnksXG4gICAgICAgICAgICBzdWJjYXRlZ29yeTogc2VsZi5zdWJjYXRlZ29yeSxcbiAgICAgICAgICAgIHdhcm1fSWQ6IHNlbGYud2FybUlkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSpzZWxmLmNvbnZlcnNpb24sXG4gICAgICAgICAgICB1bml0czogc2VsZi51bml0Lm5hbWVcbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5sb2cobGluZUl0ZW0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvYWRkVG9Qcm9qZWN0JykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBxdWVyeVNlYXJjaChxdWVyeSkge1xuICAgICAgICByZXR1cm4gcXVlcnkgPyBzZWxmLmxpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogc2VsZi5saXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvL3F1ZXJ5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcXVlcnkuc2xpY2UoMSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAob2JqLnByaW1hcnlfY2F0LmluZGV4T2YobG93ZXJjYXNlUXVlcnkpICE9IC0xKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWJtaXRTdWdnZXN0aW9uKCl7XG4gICAgICAgICRodHRwLnBvc3QoJy9zdWdnZXN0aW9uJywgc2VsZi5zdWJtaXNzaW9uKS50aGVuKGZ1bmN0aW9uKCByZXMgKXtcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld1N1Z2dlc3Rpb24oIHN1Z2dlc3Rpb24gKXtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpZGVuYXYnKS5mb2N1cygpO1xuXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3N1Ym1pdC1tb2RhbC5odG1sJyxcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICdjdHJsJyxcbiAgICAgICAgICAgIGxvY2Fsczoge21hdGVyaWFsOiBzZWxmLnNlYXJjaFRleHR9XG4gICAgICAgIH0pXG5cbiAgICB9XG5cblxufV0pOyIsIi8vIFJlZ2lzdGVyIEhUTUwgLSBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUFjY291bnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7IiwiYXBwLmRpcmVjdGl2ZSgnbmdDc3ZJbXBvcnQnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBzY29wZTp7XG4gICAgICAgICAgICBjb250ZW50Oic9PycsXG4gICAgICAgICAgICBoZWFkZXI6ICc9PycsXG4gICAgICAgICAgICBoZWFkZXJWaXNpYmxlOiAnPT8nLFxuICAgICAgICAgICAgc2VwYXJhdG9yOiAnPT8nLFxuICAgICAgICAgICAgc2VwYXJhdG9yVmlzaWJsZTogJz0/JyxcbiAgICAgICAgICAgIHJlc3VsdDogJz0/JyxcbiAgICAgICAgICAgIGVuY29kaW5nOiAnPT8nLFxuICAgICAgICAgICAgZW5jb2RpbmdWaXNpYmxlOiAnPT8nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlOiAnPGRpdj48ZGl2IG5nLXNob3c9XCJoZWFkZXJWaXNpYmxlXCI+PGRpdiBjbGFzcz1cImxhYmVsXCI+SGVhZGVyPC9kaXY+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiaGVhZGVyXCI+PC9kaXY+JytcbiAgICAgICAgJzxkaXYgbmctc2hvdz1cImVuY29kaW5nICYmIGVuY29kaW5nVmlzaWJsZVwiPjxkaXYgY2xhc3M9XCJsYWJlbFwiPkVuY29kaW5nPC9kaXY+PHNwYW4+e3tlbmNvZGluZ319PC9zcGFuPjwvZGl2PicrXG4gICAgICAgICc8ZGl2IG5nLXNob3c9XCJzZXBhcmF0b3IgJiYgc2VwYXJhdG9yVmlzaWJsZVwiPjxkaXYgY2xhc3M9XCJsYWJlbFwiPlNlcGVyYXRvcjwvZGl2PjxzcGFuPjxpbnB1dCBjbGFzcz1cInNlcGFyYXRvci1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgbmctY2hhbmdlPVwiY2hhbmdlU2VwYXJhdG9yXCIgbmctbW9kZWw9XCJzZXBhcmF0b3JcIj48c3Bhbj48L2Rpdj4nK1xuICAgICAgICAnPGRpdj48aW5wdXQgY2xhc3M9XCJidG4gY3RhIGdyYXlcIiB0eXBlPVwiZmlsZVwiLz48L2Rpdj48L2Rpdj4nLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCkge1xuICAgICAgICAgICAgc2NvcGUuc2VwYXJhdG9yVmlzaWJsZSA9IHNjb3BlLnNlcGFyYXRvclZpc2libGUgfHwgZmFsc2U7XG4gICAgICAgICAgICBzY29wZS5oZWFkZXJWaXNpYmxlID0gc2NvcGUuaGVhZGVyVmlzaWJsZSB8fCBmYWxzZTtcblxuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLnNlcGFyYXRvci1pbnB1dCcpKS5vbigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBzY29wZS5jb250ZW50ICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3N2OiBzY29wZS5jb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXBhcmF0b3I6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc6IHNjb3BlLmVuY29kaW5nXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VsdCA9IGNzdlRvSlNPTihjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVsZW1lbnQub24oJ2NoYW5nZScsIGZ1bmN0aW9uKG9uQ2hhbmdlRXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICBzY29wZS5maWxlbmFtZSA9IG9uQ2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKG9uTG9hZEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzdjogb25Mb2FkRXZlbnQudGFyZ2V0LnJlc3VsdC5yZXBsYWNlKC9cXHJcXG58XFxyL2csJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogc2NvcGUuaGVhZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcGFyYXRvcjogc2NvcGUuc2VwYXJhdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY29udGVudCA9IGNvbnRlbnQuY3N2O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0ID0gY3N2VG9KU09OKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0LmZpbGVuYW1lID0gc2NvcGUuZmlsZW5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAoIChvbkNoYW5nZUV2ZW50LnRhcmdldC50eXBlID09PSBcImZpbGVcIikgJiYgKG9uQ2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzICE9IG51bGwgfHwgb25DaGFuZ2VFdmVudC5zcmNFbGVtZW50LmZpbGVzICE9IG51bGwpICkgIHtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoKG9uQ2hhbmdlRXZlbnQuc3JjRWxlbWVudCB8fCBvbkNoYW5nZUV2ZW50LnRhcmdldCkuZmlsZXNbMF0sIHNjb3BlLmVuY29kaW5nKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIHNjb3BlLmNvbnRlbnQgIT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzdjogc2NvcGUuY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICFzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwYXJhdG9yOiBzY29wZS5zZXBhcmF0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQgPSBjc3ZUb0pTT04oY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmFyIGNzdlRvSlNPTiA9IGZ1bmN0aW9uKGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGluZXM9Y29udGVudC5jc3Yuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5Db3VudCA9IGxpbmVzWzBdLnNwbGl0KGNvbnRlbnQuc2VwYXJhdG9yKS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChjb250ZW50LmhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPWxpbmVzWzBdLnNwbGl0KGNvbnRlbnQuc2VwYXJhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9c3RhcnQ7IGk8bGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudGxpbmU9bGluZXNbaV0uc3BsaXQobmV3IFJlZ0V4cChjb250ZW50LnNlcGFyYXRvcisnKD8hW15cIl0qXCIoPzooPzpbXlwiXSpcIil7Mn0pKlteXCJdKiQpJykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnRsaW5lLmxlbmd0aCA9PT0gY29sdW1uQ291bnQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudC5oZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqPTA7IGo8aGVhZGVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpbaGVhZGVyc1tqXV0gPSBjdXJyZW50bGluZVtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGs9MDsgazxjdXJyZW50bGluZS5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpba10gPSBjdXJyZW50bGluZVtrXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChvYmopO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfX0pOyIsImFwcC5jb250cm9sbGVyKCdkYXNoYm9hcmRDdHJsJywgWyckbWREaWFsb2cnLCAnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkbWREaWFsb2csICRyb290U2NvcGUsICRzY29wZSwgJGh0dHApIHtcbiAgICB2YXIgdXNlcj0kcm9vdFNjb3BlLnVzZXI7XG5cblxuICAgIC8vbG9hZCBwcm9qZWN0IGxpc3Qgb24gcGFnZSBsb2FkXG4gICAgJGh0dHAuZ2V0KCcvcHJvamVjdC8nICsgdXNlci5pZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICRzY29wZS5wcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vcmVzcG9uc2UuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAvLyAgICBpdGVtLnByb2plY3RfbmFtZSA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcbi8vdGhpcyBpcyBmb3IgdGhlIGRlbGV0ZSBtb2RhbCBhbGVydCBmb3IgZGVsZXRpbmcgYSBwcm9qZWN0LS0gc3RpbGwgbm90IHdvcmtpbmcgY29ycmVjdFxuXG4gICAgJHNjb3BlLnNob3dEZWxldGUgPSBmdW5jdGlvbihldikge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdDTElDSycpO1xuICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgICAgIC50aXRsZSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB5b3VyIHByb2plY3Q/JylcbiAgICAgICAgICAgIC5jb250ZW50KCdUaGlzIGlzIHBlcm1hbmVudC4nKVxuICAgICAgICAgICAgLmFyaWFMYWJlbCgnRGVsZXRlIHByb2plY3QgcGVybWFuZW50bHknKVxuICAgICAgICAgICAgLm9rKCdEZWxldGUnKVxuICAgICAgICAgICAgLmNhbmNlbCgnQ2FuY2VsJylcbiAgICAgICAgICAgIC50YXJnZXRFdmVudChldik7XG4gICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBwcm9qZWN0IGhhcyBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBwcm9qZWN0IGhhcyBub3QgYmVlbiBkZWxldGVkLic7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvL25lZWQgdG8gY2hlY2sgaWYgd2UgbmVlZCB0aGlzIVxuLy8gICAgZnVuY3Rpb24gRGlhbG9nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZykge1xuLy8gICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbigpIHtcbi8vICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcbi8vICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmFuc3dlciA9IGZ1bmN0aW9uKGFuc3dlcikge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKGFuc3dlcik7XG4vLyAgICB9O1xuLy99XG5cbn1dKTsiLCIvLyBMb2dpbiBIVE1MIC0gS2F0ZVxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSkge1xuICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLmZvcm1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YS50b2tlbik7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICB9KVxuICAgIH1cbn1dKTsiLCIvLyBDaGFuZ2UgTmF2aWdhdGlvbiBPcHRpb25zIHdpdGggTG9naW5cbmFwcC5jb250cm9sbGVyKCduYXZDdHJsJywgWydhdXRoU2VydmljZScsICckc2NvcGUnLCAnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnJGh0dHAnLCBmdW5jdGlvbihhdXRoU2VydmljZSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sICRodHRwKXtcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG5cbiAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG59XSk7XG4iLCIvLyBQcm9qZWN0IFBhZ2UgLSAgS2ltL01hZGVsZWluZVxuYXBwLmNvbnRyb2xsZXIoJ3Byb2plY3RzQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuXG4gICAgLy8gU2VsZiBkZWNcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5wcm9qZWN0TGlzdCA9ICcnO1xuICAgIHNlbGYucmVzdWx0ID0gJyc7XG4gICAgc2VsZi5xdWVyeVNlYXJjaCA9IHF1ZXJ5U2VhcmNoO1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtQ2hhbmdlID0gc2VsZWN0ZWRJdGVtQ2hhbmdlO1xuICAgIHNlbGYuc2VhcmNoVGV4dENoYW5nZSA9IHNlYXJjaFRleHRDaGFuZ2U7XG4gICAgc2VsZi5wcm9qZWN0VG90YWw9IDA7XG4gICAgc2VsZi5kZWxldGVQcm9qZWN0SXRlbSA9IGRlbGV0ZVByb2plY3RJdGVtO1xuICAgIHNlbGYuaWQgPSAwO1xuXG5cbiAgICAvL2xvYWQgcHJvamVjdCBsaXN0IG9uIHBhZ2UgbG9hZFxuICAgIHNlbGYuZ2V0UHJvamVjdExpc3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy9uZWVkIHRvIGZpZ3VyZSBvdXQgaG93IHRvIHBhc3MgdGhlIHVzZXJpZCBmcm9tIHRoZSBsb2dpbiBwYWdlLS11c2UgdGhlIHNhbWUgY29udHJvbGxlcj9cbiAgICAgICAgJGh0dHAuZ2V0KCcvcHJvamVjdCcsIHVzZXJpZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIHZhciBwcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBwcm9qZWN0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5wcm9qZWN0X25hbWUgPSBpdGVtLnByb2plY3RfbmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIC8vaXRlbS5wcm9qZWN0X2Rlc2NyaXB0aW9uID0gaXRlbS5wcm9qZWN0X2Rlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgIC8vaXRlbS5pdGVtSWQgPSBpdGVtLmlkO1xuICAgICAgICAgICAgICAgIC8vaXRlbS5jbzJfb2Zmc2V0ID0gaXRlbS5jbzJfb2Zmc2V0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLnByb2plY3RMaXN0ID0gcHJvamVjdExpc3Q7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBxdWVyeVNlYXJjaChxdWVyeSkge1xuICAgICAgICByZXR1cm4gcXVlcnkgPyBzZWxmLnByb2plY3RMaXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSA6IHNlbGYucHJvamVjdExpc3Q7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmoucHJpbWFyeV9jYXQuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLnByb2plY3RfbmFtZSA9ICcnO1xuICAgICAgICAgICAgc2VsZi5wcm9qZWN0X2Rlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuc2hvd0RlbGV0ZSA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDTElDSycpO1xuICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgICAgIC50aXRsZSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGl0ZW0/JylcbiAgICAgICAgICAgIC5jb250ZW50KCdUaGlzIHdpbGwgYmUgcGVybWFuZW50LicpXG4gICAgICAgICAgICAuYXJpYUxhYmVsKCdEZWxldGUgaXRlbSBwZXJtYW5lbnRseScpXG4gICAgICAgICAgICAub2soJ0RlbGV0ZScpXG4gICAgICAgICAgICAuY2FuY2VsKCdDYW5jZWwnKVxuICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIGl0ZW0gaGFzIGJlZW4gZGVsZXRlZC4nO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIGl0ZW0gaGFzIG5vdCBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSk7XG4gICAgfTtcbi8vICAgIGZ1bmN0aW9uIERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2cpIHtcbi8vICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5hbnN3ZXIgPSBmdW5jdGlvbihhbnN3ZXIpIHtcbi8vICAgICAgICAkbWREaWFsb2cuaGlkZShhbnN3ZXIpO1xuLy8gICAgfTtcbi8vfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlUHJvamVjdEl0ZW0oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGVsZXRpbmcuLi5cIiwgc2VsZi5wcm9qZWN0TGlzdC5JRCk7XG4gICAgICAgIC8vJGh0dHAudXBkYXRlKCcvcHJvamVjdCcpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIC8vZmluZE9uZSBhbmQgZGVsZXRlIGJ5IGlkIHVzaW5nIHByb2plY3RsaXN0LmlkXG4gICAgICAgIC8vICAgIGNvbnNvbGUubG9nKFwiSXRlbSB3YXMgZGVsZXRlZC5cIiwgcmVzcG9uc2UpO1xuICAgICAgICAvLyAgICBzZWxmLmdldFByb2plY3RMaXN0KCk7XG4gICAgfTtcblxuICAgIC8vc2VsZi5jYWxjdWxhdGVQcm9qZWN0VG90YWwoKXtcbiAgICAvLy8vZm9yRWFjaCBwcm9qZWN0XG4gICAgLy8gICAgdmFyIHByb2plY3RUb3RhbCs9cHJvamVjdExpc3QuY28yX29mZnNldDtcbiAgICAvLyAgICByZXR1cm4gcHJvamVjdFRvdGFsO1xuICAgIC8vfVxuICAgIC8vfTtcbn1dKTsiLCIvLyBTZXJ2aWNlcyBmb3IgYXV0aGVudGljYXRpb25cbmFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KXtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
>>>>>>> dd7b2fb07f4aeba3e0d22e79fc51344ce3378789
