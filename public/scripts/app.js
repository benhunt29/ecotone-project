var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,o,n){o.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl as ctrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("adminCtrl",["$http","$scope","$parse",function(e,t,o){function n(t){var o=t.id;console.log(o),e.put("/suggestion/complete/"+o).then(function(e){r()})}function r(){e.get("/suggestion").then(function(e){var t=e.data;console.log(t),a.suggestions=t})}r();var a=this;a.suggestions="",a.markComplete=n,t.csv={content:null,header:!0,headerVisible:!0,separator:",",separatorVisible:!0,result:null,encoding:"ISO-8859-1",encodingVisible:!0};var i="";t.toPrettyJSON=function(e,t){var n=JSON.stringify(e),r=null;try{r=o(n)({})}catch(a){return i}var l=JSON.stringify(r,null,Number(t));return i=l,l}}]),app.controller("adminCtrl",["$http",function(e){function t(t){var n=t.id;console.log(n),e.put("/suggestion/complete/"+n).then(function(e){o()})}function o(){e.get("/suggestion").then(function(e){var t=e.data;console.log(t),n.suggestions=t})}o();var n=this;n.suggestions="",n.markComplete=t}]),app.controller("calculateCtrl",["$http","$mdDialog","$rootScope","authService","$location",function(e,t,o,n,r){function a(e){console.log("Text changed to ",e)}function i(e){void 0==e&&(d.category="",d.subcategory="",d.warmId="",d.weight="",d.conversion="",d.result="")}function l(){var t={warmId:d.warmId||d.category.secondaries[0].warm_id,weight:parseFloat(d.weight)*d.conversion};e.post("/calculations",t).then(function(e){d.result=Math.floor(1e3*Math.abs(e.data))/1e3})}function s(e){return e?d.list.filter(c(e)):d.list}function c(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function u(){e.post("/suggestion",d.submission).then(function(e){t.hide()})}function p(e){document.getElementById("sidenav").focus(),t.show({templateUrl:"/views/submit-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:d.searchText}})}o.user=n.getUser(),o.user&&o.user.username&&r.path("/"),e.get("/materials").then(function(e){var t=e.data;t.forEach(function(e){e.primary_cat=e.primary_cat.toLowerCase()}),d.list=t});var d=this;d.list="",d.isDisabled=!1,d.result="",d.querySearch=s,d.selectedItemChange=i,d.searchTextChange=a,d.newSuggestion=p,d.submitSuggestion=u,d.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],d.submission={email:"",material:"",notes:""},d.newCalculation=l}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(e,t,o){e.user={},e.processForm=function(n){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),o.path("/login"),alert("Your account has been created.")})}}]),app.directive("ngCsvImport",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{content:"=?",header:"=?",headerVisible:"=?",separator:"=?",separatorVisible:"=?",result:"=?",encoding:"=?",encodingVisible:"=?"},template:'<div><div ng-show="headerVisible"><div class="label">Header</div><input type="checkbox" ng-model="header"></div><div ng-show="encoding && encodingVisible"><div class="label">Encoding</div><span>{{encoding}}</span></div><div ng-show="separator && separatorVisible"><div class="label">Seperator</div><span><input class="separator-input" type="text" ng-change="changeSeparator" ng-model="separator"><span></div><div><input class="btn cta gray" type="file"/></div></div>',link:function(e,t){e.separatorVisible=e.separatorVisible||!1,e.headerVisible=e.headerVisible||!1,angular.element(t[0].querySelector(".separator-input")).on("keyup",function(t){if(null!=e.content){var n={csv:e.content,header:e.header,separator:t.target.value,encoding:e.encoding};e.result=o(n),e.$apply()}}),t.on("change",function(t){var n=new FileReader;if(e.filename=t.target.files[0].name,n.onload=function(t){e.$apply(function(){var n={csv:t.target.result.replace(/\r\n|\r/g,"\n"),header:e.header,separator:e.separator};e.content=n.csv,e.result=o(n),e.result.filename=e.filename})},"file"!==t.target.type||null==t.target.files&&null==t.srcElement.files){if(null!=e.content){var r={csv:e.content,header:!e.header,separator:e.separator};e.result=o(r)}}else n.readAsText((t.srcElement||t.target).files[0],e.encoding)});var o=function(e){var t=e.csv.split("\n"),o=[],n=0,r=t[0].split(e.separator).length,a=[];e.header&&(a=t[0].split(e.separator),n=1);for(var i=n;i<t.length;i++){var l={},s=t[i].split(new RegExp(e.separator+'(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)'));if(s.length===r){if(e.header)for(var c=0;c<a.length;c++)l[a[c]]=s[c];else for(var u=0;u<s.length;u++)l[u]=s[u];o.push(l)}}return o}}}}),app.controller("dashboardCtrl",["$mdDialog","$scope","$http",function(e,t,o){o.get("/project").then(function(e){console.log(e),t.projectList=e.data}),t.showDelete=function(o){console.log("CLICK");var n=e.confirm().title("Are you sure you want to delete your project?").content("This is permanent.").ariaLabel("Delete project permanently").ok("Delete").cancel("Cancel").targetEvent(o);e.show(n).then(function(){t.alert="Your project has been deleted."},function(){t.alert="Your project has not been deleted."})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(e,t,o,n,r){e.login=function(){t({method:"POST",url:"/login",data:e.form}).then(function(e){o.saveToken(e.data.token),r.user=o.getUser(),n.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,o,n,r){o.user=e.getUser(),o.user&&o.user.username&&n.path("/"),t.logout=function(){e.logout(),o.user=e.getUser(),n.path("/")}}]),app.controller("projectsCtrl",["$mdDialog","$scope","$rootScope","$http",function(e,t,o,n){function r(e){return console.log("This is the project list:"),console.log(c.projectList),e?c.projectList.filter(a(e)):c.projectList}function a(e){var t=e.toLowerCase();return function(e){return-1!=e.project_name.indexOf(t)}}function i(e){console.log("Text changed to ",e)}function l(e){void 0==e&&(c.project_name="",c.project_description="")}function s(){console.log("Deleting...",c.project_id)}var c=this;c.projectList=[{id:21,project_name:"Ben's House",project_description:"Remodel",created_at:"2015-10-14T16:42:40.896Z",updated_at:"2015-10-14T16:42:40.901Z",user_id:4,category:"wood",sub_category:"oak",units:"lbs",weight:10,co2_offset:.03,project_id:6,item_description:"porch spindles"},{id:202,project_name:"James' House",project_description:"Teardown",created_at:"2014-10-14T16:42:40.896Z",updated_at:"2014-10-14T16:42:40.901Z",user_id:24,category:"asphalt shingles",sub_category:"null",units:"lbs",weight:100,co2_offset:.303,project_id:6,item_description:"roof shingles"},{id:2112,project_name:"Kim's Barn",project_description:"Remodel",created_at:"2013-10-14T16:42:40.896Z",updated_at:"2013-10-14T16:42:40.901Z",user_id:14,category:"wood flooring",sub_category:"pine",units:"lbs",weight:500,co2_offset:3.03,project_id:6,item_description:"barn wood"}],c.result="",c.querySearch=r,c.selectedItemChange=l,c.searchTextChange=i,c.projectTotal=0,c.deleteProjectItem=s,c.id=0,console.log(c.projectList),t.showDelete=function(o){console.log("CLICK");var n=e.confirm().title("Are you sure you want to delete this item?").content("This will be permanent.").ariaLabel("Delete item permanently").ok("Delete").cancel("Cancel").targetEvent(o);e.show(n).then(function(){t.alert="Your item has been deleted."},function(){t.alert="Your item has not been deleted."})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],n=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(n))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzY3JpcHRzL2FkbWluQ3RybC5qcyIsInNjcmlwdHMvYXBwLmpzIiwic2NyaXB0cy9jYWxjdWxhdGVDdHJsLmpzIiwic2NyaXB0cy9jcmVhdGVBY2NvdW50Q3RybC5qcyIsInNjcmlwdHMvY3N2SW1wb3J0LmpzIiwic2NyaXB0cy9kYXNoYm9hcmRDdHJsLmpzIiwic2NyaXB0cy9sb2dpbkN0cmwuanMiLCJzY3JpcHRzL25hdkN0cmwuanMiLCJzY3JpcHRzL3Byb2plY3RzQ3RybC5qcyIsInNjcmlwdHMvc2VydmljZXMuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRtZFRoZW1pbmdQcm92aWRlciIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCIkaHR0cFByb3ZpZGVyIiwiaHRtbDVNb2RlIiwidGhlbWUiLCJwcmltYXJ5UGFsZXR0ZSIsImFjY2VudFBhbGV0dGUiLCJkZWZhdWx0Iiwid2FyblBhbGV0dGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsIiRodHRwIiwiJHNjb3BlIiwiJHBhcnNlIiwibWFya0NvbXBsZXRlIiwic3VnZ2VzdGlvbiIsImlkIiwiY29uc29sZSIsImxvZyIsInB1dCIsInRoZW4iLCJyZXMiLCJpbml0IiwiZ2V0Iiwic3VnZ2VzdGlvbnMiLCJkYXRhIiwic2VsZiIsInRoaXMiLCJjc3YiLCJjb250ZW50IiwiaGVhZGVyIiwiaGVhZGVyVmlzaWJsZSIsInNlcGFyYXRvciIsInNlcGFyYXRvclZpc2libGUiLCJyZXN1bHQiLCJlbmNvZGluZyIsImVuY29kaW5nVmlzaWJsZSIsIl9sYXN0R29vZFJlc3VsdCIsInRvUHJldHR5SlNPTiIsImpzb24iLCJ0YWJXaWR0aCIsIm9ialN0ciIsIkpTT04iLCJzdHJpbmdpZnkiLCJvYmoiLCJlIiwiTnVtYmVyIiwiJG1kRGlhbG9nIiwiJHJvb3RTY29wZSIsImF1dGhTZXJ2aWNlIiwiJGxvY2F0aW9uIiwic2VhcmNoVGV4dENoYW5nZSIsInRleHQiLCJzZWxlY3RlZEl0ZW1DaGFuZ2UiLCJpdGVtIiwidW5kZWZpbmVkIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1JZCIsIndlaWdodCIsImNvbnZlcnNpb24iLCJuZXdDYWxjdWxhdGlvbiIsImNhbGN1bGF0ZSIsInNlY29uZGFyaWVzIiwid2FybV9pZCIsInBhcnNlRmxvYXQiLCJwb3N0IiwicmVzcG9uc2UiLCJNYXRoIiwiZmxvb3IiLCJhYnMiLCJxdWVyeVNlYXJjaCIsInF1ZXJ5IiwibGlzdCIsImZpbHRlciIsImNyZWF0ZUZpbHRlckZvciIsImxvd2VyY2FzZVF1ZXJ5IiwidG9Mb3dlckNhc2UiLCJwcmltYXJ5X2NhdCIsImluZGV4T2YiLCJzdWJtaXRTdWdnZXN0aW9uIiwic3VibWlzc2lvbiIsImhpZGUiLCJuZXdTdWdnZXN0aW9uIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImZvY3VzIiwic2hvdyIsImNsaWNrT3V0c2lkZVRvQ2xvc2UiLCJjb250cm9sbGVyQXMiLCJsb2NhbHMiLCJtYXRlcmlhbCIsInNlYXJjaFRleHQiLCJ1c2VyIiwiZ2V0VXNlciIsInVzZXJuYW1lIiwicGF0aCIsImZvckVhY2giLCJpc0Rpc2FibGVkIiwidW5pdHMiLCJuYW1lIiwiZW1haWwiLCJub3RlcyIsInByb2Nlc3NGb3JtIiwibWV0aG9kIiwidXJsIiwiZGF0YVR5cGUiLCJhbGVydCIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwidHJhbnNjbHVkZSIsInJlcGxhY2UiLCJzY29wZSIsInRlbXBsYXRlIiwibGluayIsImVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib24iLCJ0YXJnZXQiLCJ2YWx1ZSIsImNzdlRvSlNPTiIsIiRhcHBseSIsIm9uQ2hhbmdlRXZlbnQiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwiZmlsZW5hbWUiLCJmaWxlcyIsIm9ubG9hZCIsIm9uTG9hZEV2ZW50IiwidHlwZSIsInNyY0VsZW1lbnQiLCJyZWFkQXNUZXh0IiwibGluZXMiLCJzcGxpdCIsInN0YXJ0IiwiY29sdW1uQ291bnQiLCJsZW5ndGgiLCJoZWFkZXJzIiwiaSIsImN1cnJlbnRsaW5lIiwiUmVnRXhwIiwiaiIsImsiLCJwdXNoIiwicHJvamVjdExpc3QiLCJzaG93RGVsZXRlIiwiZXYiLCJjb25maXJtIiwidGl0bGUiLCJhcmlhTGFiZWwiLCJvayIsImNhbmNlbCIsInRhcmdldEV2ZW50IiwibG9naW4iLCJmb3JtIiwic2F2ZVRva2VuIiwidG9rZW4iLCJsb2dvdXQiLCJwcm9qZWN0X25hbWUiLCJwcm9qZWN0X2Rlc2NyaXB0aW9uIiwiZGVsZXRlUHJvamVjdEl0ZW0iLCJwcm9qZWN0X2lkIiwiY3JlYXRlZF9hdCIsInVwZGF0ZWRfYXQiLCJ1c2VyX2lkIiwic3ViX2NhdGVnb3J5IiwiY28yX29mZnNldCIsIml0ZW1fZGVzY3JpcHRpb24iLCJwcm9qZWN0VG90YWwiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInBhcnNlSnd0IiwiYmFzZTY0VXJsIiwiYmFzZTY0IiwicGFyc2UiLCJhdG9iIiwibG9jYWxTdG9yYWdlIiwiand0VG9rZW4iLCJnZXRUb2tlbiIsImlzQXV0aGVkIiwicGFyYW1zIiwibm90RXhwaXJlZCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJmYWN0b3J5IiwiJHEiLCJyZXF1ZXN0IiwiQXV0aG9yaXphdGlvbiIsInN0YXR1cyIsInJlc3BvbnNlRXJyb3IiLCJyZWplY3QiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsY0FBQSxVQUFBLGFBQUEsYUFBQSxvQkFFQUYsS0FBQUcsUUFBQSxxQkFBQSxpQkFBQSxvQkFBQSxnQkFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBRCxFQUFBRSxXQUFBLEdBR0FKLEVBQUFLLE1BQUEsV0FDQUMsZUFBQSxTQUNBQyxjQUFBLGFBQUFDLFVBQUEsUUFDQUMsWUFBQSxVQUdBUixFQUFBUyxLQUFBLEtBRUFDLFlBQUEseUJBQ0FDLFdBQUEsMEJBQ0FGLEtBQUEsVUFFQUMsWUFBQSxvQkFDQUMsV0FBQSxjQUNBRixLQUFBLGFBRUFDLFlBQUEsdUJBQ0FDLFdBQUEsc0JBQ0FGLEtBQUEsVUFFQUMsWUFBQSxvQkFDQUMsV0FBQSxzQkFFQUYsS0FBQSxZQUVBQyxZQUFBLHNCQUNBQyxXQUFBLEtBQ0FGLEtBQUEsY0FFQUMsWUFBQSx3QkFDQUMsV0FBQSxrQkFDQUYsS0FBQSxhQUVBQyxZQUFBLHNCQUNBQyxXQUFBLHlCQUNBRixLQUFBLFVBRUFDLFlBQUEsc0JBQ0FELEtBQUEsWUFFQUMsWUFBQSxzQkFDQUMsV0FBQSxLQUNBRixLQUFBLFlBRUFDLFlBQUEsd0JBQ0FELEtBQUEsWUFFQUMsWUFBQSx3QkFDQUUsV0FDQUMsV0FBQSxTQ3BEQWxCLElBQUFnQixXQUFBLGFBQUEsUUFBQSxTQUFBLFNBQUEsU0FBQUcsRUFBQUMsRUFBQUMsR0FRQSxRQUFBQyxHQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUFDLEVBQ0FDLFNBQUFDLElBQUFGLEdBQ0FMLEVBQUFRLElBQUEsd0JBQUFILEdBQUFJLEtBQUEsU0FBQUMsR0FDQUMsTUFJQSxRQUFBQSxLQUNBWCxFQUFBWSxJQUFBLGVBQUFILEtBQUEsU0FBQUMsR0FDQSxHQUFBRyxHQUFBSCxFQUFBSSxJQUNBUixTQUFBQyxJQUFBTSxHQUNBRSxFQUFBRixZQUFBQSxJQWxCQUYsR0FFQSxJQUFBSSxHQUFBQyxJQUNBRCxHQUFBRixZQUFBLEdBQ0FFLEVBQUFaLGFBQUFBLEVBa0JBRixFQUFBZ0IsS0FDQUMsUUFBQSxLQUNBQyxRQUFBLEVBQ0FDLGVBQUEsRUFDQUMsVUFBQSxJQUNBQyxrQkFBQSxFQUNBQyxPQUFBLEtBQ0FDLFNBQUEsYUFDQUMsaUJBQUEsRUFHQSxJQUFBQyxHQUFBLEVBQ0F6QixHQUFBMEIsYUFBQSxTQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFDLEtBQUFDLFVBQUFKLEdBQ0FLLEVBQUEsSUFDQSxLQUNBQSxFQUFBL0IsRUFBQTRCLE9BQ0EsTUFBQUksR0FFQSxNQUFBUixHQUdBLEdBQUFILEdBQUFRLEtBQUFDLFVBQUFDLEVBQUEsS0FBQUUsT0FBQU4sR0FHQSxPQUZBSCxHQUFBSCxFQUVBQSxNQ2pEQTFDLElBQUFnQixXQUFBLGFBQUEsUUFBQSxTQUFBRyxHQVFBLFFBQUFHLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUQsRUFBQUMsRUFDQUMsU0FBQUMsSUFBQUYsR0FDQUwsRUFBQVEsSUFBQSx3QkFBQUgsR0FBQUksS0FBQSxTQUFBQyxHQUNBQyxNQUlBLFFBQUFBLEtBQ0FYLEVBQUFZLElBQUEsZUFBQUgsS0FBQSxTQUFBQyxHQUNBLEdBQUFHLEdBQUFILEVBQUFJLElBQ0FSLFNBQUFDLElBQUFNLEdBQ0FFLEVBQUFGLFlBQUFBLElBbEJBRixHQUVBLElBQUFJLEdBQUFDLElBQ0FELEdBQUFGLFlBQUEsR0FDQUUsRUFBQVosYUFBQUEsS0NUQXRCLElBQUFnQixXQUFBLGlCQUFBLFFBQUEsWUFBQSxhQUFBLGNBQUEsWUFBQSxTQUFBRyxFQUFBb0MsRUFBQUMsRUFBQUMsRUFBQUMsR0EyREEsUUFBQUMsR0FBQUMsR0FDQW5DLFFBQUFDLElBQUEsbUJBQUFrQyxHQUdBLFFBQUFDLEdBQUFDLEdBQ0FDLFFBQUFELElBQ0E1QixFQUFBOEIsU0FBQSxHQUNBOUIsRUFBQStCLFlBQUEsR0FDQS9CLEVBQUFnQyxPQUFBLEdBQ0FoQyxFQUFBaUMsT0FBQSxHQUNBakMsRUFBQWtDLFdBQUEsR0FDQWxDLEVBQUFRLE9BQUEsSUFJQSxRQUFBMkIsS0FFQSxHQUFBQyxJQUNBSixPQUFBaEMsRUFBQWdDLFFBQUFoQyxFQUFBOEIsU0FBQU8sWUFBQSxHQUFBQyxRQUNBTCxPQUFBTSxXQUFBdkMsRUFBQWlDLFFBQUFqQyxFQUFBa0MsV0FHQWpELEdBQUF1RCxLQUFBLGdCQUFBSixHQUFBMUMsS0FBQSxTQUFBK0MsR0FDQXpDLEVBQUFRLE9BQUFrQyxLQUFBQyxNQUFBLElBQUFELEtBQUFFLElBQUFILEVBQUExQyxPQUFBLE1Ba0JBLFFBQUE4QyxHQUFBQyxHQUNBLE1BQUFBLEdBQUE5QyxFQUFBK0MsS0FBQUMsT0FBQUMsRUFBQUgsSUFBQTlDLEVBQUErQyxLQUdBLFFBQUFFLEdBQUFILEdBQ0EsR0FBQUksR0FBQUosRUFBQUssYUFFQSxPQUFBLFVBQUFqQyxHQUNBLE1BQUEsSUFBQUEsRUFBQWtDLFlBQUFDLFFBQUFILElBSUEsUUFBQUksS0FDQXJFLEVBQUF1RCxLQUFBLGNBQUF4QyxFQUFBdUQsWUFBQTdELEtBQUEsU0FBQUMsR0FDQTBCLEVBQUFtQyxTQUlBLFFBQUFDLEdBQUFwRSxHQUNBcUUsU0FBQUMsZUFBQSxXQUFBQyxRQUVBdkMsRUFBQXdDLE1BQ0FoRixZQUFBLDJCQUNBaUYscUJBQUEsRUFDQWhGLFdBQUEsZ0JBQ0FpRixhQUFBLE9BQ0FDLFFBQUFDLFNBQUFqRSxFQUFBa0UsY0EzSEE1QyxFQUFBNkMsS0FBQTVDLEVBQUE2QyxVQUVBOUMsRUFBQTZDLE1BQUE3QyxFQUFBNkMsS0FBQUUsVUFDQTdDLEVBQUE4QyxLQUFBLEtBSUFyRixFQUFBWSxJQUFBLGNBQUFILEtBQUEsU0FBQStDLEdBQ0EsR0FBQU0sR0FBQU4sRUFBQTFDLElBRUFnRCxHQUFBd0IsUUFBQSxTQUFBM0MsR0FDQUEsRUFBQXdCLFlBQUF4QixFQUFBd0IsWUFBQUQsZ0JBSUFuRCxFQUFBK0MsS0FBQUEsR0FLQSxJQUFBL0MsR0FBQUMsSUFFQUQsR0FBQStDLEtBQUEsR0FDQS9DLEVBQUF3RSxZQUFBLEVBQ0F4RSxFQUFBUSxPQUFBLEdBQ0FSLEVBQUE2QyxZQUFBQSxFQUNBN0MsRUFBQTJCLG1CQUFBQSxFQUNBM0IsRUFBQXlCLGlCQUFBQSxFQUNBekIsRUFBQXlELGNBQUFBLEVBQ0F6RCxFQUFBc0QsaUJBQUFBLEVBQ0F0RCxFQUFBeUUsUUFFQUMsS0FBQSxNQUNBeEMsV0FBQSxPQUdBd0MsS0FBQSxRQUNBeEMsV0FBQSxZQUdBd0MsS0FBQSxPQUNBeEMsV0FBQSxJQUdBd0MsS0FBQSxjQUNBeEMsV0FBQSxVQUdBbEMsRUFBQXVELFlBQ0FvQixNQUFBLEdBQ0FWLFNBQUEsR0FDQVcsTUFBQSxJQUVBNUUsRUFBQW1DLGVBQUFBLEtDdkRBckUsSUFBQWdCLFdBQUEscUJBQUEsU0FBQSxRQUFBLFlBQUEsU0FBQUksRUFBQUQsRUFBQXVDLEdBQ0F0QyxFQUFBaUYsUUFFQWpGLEVBQUEyRixZQUFBLFNBQUFWLEdBQ0E1RSxRQUFBQyxJQUFBLGNBQ0FQLEdBQ0E2RixPQUFBLE9BQ0FDLElBQUEsWUFDQWhGLEtBQUFiLEVBQUFpRixLQUNBYSxTQUFBLFNBQ0F0RixLQUFBLFNBQUErQyxHQUNBbEQsUUFBQUMsSUFBQWlELEdBQ0FqQixFQUFBOEMsS0FBQSxVQUNBVyxNQUFBLHdDQ1ZBbkgsSUFBQW9ILFVBQUEsY0FBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsWUFBQSxFQUNBQyxTQUFBLEVBQ0FDLE9BQ0FuRixRQUFBLEtBQ0FDLE9BQUEsS0FDQUMsY0FBQSxLQUNBQyxVQUFBLEtBQ0FDLGlCQUFBLEtBQ0FDLE9BQUEsS0FDQUMsU0FBQSxLQUNBQyxnQkFBQSxNQUVBNkUsU0FBQSxxZEFJQUMsS0FBQSxTQUFBRixFQUFBRyxHQUNBSCxFQUFBL0UsaUJBQUErRSxFQUFBL0UsbUJBQUEsRUFDQStFLEVBQUFqRixjQUFBaUYsRUFBQWpGLGdCQUFBLEVBRUF0QyxRQUFBMEgsUUFBQUEsRUFBQSxHQUFBQyxjQUFBLHFCQUFBQyxHQUFBLFFBQUEsU0FBQXhFLEdBQ0EsR0FBQSxNQUFBbUUsRUFBQW5GLFFBQUEsQ0FDQSxHQUFBQSxJQUNBRCxJQUFBb0YsRUFBQW5GLFFBQ0FDLE9BQUFrRixFQUFBbEYsT0FDQUUsVUFBQWEsRUFBQXlFLE9BQUFDLE1BQ0FwRixTQUFBNkUsRUFBQTdFLFNBRUE2RSxHQUFBOUUsT0FBQXNGLEVBQUEzRixHQUNBbUYsRUFBQVMsWUFJQU4sRUFBQUUsR0FBQSxTQUFBLFNBQUFLLEdBQ0EsR0FBQUMsR0FBQSxHQUFBQyxXQWVBLElBZEFaLEVBQUFhLFNBQUFILEVBQUFKLE9BQUFRLE1BQUEsR0FBQTFCLEtBQ0F1QixFQUFBSSxPQUFBLFNBQUFDLEdBQ0FoQixFQUFBUyxPQUFBLFdBQ0EsR0FBQTVGLElBQ0FELElBQUFvRyxFQUFBVixPQUFBcEYsT0FBQTZFLFFBQUEsV0FBQSxNQUNBakYsT0FBQWtGLEVBQUFsRixPQUNBRSxVQUFBZ0YsRUFBQWhGLFVBRUFnRixHQUFBbkYsUUFBQUEsRUFBQUQsSUFDQW9GLEVBQUE5RSxPQUFBc0YsRUFBQTNGLEdBQ0FtRixFQUFBOUUsT0FBQTJGLFNBQUFiLEVBQUFhLFlBSUEsU0FBQUgsRUFBQUosT0FBQVcsTUFBQSxNQUFBUCxFQUFBSixPQUFBUSxPQUFBLE1BQUFKLEVBQUFRLFdBQUFKLE9BR0EsR0FBQSxNQUFBZCxFQUFBbkYsUUFBQSxDQUNBLEdBQUFBLElBQ0FELElBQUFvRixFQUFBbkYsUUFDQUMsUUFBQWtGLEVBQUFsRixPQUNBRSxVQUFBZ0YsRUFBQWhGLFVBRUFnRixHQUFBOUUsT0FBQXNGLEVBQUEzRixRQVJBOEYsR0FBQVEsWUFBQVQsRUFBQVEsWUFBQVIsRUFBQUosUUFBQVEsTUFBQSxHQUFBZCxFQUFBN0UsV0FhQSxJQUFBcUYsR0FBQSxTQUFBM0YsR0FDQSxHQUFBdUcsR0FBQXZHLEVBQUFELElBQUF5RyxNQUFBLE1BQ0FuRyxLQUNBb0csRUFBQSxFQUNBQyxFQUFBSCxFQUFBLEdBQUFDLE1BQUF4RyxFQUFBRyxXQUFBd0csT0FFQUMsSUFDQTVHLEdBQUFDLFNBQ0EyRyxFQUFBTCxFQUFBLEdBQUFDLE1BQUF4RyxFQUFBRyxXQUNBc0csRUFBQSxFQUdBLEtBQUEsR0FBQUksR0FBQUosRUFBQUksRUFBQU4sRUFBQUksT0FBQUUsSUFBQSxDQUNBLEdBQUE5RixNQUNBK0YsRUFBQVAsRUFBQU0sR0FBQUwsTUFBQSxHQUFBTyxRQUFBL0csRUFBQUcsVUFBQSxzQ0FDQSxJQUFBMkcsRUFBQUgsU0FBQUQsRUFBQSxDQUNBLEdBQUExRyxFQUFBQyxPQUNBLElBQUEsR0FBQStHLEdBQUEsRUFBQUEsRUFBQUosRUFBQUQsT0FBQUssSUFDQWpHLEVBQUE2RixFQUFBSSxJQUFBRixFQUFBRSxPQUdBLEtBQUEsR0FBQUMsR0FBQSxFQUFBQSxFQUFBSCxFQUFBSCxPQUFBTSxJQUNBbEcsRUFBQWtHLEdBQUFILEVBQUFHLEVBR0E1RyxHQUFBNkcsS0FBQW5HLElBR0EsTUFBQVYsUUNsR0ExQyxJQUFBZ0IsV0FBQSxpQkFBQSxZQUFBLFNBQUEsUUFBQSxTQUFBdUMsRUFBQW5DLEVBQUFELEdBRUFBLEVBQUFZLElBQUEsWUFBQUgsS0FBQSxTQUFBK0MsR0FDQWxELFFBQUFDLElBQUFpRCxHQUNBdkQsRUFBQW9JLFlBQUE3RSxFQUFBMUMsT0FNQWIsRUFBQXFJLFdBQUEsU0FBQUMsR0FFQWpJLFFBQUFDLElBQUEsUUFDQSxJQUFBaUksR0FBQXBHLEVBQUFvRyxVQUNBQyxNQUFBLGlEQUNBdkgsUUFBQSxzQkFDQXdILFVBQUEsOEJBQ0FDLEdBQUEsVUFDQUMsT0FBQSxVQUNBQyxZQUFBTixFQUNBbkcsR0FBQXdDLEtBQUE0RCxHQUFBL0gsS0FBQSxXQUNBUixFQUFBK0YsTUFBQSxrQ0FDQSxXQUNBL0YsRUFBQStGLE1BQUEsMkNDdEJBbkgsSUFBQWdCLFdBQUEsYUFBQSxTQUFBLFFBQUEsY0FBQSxZQUFBLGFBQUEsU0FBQUksRUFBQUQsRUFBQXNDLEVBQUFDLEVBQUFGLEdBQ0FwQyxFQUFBNkksTUFBQSxXQUNBOUksR0FDQTZGLE9BQUEsT0FDQUMsSUFBQSxTQUNBaEYsS0FBQWIsRUFBQThJLE9BQ0F0SSxLQUFBLFNBQUErQyxHQUNBbEIsRUFBQTBHLFVBQUF4RixFQUFBMUMsS0FBQW1JLE9BQ0E1RyxFQUFBNkMsS0FBQTVDLEVBQUE2QyxVQUNBNUMsRUFBQThDLEtBQUEsV0NUQXhHLElBQUFnQixXQUFBLFdBQUEsY0FBQSxTQUFBLGFBQUEsWUFBQSxRQUFBLFNBQUF5QyxFQUFBckMsRUFBQW9DLEVBQUFFLEVBQUF2QyxHQUNBcUMsRUFBQTZDLEtBQUE1QyxFQUFBNkMsVUFFQTlDLEVBQUE2QyxNQUFBN0MsRUFBQTZDLEtBQUFFLFVBQ0E3QyxFQUFBOEMsS0FBQSxLQUdBcEYsRUFBQWlKLE9BQUEsV0FDQTVHLEVBQUE0RyxTQUNBN0csRUFBQTZDLEtBQUE1QyxFQUFBNkMsVUFDQTVDLEVBQUE4QyxLQUFBLFNDVkF4RyxJQUFBZ0IsV0FBQSxnQkFBQSxZQUFBLFNBQUEsYUFBQSxRQUFBLFNBQUF1QyxFQUFBbkMsRUFBQW9DLEVBQUFyQyxHQW9JQSxRQUFBNEQsR0FBQUMsR0FHQSxNQUZBdkQsU0FBQUMsSUFBQSw2QkFDQUQsUUFBQUMsSUFBQVEsRUFBQXNILGFBQ0F4RSxFQUFBOUMsRUFBQXNILFlBQUF0RSxPQUFBQyxFQUFBSCxJQUFBOUMsRUFBQXNILFlBR0EsUUFBQXJFLEdBQUFILEdBQ0EsR0FBQUksR0FBQUosRUFBQUssYUFFQSxPQUFBLFVBQUFqQyxHQUNBLE1BQUEsSUFBQUEsRUFBQWtILGFBQUEvRSxRQUFBSCxJQUlBLFFBQUF6QixHQUFBQyxHQUNBbkMsUUFBQUMsSUFBQSxtQkFBQWtDLEdBR0EsUUFBQUMsR0FBQUMsR0FDQUMsUUFBQUQsSUFDQTVCLEVBQUFvSSxhQUFBLEdBQ0FwSSxFQUFBcUksb0JBQUEsSUErQkEsUUFBQUMsS0FDQS9JLFFBQUFDLElBQUEsY0FBQVEsRUFBQXVJLFlBdExBLEdBQUF2SSxHQUFBQyxJQUNBRCxHQUFBc0gsY0FFQWhJLEdBQUEsR0FDQThJLGFBQUEsY0FDQUMsb0JBQUEsVUFDQUcsV0FBQSwyQkFDQUMsV0FBQSwyQkFDQUMsUUFBQSxFQUNBNUcsU0FBQSxPQUNBNkcsYUFBQSxNQUNBbEUsTUFBQSxNQUNBeEMsT0FBQSxHQUNBMkcsV0FBQSxJQUNBTCxXQUFBLEVBQ0FNLGlCQUFBLG1CQUdBdkosR0FBQSxJQUNBOEksYUFBQSxlQUNBQyxvQkFBQSxXQUNBRyxXQUFBLDJCQUNBQyxXQUFBLDJCQUNBQyxRQUFBLEdBQ0E1RyxTQUFBLG1CQUNBNkcsYUFBQSxPQUNBbEUsTUFBQSxNQUNBeEMsT0FBQSxJQUNBMkcsV0FBQSxLQUNBTCxXQUFBLEVBQ0FNLGlCQUFBLGtCQUdBdkosR0FBQSxLQUNBOEksYUFBQSxhQUNBQyxvQkFBQSxVQUNBRyxXQUFBLDJCQUNBQyxXQUFBLDJCQUNBQyxRQUFBLEdBQ0E1RyxTQUFBLGdCQUNBNkcsYUFBQSxPQUNBbEUsTUFBQSxNQUNBeEMsT0FBQSxJQUNBMkcsV0FBQSxLQUNBTCxXQUFBLEVBQ0FNLGlCQUFBLGNBRUE3SSxFQUFBUSxPQUFBLEdBQ0FSLEVBQUE2QyxZQUFBQSxFQUNBN0MsRUFBQTJCLG1CQUFBQSxFQUNBM0IsRUFBQXlCLGlCQUFBQSxFQUNBekIsRUFBQThJLGFBQUEsRUFDQTlJLEVBQUFzSSxrQkFBQUEsRUFDQXRJLEVBQUFWLEdBQUEsRUFDQUMsUUFBQUMsSUFBQVEsRUFBQXNILGFBb0dBcEksRUFBQXFJLFdBQUEsU0FBQUMsR0FDQWpJLFFBQUFDLElBQUEsUUFDQSxJQUFBaUksR0FBQXBHLEVBQUFvRyxVQUNBQyxNQUFBLDhDQUNBdkgsUUFBQSwyQkFDQXdILFVBQUEsMkJBQ0FDLEdBQUEsVUFDQUMsT0FBQSxVQUNBQyxZQUFBTixFQUNBbkcsR0FBQXdDLEtBQUE0RCxHQUFBL0gsS0FBQSxXQUNBUixFQUFBK0YsTUFBQSwrQkFDQSxXQUNBL0YsRUFBQStGLE1BQUEsd0NDektBbkgsSUFBQWlMLFFBQUEsZUFBQSxVQUFBLFNBQUFDLEdBQ0EvSSxLQUFBZ0osU0FBQSxTQUFBZixHQUNBLEdBQUFBLEVBQUEsQ0FDQSxHQUFBZ0IsR0FBQWhCLEVBQUF2QixNQUFBLEtBQUEsR0FDQXdDLEVBQUFELEVBQUE3RCxRQUFBLElBQUEsS0FBQUEsUUFBQSxJQUFBLElBQ0EsT0FBQXJFLE1BQUFvSSxNQUFBSixFQUFBSyxLQUFBRixJQUNBLFVBR0FsSixLQUFBZ0ksVUFBQSxTQUFBQyxHQUNBYyxFQUFBTSxhQUFBQyxTQUFBckIsRUFDQTNJLFFBQUFDLElBQUEsZUFBQXdKLEVBQUFNLGFBQUFDLFdBR0F0SixLQUFBdUosU0FBQSxXQUNBLE1BQUFSLEdBQUFNLGFBQUFDLFVBR0F0SixLQUFBd0osU0FBQSxXQUNBLEdBQUF2QixHQUFBakksS0FBQXVKLFVBQ0EsSUFBQXRCLEVBQUEsQ0FDQSxHQUFBd0IsR0FBQXpKLEtBQUFnSixTQUFBZixHQUNBeUIsRUFBQWpILEtBQUFrSCxPQUFBLEdBQUFDLE9BQUFDLFVBQUEsTUFBQUosRUFBQUssR0FJQSxPQUhBSixJQUNBMUosS0FBQWtJLFNBRUF3QixFQUVBLE9BQUEsR0FJQTFKLEtBQUFrSSxPQUFBLGlCQUNBYSxHQUFBTSxhQUFBQyxVQUlBdEosS0FBQW1FLFFBQUEsV0FDQSxNQUFBbkUsTUFBQWdKLFNBQUFoSixLQUFBdUosZ0JBSUExTCxJQUFBa00sUUFBQSxtQkFBQSxLQUFBLFlBQUEsY0FBQSxTQUFBQyxFQUFBekksRUFBQUQsR0FDQSxPQUNBMkksUUFBQSxTQUFBak0sR0FLQSxNQUpBQSxHQUFBOEksUUFBQTlJLEVBQUE4SSxZQUNBeEYsRUFBQWtJLGFBQ0F4TCxFQUFBOEksUUFBQW9ELGNBQUEsVUFBQTVJLEVBQUFpSSxZQUVBdkwsR0FFQXdFLFNBQUEsU0FBQUEsR0FPQSxNQUxBLE9BQUFBLEVBQUEySCxRQUdBNUksRUFBQThDLEtBQUEsVUFFQTdCLEdBQUF3SCxFQUFBckwsS0FBQTZELElBQ0E0SCxjQUFBLFNBQUE1SCxHQU9BLE1BTkEsT0FBQUEsRUFBQTJILE9BQ0E1SSxFQUFBOEMsS0FBQSxVQUdBL0UsUUFBQUMsSUFBQWlELEdBRUF3SCxFQUFBSyxPQUFBN0giLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdlY290b25lQXBwJywgWyduZ1JvdXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcycsICd2YWxpZGF0aW9uLm1hdGNoJ10pO1xuXG5hcHAuY29uZmlnKFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywgJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJGh0dHBQcm92aWRlcil7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy9zZXQgdGhlbWUgYW5kIGNvbG9yIHBhbGV0dGVcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2dyZWVuJylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2JsdWUtZ3JleScsIHsnZGVmYXVsdCc6JzYwMCd9KVxuICAgICAgICAud2FyblBhbGV0dGUgKCdvcmFuZ2UnKTtcblxuICAgIC8vcm91dGVzIGZvciB2aWV3c1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jYWxjdWxhdG9yLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhbGN1bGF0ZUN0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FkbWluJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWRtaW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWRtaW5DdHJsIGFzIGN0cmwnXG5cbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcHJvamVjdHMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcm9qZWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RzQ3RybCBhcyBjdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWJvdXQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hYm91dC5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcHJpdmFjeScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3ByaXZhY3kuaHRtbCdcbiAgICAgICAgfSkud2hlbignL3NvdXJjZXMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zb3VyY2VzLmh0bWwnXG4gICAgICAgIH0pLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG5cbiAgICAvLyRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xufV0pOyIsIi8qKlxuICogQURNSU5cbiAqL1xuYXBwLmNvbnRyb2xsZXIoJ2FkbWluQ3RybCcsIFsnJGh0dHAnLCAnJHNjb3BlJywnJHBhcnNlJywgZnVuY3Rpb24oICRodHRwLCAkc2NvcGUsICRwYXJzZSApe1xuICAgIC8vIElOSVRcbiAgICBpbml0KCk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5zdWdnZXN0aW9ucyA9ICcnO1xuICAgIHNlbGYubWFya0NvbXBsZXRlID0gbWFya0NvbXBsZXRlO1xuXG4gICAgZnVuY3Rpb24gbWFya0NvbXBsZXRlKCBzdWdnZXN0aW9uICkge1xuICAgICAgICB2YXIgaWQgPSBzdWdnZXN0aW9uLmlkO1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgICAgICRodHRwLnB1dCgnL3N1Z2dlc3Rpb24vY29tcGxldGUvJyArIGlkKS50aGVuKGZ1bmN0aW9uKCByZXMgKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRodHRwLmdldCgnL3N1Z2dlc3Rpb24nKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIHZhciBzdWdnZXN0aW9ucyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgc2VsZi5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAgICAgJHNjb3BlLmNzdiA9IHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IG51bGwsXG4gICAgICAgICAgICBoZWFkZXI6IHRydWUsXG4gICAgICAgICAgICBoZWFkZXJWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgc2VwYXJhdG9yOiAnLCcsXG4gICAgICAgICAgICBzZXBhcmF0b3JWaXNpYmxlOiB0cnVlLFxuICAgICAgICAgICAgcmVzdWx0OiBudWxsLFxuICAgICAgICAgICAgZW5jb2Rpbmc6ICdJU08tODg1OS0xJyxcbiAgICAgICAgICAgIGVuY29kaW5nVmlzaWJsZTogdHJ1ZVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBfbGFzdEdvb2RSZXN1bHQgPSAnJztcbiAgICAgICAgJHNjb3BlLnRvUHJldHR5SlNPTiA9IGZ1bmN0aW9uIChqc29uLCB0YWJXaWR0aCkge1xuICAgICAgICAgICAgdmFyIG9ialN0ciA9IEpTT04uc3RyaW5naWZ5KGpzb24pO1xuICAgICAgICAgICAgdmFyIG9iaiA9IG51bGw7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG9iaiA9ICRwYXJzZShvYmpTdHIpKHt9KTtcbiAgICAgICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAgICAgLy8gZWF0ICRwYXJzZSBlcnJvclxuICAgICAgICAgICAgICAgIHJldHVybiBfbGFzdEdvb2RSZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBKU09OLnN0cmluZ2lmeShvYmosIG51bGwsIE51bWJlcih0YWJXaWR0aCkpO1xuICAgICAgICAgICAgX2xhc3RHb29kUmVzdWx0ID0gcmVzdWx0O1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuXG59XSk7IiwiLyoqXG4gKiBBRE1JTlxuICovXG5hcHAuY29udHJvbGxlcignYWRtaW5DdHJsJywgWyckaHR0cCcsIGZ1bmN0aW9uKCAkaHR0cCApe1xuICAgIC8vIElOSVRcbiAgICBpbml0KCk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5zdWdnZXN0aW9ucyA9ICcnO1xuICAgIHNlbGYubWFya0NvbXBsZXRlID0gbWFya0NvbXBsZXRlO1xuXG4gICAgZnVuY3Rpb24gbWFya0NvbXBsZXRlKCBzdWdnZXN0aW9uICkge1xuICAgICAgICB2YXIgaWQgPSBzdWdnZXN0aW9uLmlkO1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgICAgICRodHRwLnB1dCgnL3N1Z2dlc3Rpb24vY29tcGxldGUvJyArIGlkKS50aGVuKGZ1bmN0aW9uKCByZXMgKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRodHRwLmdldCgnL3N1Z2dlc3Rpb24nKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIHZhciBzdWdnZXN0aW9ucyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgc2VsZi5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxufV0pOyIsImFwcC5jb250cm9sbGVyKCdjYWxjdWxhdGVDdHJsJywgWyckaHR0cCcsICckbWREaWFsb2cnLCAnJHJvb3RTY29wZScsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCBmdW5jdGlvbiggJGh0dHAsICRtZERpYWxvZywgJHJvb3RTY29wZSwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiApIHtcblxuICAgIC8vIENoZWNrIHVzZXJcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG5cbiAgICAvLyBJTklUXG4gICAgJGh0dHAuZ2V0KCcvbWF0ZXJpYWxzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICB2YXIgbGlzdCA9IHJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIC8vIC9pdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGl0ZW0ucHJpbWFyeV9jYXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5saXN0ID0gbGlzdDtcblxuICAgIH0pO1xuXG4gICAgLy8gU2VsZiBkZWNcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBzZWxmLmxpc3QgPSAnJztcbiAgICBzZWxmLmlzRGlzYWJsZWQgPSBmYWxzZTtcbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgICA9IHNlYXJjaFRleHRDaGFuZ2U7XG4gICAgc2VsZi5uZXdTdWdnZXN0aW9uID0gbmV3U3VnZ2VzdGlvbjtcbiAgICBzZWxmLnN1Ym1pdFN1Z2dlc3Rpb24gPSBzdWJtaXRTdWdnZXN0aW9uO1xuICAgIHNlbGYudW5pdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDA1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdraWxvcycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMTEwMjMxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ21ldHJpYyB0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDEuMTAyMzFcbiAgICAgICAgfVxuICAgIF07XG4gICAgc2VsZi5zdWJtaXNzaW9uID0ge1xuICAgICAgICBlbWFpbDogJycsXG4gICAgICAgIG1hdGVyaWFsOiAnJyxcbiAgICAgICAgbm90ZXM6ICcnXG4gICAgfTtcbiAgICBzZWxmLm5ld0NhbGN1bGF0aW9uID0gbmV3Q2FsY3VsYXRpb247XG5cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLnN1YmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLndhcm1JZCA9ICcnO1xuICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAnJztcbiAgICAgICAgICAgIHNlbGYuY29udmVyc2lvbiA9ICcnO1xuICAgICAgICAgICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld0NhbGN1bGF0aW9uKCkge1xuXG4gICAgICAgIHZhciBjYWxjdWxhdGUgPSB7XG4gICAgICAgICAgICB3YXJtSWQ6IHNlbGYud2FybUlkIHx8IHNlbGYuY2F0ZWdvcnkuc2Vjb25kYXJpZXNbMF0ud2FybV9pZCxcbiAgICAgICAgICAgIHdlaWdodDogcGFyc2VGbG9hdChzZWxmLndlaWdodCkgKiBzZWxmLmNvbnZlcnNpb25cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvY2FsY3VsYXRpb25zJywgY2FsY3VsYXRlKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9IE1hdGguZmxvb3IoTWF0aC5hYnMocmVzcG9uc2UuZGF0YSkgKiAxMDAwKSAvIDEwMDA7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhdmVUb1Byb2plY3QoKXtcbiAgICAgICAgdmFyIGxpbmVJdGVtID0ge1xuICAgICAgICAgICAgY2F0ZWdvcnk6IHNlbGYuY2F0ZWdvcnksXG4gICAgICAgICAgICBzdWJjYXRlZ29yeTogc2VsZi5zdWJjYXRlZ29yeSxcbiAgICAgICAgICAgIHdhcm1fSWQ6IHNlbGYud2FybUlkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSpzZWxmLmNvbnZlcnNpb24sXG4gICAgICAgICAgICB1bml0czogc2VsZi51bml0Lm5hbWVcbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5sb2cobGluZUl0ZW0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvYWRkVG9Qcm9qZWN0JykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBxdWVyeVNlYXJjaChxdWVyeSkge1xuICAgICAgICByZXR1cm4gcXVlcnkgPyBzZWxmLmxpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogc2VsZi5saXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvL3F1ZXJ5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcXVlcnkuc2xpY2UoMSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAob2JqLnByaW1hcnlfY2F0LmluZGV4T2YobG93ZXJjYXNlUXVlcnkpICE9IC0xKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWJtaXRTdWdnZXN0aW9uKCl7XG4gICAgICAgICRodHRwLnBvc3QoJy9zdWdnZXN0aW9uJywgc2VsZi5zdWJtaXNzaW9uKS50aGVuKGZ1bmN0aW9uKCByZXMgKXtcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld1N1Z2dlc3Rpb24oIHN1Z2dlc3Rpb24gKXtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpZGVuYXYnKS5mb2N1cygpO1xuXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3N1Ym1pdC1tb2RhbC5odG1sJyxcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICdjdHJsJyxcbiAgICAgICAgICAgIGxvY2Fsczoge21hdGVyaWFsOiBzZWxmLnNlYXJjaFRleHR9XG4gICAgICAgIH0pXG5cbiAgICB9XG5cblxufV0pOyIsIi8vIFJlZ2lzdGVyIEhUTUwgLSBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUFjY291bnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7IiwiLyohIGFuZ3VsYXItY3N2LWltcG9ydCAtIHYwLjAuMTggLSAyMDE1LTA5LTA0XG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUgOyBMaWNlbnNlZCAgKi9cbid1c2Ugc3RyaWN0JztcblxuYXBwLmRpcmVjdGl2ZSgnbmdDc3ZJbXBvcnQnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICBzY29wZTp7XG4gICAgICAgICAgICBjb250ZW50Oic9PycsXG4gICAgICAgICAgICBoZWFkZXI6ICc9PycsXG4gICAgICAgICAgICBoZWFkZXJWaXNpYmxlOiAnPT8nLFxuICAgICAgICAgICAgc2VwYXJhdG9yOiAnPT8nLFxuICAgICAgICAgICAgc2VwYXJhdG9yVmlzaWJsZTogJz0/JyxcbiAgICAgICAgICAgIHJlc3VsdDogJz0/JyxcbiAgICAgICAgICAgIGVuY29kaW5nOiAnPT8nLFxuICAgICAgICAgICAgZW5jb2RpbmdWaXNpYmxlOiAnPT8nXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlOiAnPGRpdj48ZGl2IG5nLXNob3c9XCJoZWFkZXJWaXNpYmxlXCI+PGRpdiBjbGFzcz1cImxhYmVsXCI+SGVhZGVyPC9kaXY+PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIG5nLW1vZGVsPVwiaGVhZGVyXCI+PC9kaXY+JytcbiAgICAgICAgJzxkaXYgbmctc2hvdz1cImVuY29kaW5nICYmIGVuY29kaW5nVmlzaWJsZVwiPjxkaXYgY2xhc3M9XCJsYWJlbFwiPkVuY29kaW5nPC9kaXY+PHNwYW4+e3tlbmNvZGluZ319PC9zcGFuPjwvZGl2PicrXG4gICAgICAgICc8ZGl2IG5nLXNob3c9XCJzZXBhcmF0b3IgJiYgc2VwYXJhdG9yVmlzaWJsZVwiPjxkaXYgY2xhc3M9XCJsYWJlbFwiPlNlcGVyYXRvcjwvZGl2PjxzcGFuPjxpbnB1dCBjbGFzcz1cInNlcGFyYXRvci1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgbmctY2hhbmdlPVwiY2hhbmdlU2VwYXJhdG9yXCIgbmctbW9kZWw9XCJzZXBhcmF0b3JcIj48c3Bhbj48L2Rpdj4nK1xuICAgICAgICAnPGRpdj48aW5wdXQgY2xhc3M9XCJidG4gY3RhIGdyYXlcIiB0eXBlPVwiZmlsZVwiLz48L2Rpdj48L2Rpdj4nLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCkge1xuICAgICAgICAgICAgc2NvcGUuc2VwYXJhdG9yVmlzaWJsZSA9IHNjb3BlLnNlcGFyYXRvclZpc2libGUgfHwgZmFsc2U7XG4gICAgICAgICAgICBzY29wZS5oZWFkZXJWaXNpYmxlID0gc2NvcGUuaGVhZGVyVmlzaWJsZSB8fCBmYWxzZTtcblxuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLnNlcGFyYXRvci1pbnB1dCcpKS5vbigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBzY29wZS5jb250ZW50ICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3N2OiBzY29wZS5jb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXBhcmF0b3I6IGUudGFyZ2V0LnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2Rpbmc6IHNjb3BlLmVuY29kaW5nXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VsdCA9IGNzdlRvSlNPTihjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVsZW1lbnQub24oJ2NoYW5nZScsIGZ1bmN0aW9uKG9uQ2hhbmdlRXZlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICBzY29wZS5maWxlbmFtZSA9IG9uQ2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKG9uTG9hZEV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzdjogb25Mb2FkRXZlbnQudGFyZ2V0LnJlc3VsdC5yZXBsYWNlKC9cXHJcXG58XFxyL2csJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogc2NvcGUuaGVhZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcGFyYXRvcjogc2NvcGUuc2VwYXJhdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY29udGVudCA9IGNvbnRlbnQuY3N2O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0ID0gY3N2VG9KU09OKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0LmZpbGVuYW1lID0gc2NvcGUuZmlsZW5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAoIChvbkNoYW5nZUV2ZW50LnRhcmdldC50eXBlID09PSBcImZpbGVcIikgJiYgKG9uQ2hhbmdlRXZlbnQudGFyZ2V0LmZpbGVzICE9IG51bGwgfHwgb25DaGFuZ2VFdmVudC5zcmNFbGVtZW50LmZpbGVzICE9IG51bGwpICkgIHtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoKG9uQ2hhbmdlRXZlbnQuc3JjRWxlbWVudCB8fCBvbkNoYW5nZUV2ZW50LnRhcmdldCkuZmlsZXNbMF0sIHNjb3BlLmVuY29kaW5nKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIHNjb3BlLmNvbnRlbnQgIT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzdjogc2NvcGUuY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICFzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwYXJhdG9yOiBzY29wZS5zZXBhcmF0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQgPSBjc3ZUb0pTT04oY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdmFyIGNzdlRvSlNPTiA9IGZ1bmN0aW9uKGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGluZXM9Y29udGVudC5jc3Yuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBjb2x1bW5Db3VudCA9IGxpbmVzWzBdLnNwbGl0KGNvbnRlbnQuc2VwYXJhdG9yKS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgICAgICAgICAgICAgIGlmIChjb250ZW50LmhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPWxpbmVzWzBdLnNwbGl0KGNvbnRlbnQuc2VwYXJhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9c3RhcnQ7IGk8bGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudGxpbmU9bGluZXNbaV0uc3BsaXQobmV3IFJlZ0V4cChjb250ZW50LnNlcGFyYXRvcisnKD8hW15cIl0qXCIoPzooPzpbXlwiXSpcIil7Mn0pKlteXCJdKiQpJykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnRsaW5lLmxlbmd0aCA9PT0gY29sdW1uQ291bnQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudC5oZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqPTA7IGo8aGVhZGVycy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpbaGVhZGVyc1tqXV0gPSBjdXJyZW50bGluZVtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGs9MDsgazxjdXJyZW50bGluZS5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpba10gPSBjdXJyZW50bGluZVtrXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChvYmopO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcbn0pOyIsImFwcC5jb250cm9sbGVyKCdkYXNoYm9hcmRDdHJsJywgWyckbWREaWFsb2cnLCAnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJG1kRGlhbG9nLCAkc2NvcGUsICRodHRwKSB7XG4gICAgLy9sb2FkIHByb2plY3QgbGlzdCBvbiBwYWdlIGxvYWRcbiAgICAkaHR0cC5nZXQoJy9wcm9qZWN0JykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICRzY29wZS5wcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vcmVzcG9uc2UuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAvLyAgICBpdGVtLnByb2plY3RfbmFtZSA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcbi8vdGhpcyBpcyBmb3IgdGhlIGRlbGV0ZSBtb2RhbCBhbGVydCBmb3IgZGVsZXRpbmcgYSBwcm9qZWN0LS0gc3RpbGwgbm90IHdvcmtpbmcgY29ycmVjdFxuXG4gICAgJHNjb3BlLnNob3dEZWxldGUgPSBmdW5jdGlvbihldikge1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCdDTElDSycpO1xuICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgICAgIC50aXRsZSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB5b3VyIHByb2plY3Q/JylcbiAgICAgICAgICAgIC5jb250ZW50KCdUaGlzIGlzIHBlcm1hbmVudC4nKVxuICAgICAgICAgICAgLmFyaWFMYWJlbCgnRGVsZXRlIHByb2plY3QgcGVybWFuZW50bHknKVxuICAgICAgICAgICAgLm9rKCdEZWxldGUnKVxuICAgICAgICAgICAgLmNhbmNlbCgnQ2FuY2VsJylcbiAgICAgICAgICAgIC50YXJnZXRFdmVudChldik7XG4gICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBwcm9qZWN0IGhhcyBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBwcm9qZWN0IGhhcyBub3QgYmVlbiBkZWxldGVkLic7XG4gICAgICAgIH0pO1xuICAgIH07XG4vLyAgICBmdW5jdGlvbiBEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4vLyAgICAkc2NvcGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuYW5zd2VyID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbi8vICAgIH07XG4vL31cblxufV0pOyIsIi8vIExvZ2luIEhUTUwgLSBLYXRlXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUuZm9ybVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhLnRva2VuKTtcbiAgICAgICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgIH0pXG4gICAgfVxufV0pOyIsIi8vIENoYW5nZSBOYXZpZ2F0aW9uIE9wdGlvbnMgd2l0aCBMb2dpblxuYXBwLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBbJ2F1dGhTZXJ2aWNlJywgJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICckaHR0cCcsIGZ1bmN0aW9uKGF1dGhTZXJ2aWNlLCAkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJGh0dHApe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cbn1dKTtcbiIsIi8vIFByb2plY3QgUGFnZSAtICBLaW0vTWFkZWxlaW5lXG5hcHAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckbWREaWFsb2cnLCAnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkbWREaWFsb2csICRzY29wZSwgJHJvb3RTY29wZSwgJGh0dHApIHtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYucHJvamVjdExpc3QgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZDogMjEsXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RfbmFtZTogXCJCZW4ncyBIb3VzZVwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlJlbW9kZWxcIixcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogXCIyMDE1LTEwLTE0VDE2OjQyOjQwLjg5NlpcIixcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogXCIyMDE1LTEwLTE0VDE2OjQyOjQwLjkwMVpcIixcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogNCxcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IFwid29vZFwiLFxuICAgICAgICAgICAgICAgICAgICBzdWJfY2F0ZWdvcnk6IFwib2FrXCIsXG4gICAgICAgICAgICAgICAgICAgIHVuaXRzOiBcImxic1wiLFxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IDEwLFxuICAgICAgICAgICAgICAgICAgICBjbzJfb2Zmc2V0OiAwLjAzLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgICAgICAgICAgICAgICAgICBpdGVtX2Rlc2NyaXB0aW9uOiBcInBvcmNoIHNwaW5kbGVzXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IDIwMixcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdF9uYW1lOiBcIkphbWVzJyBIb3VzZVwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlRlYXJkb3duXCIsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IFwiMjAxNC0xMC0xNFQxNjo0Mjo0MC44OTZaXCIsXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IFwiMjAxNC0xMC0xNFQxNjo0Mjo0MC45MDFaXCIsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IDI0LFxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogXCJhc3BoYWx0IHNoaW5nbGVzXCIsXG4gICAgICAgICAgICAgICAgICAgIHN1Yl9jYXRlZ29yeTogXCJudWxsXCIsXG4gICAgICAgICAgICAgICAgICAgIHVuaXRzOiBcImxic1wiLFxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgY28yX29mZnNldDogMC4zMDMsXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RfaWQ6IDYsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1fZGVzY3JpcHRpb246IFwicm9vZiBzaGluZ2xlc1wiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAyMTEyLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X25hbWU6IFwiS2ltJ3MgQmFyblwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlJlbW9kZWxcIixcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogXCIyMDEzLTEwLTE0VDE2OjQyOjQwLjg5NlpcIixcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogXCIyMDEzLTEwLTE0VDE2OjQyOjQwLjkwMVpcIixcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogMTQsXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBcIndvb2QgZmxvb3JpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgc3ViX2NhdGVnb3J5OiBcInBpbmVcIixcbiAgICAgICAgICAgICAgICAgICAgdW5pdHM6IFwibGJzXCIsXG4gICAgICAgICAgICAgICAgICAgIHdlaWdodDogNTAwLFxuICAgICAgICAgICAgICAgICAgICBjbzJfb2Zmc2V0OiAzLjAzLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgICAgICAgICAgICAgICAgICBpdGVtX2Rlc2NyaXB0aW9uOiBcImJhcm4gd29vZFwiXG4gICAgICAgICAgICAgICAgfV07XG4gICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICBzZWxmLnF1ZXJ5U2VhcmNoID0gcXVlcnlTZWFyY2g7XG4gICAgc2VsZi5zZWxlY3RlZEl0ZW1DaGFuZ2UgPSBzZWxlY3RlZEl0ZW1DaGFuZ2U7XG4gICAgc2VsZi5zZWFyY2hUZXh0Q2hhbmdlID0gc2VhcmNoVGV4dENoYW5nZTtcbiAgICBzZWxmLnByb2plY3RUb3RhbCA9IDA7XG4gICAgc2VsZi5kZWxldGVQcm9qZWN0SXRlbSA9IGRlbGV0ZVByb2plY3RJdGVtO1xuICAgIHNlbGYuaWQgPSAwO1xuY29uc29sZS5sb2coc2VsZi5wcm9qZWN0TGlzdCk7XG5cbiAgICAvL3JlZnJlc2ggcHJvamVjdCBsaXN0XG4gICAgLy9mdW5jdGlvbiBnZXRQcm9qZWN0TGlzdCgpIHtcbiAgICAvLyAgICAkaHR0cC5nZXQoJy9wcm9qZWN0JywgJHJvb3RTY29wZS51c2VyLmlkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIC8vICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgLy8gICAgICAgIGNvbnNvbGUubG9nKFwidXNlciBpZDogXCIsICRyb290U2NvcGUudXNlci5pZCk7XG4gICAgLy8gICAgICAgIHZhciBwcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgLy8gICAgICAgIHByb2plY3RMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAvLyAgICAgICAgICAgIGl0ZW0ucHJvamVjdF9uYW1lID0gaXRlbS5wcm9qZWN0X25hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAvLyAgICAgICAgICAgIC8vaXRlbS5wcm9qZWN0X2Rlc2NyaXB0aW9uID0gaXRlbS5wcm9qZWN0X2Rlc2NyaXB0aW9uO1xuICAgIC8vICAgICAgICAgICAgLy9pdGVtLml0ZW1JZCA9IGl0ZW0uaWQ7XG4gICAgLy8gICAgICAgICAgICAvL2l0ZW0uY28yX29mZnNldCA9IGl0ZW0uY28yX29mZnNldDtcbiAgICAvLyAgICAgICAgfSk7XG4gICAgLy8gICAgICAgIHNlbGYucHJvamVjdExpc3QgPSBwcm9qZWN0TGlzdDtcbiAgICAvLyAgICB9KTtcbiAgICAvL31cblxuICAgIC8vbG9hZCBwcm9qZWN0IGxpc3Qgb24gcGFnZSBsb2FkXG4gICAgLy9nZXRQcm9qZWN0TGlzdCgpO1xuXG4gICAgLy9mdW5jdGlvbiBnZXRQcm9qZWN0TGlzdCgpe1xuICAgIC8vICAgIGNvbnNvbGUubG9nKFwiUHJvamVjdCBsaXN0IGxvYWRlZDogXCIsIHNlbGYucHJvamVjdExpc3QpO1xuICAgIC8vICAgIHByb2plY3RMaXN0ID0gW1xuICAgIC8vICAgICAgICB7XG4gICAgLy8gICAgICAgICAgICBpZDogMjEsXG4gICAgLy8gICAgICAgICAgICBwcm9qZWN0X25hbWU6IFwiQmVuJ3MgSG91c2VcIixcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfZGVzY3JpcHRpb246IFwiUmVtb2RlbFwiLFxuICAgIC8vICAgICAgICAgICAgY3JlYXRlZF9hdDogXCIyMDE1LTEwLTE0VDE2OjQyOjQwLjg5NlpcIixcbiAgICAvLyAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IFwiMjAxNS0xMC0xNFQxNjo0Mjo0MC45MDFaXCIsXG4gICAgLy8gICAgICAgICAgICB1c2VyX2lkOiA0LFxuICAgIC8vICAgICAgICAgICAgY2F0ZWdvcnk6IFwid29vZFwiLFxuICAgIC8vICAgICAgICAgICAgc3ViX2NhdGVnb3J5OiBcIm9ha1wiLFxuICAgIC8vICAgICAgICAgICAgdW5pdHM6IFwibGJzXCIsXG4gICAgLy8gICAgICAgICAgICB3ZWlnaHQ6IDEwLFxuICAgIC8vICAgICAgICAgICAgY28yX29mZnNldDogMC4wMyxcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfaWQ6IDYsXG4gICAgLy8gICAgICAgICAgICBpdGVtX2Rlc2NyaXB0aW9uOiBcInBvcmNoIHNwaW5kbGVzXCJcbiAgICAvLyAgICAgICAgfSxcbiAgICAvLyAgICAgICAge1xuICAgIC8vICAgICAgICAgICAgaWQ6IDIwMixcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfbmFtZTogXCJKYW1lcycgSG91c2VcIixcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfZGVzY3JpcHRpb246IFwiVGVhcmRvd25cIixcbiAgICAvLyAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IFwiMjAxNC0xMC0xNFQxNjo0Mjo0MC44OTZaXCIsXG4gICAgLy8gICAgICAgICAgICB1cGRhdGVkX2F0OiBcIjIwMTQtMTAtMTRUMTY6NDI6NDAuOTAxWlwiLFxuICAgIC8vICAgICAgICAgICAgdXNlcl9pZDogMjQsXG4gICAgLy8gICAgICAgICAgICBjYXRlZ29yeTogXCJhc3BoYWx0IHNoaW5nbGVzXCIsXG4gICAgLy8gICAgICAgICAgICBzdWJfY2F0ZWdvcnk6IFwibnVsbFwiLFxuICAgIC8vICAgICAgICAgICAgdW5pdHM6IFwibGJzXCIsXG4gICAgLy8gICAgICAgICAgICB3ZWlnaHQ6IDEwMCxcbiAgICAvLyAgICAgICAgICAgIGNvMl9vZmZzZXQ6IDAuMzAzLFxuICAgIC8vICAgICAgICAgICAgcHJvamVjdF9pZDogNixcbiAgICAvLyAgICAgICAgICAgIGl0ZW1fZGVzY3JpcHRpb246IFwicm9vZiBzaGluZ2xlc1wiXG4gICAgLy8gICAgICAgIH0sXG4gICAgLy8gICAgICAgIHtcbiAgICAvLyAgICAgICAgICAgIGlkOiAyMTEyLFxuICAgIC8vICAgICAgICAgICAgcHJvamVjdF9uYW1lOiBcIktpbSdzIEJhcm5cIixcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfZGVzY3JpcHRpb246IFwiUmVtb2RlbFwiLFxuICAgIC8vICAgICAgICAgICAgY3JlYXRlZF9hdDogXCIyMDEzLTEwLTE0VDE2OjQyOjQwLjg5NlpcIixcbiAgICAvLyAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IFwiMjAxMy0xMC0xNFQxNjo0Mjo0MC45MDFaXCIsXG4gICAgLy8gICAgICAgICAgICB1c2VyX2lkOiAxNCxcbiAgICAvLyAgICAgICAgICAgIGNhdGVnb3J5OiBcIndvb2QgZmxvb3JpbmdcIixcbiAgICAvLyAgICAgICAgICAgIHN1Yl9jYXRlZ29yeTogXCJwaW5lXCIsXG4gICAgLy8gICAgICAgICAgICB1bml0czogXCJsYnNcIixcbiAgICAvLyAgICAgICAgICAgIHdlaWdodDogNTAwLFxuICAgIC8vICAgICAgICAgICAgY28yX29mZnNldDogMy4wMyxcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfaWQ6IDYsXG4gICAgLy8gICAgICAgICAgICBpdGVtX2Rlc2NyaXB0aW9uOiBcImJhcm4gd29vZFwiXG4gICAgLy8gICAgICAgIH1cbiAgICAvLyAgICBdO1xuICAgIC8vfVxuXG5cblxuXG4gICAgZnVuY3Rpb24gcXVlcnlTZWFyY2gocXVlcnkpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJUaGlzIGlzIHRoZSBwcm9qZWN0IGxpc3Q6XCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhzZWxmLnByb2plY3RMaXN0KTtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5ID8gc2VsZi5wcm9qZWN0TGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiBzZWxmLnByb2plY3RMaXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvL3F1ZXJ5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcXVlcnkuc2xpY2UoMSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAob2JqLnByb2plY3RfbmFtZS5pbmRleE9mKGxvd2VyY2FzZVF1ZXJ5KSAhPSAtMSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VhcmNoVGV4dENoYW5nZSh0ZXh0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IGNoYW5nZWQgdG8gJywgdGV4dCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlKGl0ZW0pIHtcbiAgICAgICAgaWYgKCBpdGVtID09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHNlbGYucHJvamVjdF9uYW1lID0gJyc7XG4gICAgICAgICAgICBzZWxmLnByb2plY3RfZGVzY3JpcHRpb24gPSAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5zaG93RGVsZXRlID0gZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0NMSUNLJyk7XG4gICAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxuICAgICAgICAgICAgLnRpdGxlKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgaXRlbT8nKVxuICAgICAgICAgICAgLmNvbnRlbnQoJ1RoaXMgd2lsbCBiZSBwZXJtYW5lbnQuJylcbiAgICAgICAgICAgIC5hcmlhTGFiZWwoJ0RlbGV0ZSBpdGVtIHBlcm1hbmVudGx5JylcbiAgICAgICAgICAgIC5vaygnRGVsZXRlJylcbiAgICAgICAgICAgIC5jYW5jZWwoJ0NhbmNlbCcpXG4gICAgICAgICAgICAudGFyZ2V0RXZlbnQoZXYpO1xuICAgICAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLmFsZXJ0ID0gJ1lvdXIgaXRlbSBoYXMgYmVlbiBkZWxldGVkLic7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLmFsZXJ0ID0gJ1lvdXIgaXRlbSBoYXMgbm90IGJlZW4gZGVsZXRlZC4nO1xuICAgICAgICB9KTtcbiAgICB9O1xuLy8gICAgZnVuY3Rpb24gRGlhbG9nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZykge1xuLy8gICAgJHNjb3BlLmhpZGUgPSBmdW5jdGlvbigpIHtcbi8vICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcbi8vICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmFuc3dlciA9IGZ1bmN0aW9uKGFuc3dlcikge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKGFuc3dlcik7XG4vLyAgICB9O1xuLy99XG5cbiAgICBmdW5jdGlvbiBkZWxldGVQcm9qZWN0SXRlbSgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEZWxldGluZy4uLlwiLCBzZWxmLnByb2plY3RfaWQpO1xuICAgICAgICAvLyRodHRwLnVwZGF0ZSgnL3Byb2plY3QnLCBzZWxmLnByb2plY3RfaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIC8vZmluZE9uZSBhbmQgZGVsZXRlIGJ5IGlkIHVzaW5nIHByb2plY3RsaXN0LmlkXG4gICAgICAgIC8vICAgIGNvbnNvbGUubG9nKFwiSXRlbSB3YXMgZGVsZXRlZC5cIiwgcmVzcG9uc2UpO1xuICAgICAgICAvLyAgICBzZWxmLmdldFByb2plY3RMaXN0KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlUHJvamVjdFRvdGFsKCkge1xuICAgICAgICBwcm9qZWN0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBwcm9qZWN0VG90YWwgKz0gaXRlbS5jbzJfb2Zmc2V0O1xuICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdFRvdGFsKTtcbiAgICAgICAgcmV0dXJuIHByb2plY3RUb3RhbDtcblxuICAgIH0pXG4gICAgfVxuXG5cblxufV0pOyIsIi8vIFNlcnZpY2VzIGZvciBhdXRoZW50aWNhdGlvblxuYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpe1xuICAgIHRoaXMucGFyc2VKd3QgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgICAgIH0gZWxzZSByZXR1cm4ge307XG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuID0gdG9rZW47XG4gICAgICAgIGNvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pO1xuXG5hcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
