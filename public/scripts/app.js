var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,n,r){n.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl as ctrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("adminCtrl",["$http","$scope","$parse",function(e,t,n){function r(t){var n=t.id;console.log(n),e.put("/suggestion/complete/"+n).then(function(e){o()})}function o(){e.get("/suggestion").then(function(e){var t=e.data;console.log(t),a.suggestions=t})}o();var a=this;a.suggestions="",a.markComplete=r,t.csv={content:null,header:!0,headerVisible:!0,separator:",",separatorVisible:!0,result:null,encoding:"ISO-8859-1",encodingVisible:!0};var l="";t.toPrettyJSON=function(e,t){var r=JSON.stringify(e),o=null;try{o=n(r)({})}catch(a){return l}var i=JSON.stringify(o,null,Number(t));return l=i,i}}]),app.controller("calculateCtrl",["$http","$mdDialog","$rootScope","authService","$location",function(e,t,n,r,o){function a(e){console.log("Text changed to ",e)}function l(e){void 0==e&&(h.category="",h.subcategory="",h.warmId="",h.weight="",h.conversion="",h.result="")}function i(){var t={warmId:h.warmId||h.category.secondaries[0].warm_id,weight:parseFloat(h.weight)*h.conversion};e.post("/calculations",t).then(function(e){h.result=Math.floor(1e3*Math.abs(e.data))/1e3})}function s(e){return e?h.list.filter(c(e)):h.list}function c(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function u(){e.post("/suggestion",h.submission).then(function(e){t.hide()})}function p(e){document.getElementById("sidenav").focus(),t.show({templateUrl:"/views/submit-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:h.searchText}})}n.user=r.getUser(),n.user&&n.user.username&&o.path("/"),e.get("/materials").then(function(e){var t=e.data;t.forEach(function(e){e.primary_cat=e.primary_cat.toLowerCase()}),h.list=t});var h=this;h.list="",h.isDisabled=!1,h.result="",h.querySearch=s,h.selectedItemChange=l,h.searchTextChange=a,h.newSuggestion=p,h.submitSuggestion=u,h.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],h.submission={email:"",material:"",notes:""},h.newCalculation=i}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(e,t,n){e.user={},e.processForm=function(r){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),n.path("/login"),alert("Your account has been created.")})}}]),app.directive("ngCsvImport",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{content:"=?",header:"=?",headerVisible:"=?",separator:"=?",separatorVisible:"=?",result:"=?",encoding:"=?",encodingVisible:"=?"},template:'<div><div ng-show="headerVisible"><div class="label">Header</div><input type="checkbox" ng-model="header"></div><div ng-show="encoding && encodingVisible"><div class="label">Encoding</div><span>{{encoding}}</span></div><div ng-show="separator && separatorVisible"><div class="label">Seperator</div><span><input class="separator-input" type="text" ng-change="changeSeparator" ng-model="separator"><span></div><div><input class="btn cta gray" type="file"/></div></div>',link:function(e,t){e.separatorVisible=e.separatorVisible||!1,e.headerVisible=e.headerVisible||!1,angular.element(t[0].querySelector(".separator-input")).on("keyup",function(t){if(null!=e.content){var r={csv:e.content,header:e.header,separator:t.target.value,encoding:e.encoding};e.result=n(r),e.$apply()}}),t.on("change",function(t){var r=new FileReader;if(e.filename=t.target.files[0].name,r.onload=function(t){e.$apply(function(){var r={csv:t.target.result.replace(/\r\n|\r/g,"\n"),header:e.header,separator:e.separator};e.content=r.csv,e.result=n(r),e.result.filename=e.filename})},"file"!==t.target.type||null==t.target.files&&null==t.srcElement.files){if(null!=e.content){var o={csv:e.content,header:!e.header,separator:e.separator};e.result=n(o)}}else r.readAsText((t.srcElement||t.target).files[0],e.encoding)});var n=function(e){var t=e.csv.split("\n"),n=[],r=0,o=t[0].split(e.separator).length,a=[];e.header&&(a=t[0].split(e.separator),r=1);for(var l=r;l<t.length;l++){var i={},s=t[l].split(new RegExp(e.separator+'(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)'));if(s.length===o){if(e.header)for(var c=0;c<a.length;c++)i[a[c]]=s[c];else for(var u=0;u<s.length;u++)i[u]=s[u];n.push(i)}}return n}}}}),app.controller("dashboardCtrl",["$mdDialog","$scope","$http",function(e,t,n){n.get("/project").then(function(e){console.log(e),t.projectList=e.data}),t.showDelete=function(n){console.log("CLICK");var r=e.confirm().title("Are you sure you want to delete your project?").content("This is permanent.").ariaLabel("Delete project permanently").ok("Delete").cancel("Cancel").targetEvent(n);e.show(r).then(function(){t.alert="Your project has been deleted."},function(){t.alert="Your project has not been deleted."})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(e,t,n,r,o){e.login=function(){t({method:"POST",url:"/login",data:e.form}).then(function(e){n.saveToken(e.data.token),o.user=n.getUser(),r.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,n,r,o){n.user=e.getUser(),n.user&&n.user.username&&r.path("/"),t.logout=function(){e.logout(),n.user=e.getUser(),r.path("/")}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){function n(e){return e?i.projectList.filter(r(e)):i.projectList}function r(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function o(e){console.log("Text changed to ",e)}function a(e){void 0==e&&(i.project_name="",i.project_description="")}function l(){console.log("Deleting...",i.projectList.ID)}var i=this;i.projectList="",i.result="",i.querySearch=n,i.selectedItemChange=a,i.searchTextChange=o,i.projectTotal=0,i.deleteProjectItem=l,i.id=0,i.getProjectList=function(){t.get("/project",userid).then(function(e){console.log(e);var t=e.data;t.forEach(function(e){e.project_name=e.project_name.toLowerCase()}),i.projectList=t})},e.showDelete=function(t){console.log("CLICK");var n=$mdDialog.confirm().title("Are you sure you want to delete this item?").content("This will be permanent.").ariaLabel("Delete item permanently").ok("Delete").cancel("Cancel").targetEvent(t);$mdDialog.show(n).then(function(){e.alert="Your item has been deleted."},function(){e.alert="Your item has not been deleted."})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var n=t.split(".")[1],r=n.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),n=Math.round((new Date).getTime()/1e3)<=t.exp;return n||this.logout(),n}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},n.isAuthed()&&(e.headers.Authorization="Bearer "+n.getToken()),e},response:function(n){return 401===n.status&&t.path("/login"),n||e.when(n)},responseError:function(n){return 401===n.status?t.path("/login"):console.log(n),e.reject(n)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzY3JpcHRzL2FkbWluQ3RybC5qcyIsInNjcmlwdHMvY2FsY3VsYXRlQ3RybC5qcyIsInNjcmlwdHMvY3JlYXRlQWNjb3VudEN0cmwuanMiLCJzY3JpcHRzL2NzdkltcG9ydC5qcyIsInNjcmlwdHMvZGFzaGJvYXJkQ3RybC5qcyIsInNjcmlwdHMvbG9naW5DdHJsLmpzIiwic2NyaXB0cy9uYXZDdHJsLmpzIiwic2NyaXB0cy9wcm9qZWN0c0N0cmwuanMiLCJzY3JpcHRzL3NlcnZpY2VzLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkaHR0cCIsIiRzY29wZSIsIiRwYXJzZSIsIm1hcmtDb21wbGV0ZSIsInN1Z2dlc3Rpb24iLCJpZCIsImNvbnNvbGUiLCJsb2ciLCJwdXQiLCJ0aGVuIiwicmVzIiwiaW5pdCIsImdldCIsInN1Z2dlc3Rpb25zIiwiZGF0YSIsInNlbGYiLCJ0aGlzIiwiY3N2IiwiY29udGVudCIsImhlYWRlciIsImhlYWRlclZpc2libGUiLCJzZXBhcmF0b3IiLCJzZXBhcmF0b3JWaXNpYmxlIiwicmVzdWx0IiwiZW5jb2RpbmciLCJlbmNvZGluZ1Zpc2libGUiLCJfbGFzdEdvb2RSZXN1bHQiLCJ0b1ByZXR0eUpTT04iLCJqc29uIiwidGFiV2lkdGgiLCJvYmpTdHIiLCJKU09OIiwic3RyaW5naWZ5Iiwib2JqIiwiZSIsIk51bWJlciIsIiRtZERpYWxvZyIsIiRyb290U2NvcGUiLCJhdXRoU2VydmljZSIsIiRsb2NhdGlvbiIsInNlYXJjaFRleHRDaGFuZ2UiLCJ0ZXh0Iiwic2VsZWN0ZWRJdGVtQ2hhbmdlIiwiaXRlbSIsInVuZGVmaW5lZCIsImNhdGVnb3J5Iiwic3ViY2F0ZWdvcnkiLCJ3YXJtSWQiLCJ3ZWlnaHQiLCJjb252ZXJzaW9uIiwibmV3Q2FsY3VsYXRpb24iLCJjYWxjdWxhdGUiLCJzZWNvbmRhcmllcyIsIndhcm1faWQiLCJwYXJzZUZsb2F0IiwicG9zdCIsInJlc3BvbnNlIiwiTWF0aCIsImZsb29yIiwiYWJzIiwicXVlcnlTZWFyY2giLCJxdWVyeSIsImxpc3QiLCJmaWx0ZXIiLCJjcmVhdGVGaWx0ZXJGb3IiLCJsb3dlcmNhc2VRdWVyeSIsInRvTG93ZXJDYXNlIiwicHJpbWFyeV9jYXQiLCJpbmRleE9mIiwic3VibWl0U3VnZ2VzdGlvbiIsInN1Ym1pc3Npb24iLCJoaWRlIiwibmV3U3VnZ2VzdGlvbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb2N1cyIsInNob3ciLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiY29udHJvbGxlckFzIiwibG9jYWxzIiwibWF0ZXJpYWwiLCJzZWFyY2hUZXh0IiwidXNlciIsImdldFVzZXIiLCJ1c2VybmFtZSIsInBhdGgiLCJmb3JFYWNoIiwiaXNEaXNhYmxlZCIsInVuaXRzIiwibmFtZSIsImVtYWlsIiwibm90ZXMiLCJwcm9jZXNzRm9ybSIsIm1ldGhvZCIsInVybCIsImRhdGFUeXBlIiwiYWxlcnQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInRyYW5zY2x1ZGUiLCJyZXBsYWNlIiwic2NvcGUiLCJ0ZW1wbGF0ZSIsImxpbmsiLCJlbGVtZW50IiwicXVlcnlTZWxlY3RvciIsIm9uIiwidGFyZ2V0IiwidmFsdWUiLCJjc3ZUb0pTT04iLCIkYXBwbHkiLCJvbkNoYW5nZUV2ZW50IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsImZpbGVuYW1lIiwiZmlsZXMiLCJvbmxvYWQiLCJvbkxvYWRFdmVudCIsInR5cGUiLCJzcmNFbGVtZW50IiwicmVhZEFzVGV4dCIsImxpbmVzIiwic3BsaXQiLCJzdGFydCIsImNvbHVtbkNvdW50IiwibGVuZ3RoIiwiaGVhZGVycyIsImkiLCJjdXJyZW50bGluZSIsIlJlZ0V4cCIsImoiLCJrIiwicHVzaCIsInByb2plY3RMaXN0Iiwic2hvd0RlbGV0ZSIsImV2IiwiY29uZmlybSIsInRpdGxlIiwiYXJpYUxhYmVsIiwib2siLCJjYW5jZWwiLCJ0YXJnZXRFdmVudCIsImxvZ2luIiwiZm9ybSIsInNhdmVUb2tlbiIsInRva2VuIiwibG9nb3V0IiwicHJvamVjdF9uYW1lIiwicHJvamVjdF9kZXNjcmlwdGlvbiIsImRlbGV0ZVByb2plY3RJdGVtIiwiSUQiLCJwcm9qZWN0VG90YWwiLCJnZXRQcm9qZWN0TGlzdCIsInVzZXJpZCIsInNlcnZpY2UiLCIkd2luZG93IiwicGFyc2VKd3QiLCJiYXNlNjRVcmwiLCJiYXNlNjQiLCJwYXJzZSIsImF0b2IiLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImZhY3RvcnkiLCIkcSIsInJlcXVlc3QiLCJBdXRob3JpemF0aW9uIiwic3RhdHVzIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxjQUFBLFVBQUEsYUFBQSxhQUFBLG9CQUVBRixLQUFBRyxRQUFBLHFCQUFBLGlCQUFBLG9CQUFBLGdCQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FELEVBQUFFLFdBQUEsR0FHQUosRUFBQUssTUFBQSxXQUNBQyxlQUFBLFNBQ0FDLGNBQUEsYUFBQUMsVUFBQSxRQUNBQyxZQUFBLFVBR0FSLEVBQUFTLEtBQUEsS0FFQUMsWUFBQSx5QkFDQUMsV0FBQSwwQkFDQUYsS0FBQSxVQUVBQyxZQUFBLG9CQUNBQyxXQUFBLGNBQ0FGLEtBQUEsYUFFQUMsWUFBQSx1QkFDQUMsV0FB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QW1KLFNBQUEsV0FDQSxNQUFBUixHQUFBTSxhQUFBQyxVQUdBbEosS0FBQW9KLFNBQUEsV0FDQSxHQUFBbkIsR0FBQWpJLEtBQUFtSixVQUNBLElBQUFsQixFQUFBLENBQ0EsR0FBQW9CLEdBQUFySixLQUFBNEksU0FBQVgsR0FDQXFCLEVBQUE3RyxLQUFBOEcsT0FBQSxHQUFBQyxPQUFBQyxVQUFBLE1BQUFKLEVBQUFLLEdBSUEsT0FIQUosSUFDQXRKLEtBQUFrSSxTQUVBb0IsRUFFQSxPQUFBLEdBSUF0SixLQUFBa0ksT0FBQSxpQkFDQVMsR0FBQU0sYUFBQUMsVUFJQWxKLEtBQUFtRSxRQUFBLFdBQ0EsTUFBQW5FLE1BQUE0SSxTQUFBNUksS0FBQW1KLGdCQUlBdEwsSUFBQThMLFFBQUEsbUJBQUEsS0FBQSxZQUFBLGNBQUEsU0FBQUMsRUFBQXJJLEVBQUFELEdBQ0EsT0FDQXVJLFFBQUEsU0FBQTdMLEdBS0EsTUFKQUEsR0FBQThJLFFBQUE5SSxFQUFBOEksWUFDQXhGLEVBQUE4SCxhQUNBcEwsRUFBQThJLFFBQUFnRCxjQUFBLFVBQUF4SSxFQUFBNkgsWUFFQW5MLEdBRUF3RSxTQUFBLFNBQUFBLEdBT0EsTUFMQSxPQUFBQSxFQUFBdUgsUUFHQXhJLEVBQUE4QyxLQUFBLFVBRUE3QixHQUFBb0gsRUFBQWpMLEtBQUE2RCxJQUNBd0gsY0FBQSxTQUFBeEgsR0FPQSxNQU5BLE9BQUFBLEVBQUF1SCxPQUNBeEksRUFBQThDLEtBQUEsVUFHQS9FLFFBQUFDLElBQUFpRCxHQUVBb0gsRUFBQUssT0FBQXpIIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2Vjb3RvbmVBcHAnLCBbJ25nUm91dGUnLCAnbmdNYXRlcmlhbCcsICduZ01lc3NhZ2VzJywgJ3ZhbGlkYXRpb24ubWF0Y2gnXSk7XG5cbmFwcC5jb25maWcoWyckbWRUaGVtaW5nUHJvdmlkZXInLCAnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCAnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlciwgJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyKXtcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAvL3NldCB0aGVtZSBhbmQgY29sb3IgcGFsZXR0ZVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnZ3JlZW4nKVxuICAgICAgICAuYWNjZW50UGFsZXR0ZSgnYmx1ZS1ncmV5JywgeydkZWZhdWx0JzonNjAwJ30pXG4gICAgICAgIC53YXJuUGFsZXR0ZSAoJ29yYW5nZScpO1xuXG4gICAgLy9yb3V0ZXMgZm9yIHZpZXdzXG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NhbGN1bGF0b3IuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCBhcyBjdHJsJ1xuICAgICAgICB9KS53aGVuKCcvbG9naW4nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9yZWdpc3RlcicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3JlZ2lzdGVyLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NyZWF0ZUFjY291bnRDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWRtaW4nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hZG1pbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhZG1pbkN0cmwgYXMgY3RybCdcblxuICAgICAgICB9KS53aGVuKCcvYWNjb3VudCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2FjY291bnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvZGFzaGJvYXJkJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvZGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2Rhc2hib2FyZEN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9wcm9qZWN0cycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2plY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsIGFzIGN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9hYm91dCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Fib3V0Lmh0bWwnXG4gICAgICAgIH0pLndoZW4oJy9jb250YWN0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY29udGFjdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9wcml2YWN5JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcHJpdmFjeS5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvc291cmNlcycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3NvdXJjZXMuaHRtbCdcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgICAgICB9KTtcblxuICAgIC8vJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnYXV0aEludGVyY2VwdG9yJyk7XG59XSk7IiwiLyoqXG4gKiBBRE1JTlxuICovXG5hcHAuY29udHJvbGxlcignYWRtaW5DdHJsJywgWyckaHR0cCcsICckc2NvcGUnLCckcGFyc2UnLCBmdW5jdGlvbiggJGh0dHAsICRzY29wZSwgJHBhcnNlICl7XG4gICAgLy8gSU5JVFxuICAgIGluaXQoKTtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLnN1Z2dlc3Rpb25zID0gJyc7XG4gICAgc2VsZi5tYXJrQ29tcGxldGUgPSBtYXJrQ29tcGxldGU7XG5cbiAgICBmdW5jdGlvbiBtYXJrQ29tcGxldGUoIHN1Z2dlc3Rpb24gKSB7XG4gICAgICAgIHZhciBpZCA9IHN1Z2dlc3Rpb24uaWQ7XG4gICAgICAgIGNvbnNvbGUubG9nKGlkKTtcbiAgICAgICAgJGh0dHAucHV0KCcvc3VnZ2VzdGlvbi9jb21wbGV0ZS8nICsgaWQpLnRoZW4oZnVuY3Rpb24oIHJlcyApIHtcbiAgICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvc3VnZ2VzdGlvbicpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgdmFyIHN1Z2dlc3Rpb25zID0gcmVzLmRhdGE7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdWdnZXN0aW9ucyk7XG4gICAgICAgICAgICBzZWxmLnN1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbnM7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS5jc3YgPSB7XG4gICAgICAgIGNvbnRlbnQ6IG51bGwsXG4gICAgICAgIGhlYWRlcjogdHJ1ZSxcbiAgICAgICAgaGVhZGVyVmlzaWJsZTogdHJ1ZSxcbiAgICAgICAgc2VwYXJhdG9yOiAnLCcsXG4gICAgICAgIHNlcGFyYXRvclZpc2libGU6IHRydWUsXG4gICAgICAgIHJlc3VsdDogbnVsbCxcbiAgICAgICAgZW5jb2Rpbmc6ICdJU08tODg1OS0xJyxcbiAgICAgICAgZW5jb2RpbmdWaXNpYmxlOiB0cnVlLFxuICAgIH07XG5cbiAgICB2YXIgX2xhc3RHb29kUmVzdWx0ID0gJyc7XG4gICAgJHNjb3BlLnRvUHJldHR5SlNPTiA9IGZ1bmN0aW9uIChqc29uLCB0YWJXaWR0aCkge1xuICAgICAgICB2YXIgb2JqU3RyID0gSlNPTi5zdHJpbmdpZnkoanNvbik7XG4gICAgICAgIHZhciBvYmogPSBudWxsO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgb2JqID0gJHBhcnNlKG9ialN0cikoe30pO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gZWF0ICRwYXJzZSBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIF9sYXN0R29vZFJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciByZXN1bHQgPSBKU09OLnN0cmluZ2lmeShvYmosIG51bGwsIE51bWJlcih0YWJXaWR0aCkpO1xuICAgICAgICBfbGFzdEdvb2RSZXN1bHQgPSByZXN1bHQ7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG59XSk7IiwiYXBwLmNvbnRyb2xsZXIoJ2NhbGN1bGF0ZUN0cmwnLCBbJyRodHRwJywgJyRtZERpYWxvZycsICckcm9vdFNjb3BlJywgJ2F1dGhTZXJ2aWNlJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCAkaHR0cCwgJG1kRGlhbG9nLCAkcm9vdFNjb3BlLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uICkge1xuXG4gICAgLy8gQ2hlY2sgdXNlclxuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cblxuICAgIC8vIElOSVRcbiAgICAkaHR0cC5nZXQoJy9tYXRlcmlhbHMnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHZhciBsaXN0ID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICBpdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgLy8gL2l0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgaXRlbS5wcmltYXJ5X2NhdC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLmxpc3QgPSBsaXN0O1xuXG4gICAgfSk7XG5cbiAgICAvLyBTZWxmIGRlY1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHNlbGYubGlzdCA9ICcnO1xuICAgIHNlbGYuaXNEaXNhYmxlZCA9IGZhbHNlO1xuICAgIHNlbGYucmVzdWx0ID0gJyc7XG4gICAgc2VsZi5xdWVyeVNlYXJjaCA9IHF1ZXJ5U2VhcmNoO1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtQ2hhbmdlID0gc2VsZWN0ZWRJdGVtQ2hhbmdlO1xuICAgIHNlbGYuc2VhcmNoVGV4dENoYW5nZSAgID0gc2VhcmNoVGV4dENoYW5nZTtcbiAgICBzZWxmLm5ld1N1Z2dlc3Rpb24gPSBuZXdTdWdnZXN0aW9uO1xuICAgIHNlbGYuc3VibWl0U3VnZ2VzdGlvbiA9IHN1Ym1pdFN1Z2dlc3Rpb247XG4gICAgc2VsZi51bml0cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ2xicycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMDVcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ2tpbG9zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDAuMDAxMTAyMzFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ3RvbnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnbWV0cmljIHRvbnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMS4xMDIzMVxuICAgICAgICB9XG4gICAgXTtcbiAgICBzZWxmLnN1Ym1pc3Npb24gPSB7XG4gICAgICAgIGVtYWlsOiAnJyxcbiAgICAgICAgbWF0ZXJpYWw6ICcnLFxuICAgICAgICBub3RlczogJydcbiAgICB9O1xuICAgIHNlbGYubmV3Q2FsY3VsYXRpb24gPSBuZXdDYWxjdWxhdGlvbjtcblxuXG4gICAgZnVuY3Rpb24gc2VhcmNoVGV4dENoYW5nZSh0ZXh0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IGNoYW5nZWQgdG8gJywgdGV4dCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlKGl0ZW0pIHtcbiAgICAgICAgaWYgKCBpdGVtID09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHNlbGYuY2F0ZWdvcnkgPSAnJztcbiAgICAgICAgICAgIHNlbGYuc3ViY2F0ZWdvcnkgPSAnJztcbiAgICAgICAgICAgIHNlbGYud2FybUlkID0gJyc7XG4gICAgICAgICAgICBzZWxmLndlaWdodCA9ICcnO1xuICAgICAgICAgICAgc2VsZi5jb252ZXJzaW9uID0gJyc7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3Q2FsY3VsYXRpb24oKSB7XG5cbiAgICAgICAgdmFyIGNhbGN1bGF0ZSA9IHtcbiAgICAgICAgICAgIHdhcm1JZDogc2VsZi53YXJtSWQgfHwgc2VsZi5jYXRlZ29yeS5zZWNvbmRhcmllc1swXS53YXJtX2lkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSAqIHNlbGYuY29udmVyc2lvblxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9jYWxjdWxhdGlvbnMnLCBjYWxjdWxhdGUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHNlbGYucmVzdWx0ID0gTWF0aC5mbG9vcihNYXRoLmFicyhyZXNwb25zZS5kYXRhKSAqIDEwMDApIC8gMTAwMDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVRvUHJvamVjdCgpe1xuICAgICAgICB2YXIgbGluZUl0ZW0gPSB7XG4gICAgICAgICAgICBjYXRlZ29yeTogc2VsZi5jYXRlZ29yeSxcbiAgICAgICAgICAgIHN1YmNhdGVnb3J5OiBzZWxmLnN1YmNhdGVnb3J5LFxuICAgICAgICAgICAgd2FybV9JZDogc2VsZi53YXJtSWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoc2VsZi53ZWlnaHQpKnNlbGYuY29udmVyc2lvbixcbiAgICAgICAgICAgIHVuaXRzOiBzZWxmLnVuaXQubmFtZVxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhsaW5lSXRlbSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9hZGRUb1Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYubGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiBzZWxmLmxpc3Q7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmoucHJpbWFyeV9jYXQuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFN1Z2dlc3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnL3N1Z2dlc3Rpb24nLCBzZWxmLnN1Ym1pc3Npb24pLnRoZW4oZnVuY3Rpb24oIHJlcyApe1xuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3U3VnZ2VzdGlvbiggc3VnZ2VzdGlvbiApe1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lkZW5hdicpLmZvY3VzKCk7XG5cbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3Mvc3VibWl0LW1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgICAgICAgICAgbG9jYWxzOiB7bWF0ZXJpYWw6IHNlbGYuc2VhcmNoVGV4dH1cbiAgICAgICAgfSlcblxuICAgIH1cblxuXG59XSk7IiwiLy8gUmVnaXN0ZXIgSFRNTCAtIE1hZGVsaW5lXG5hcHAuY29udHJvbGxlcignY3JlYXRlQWNjb3VudEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUudXNlciA9IHt9O1xuXG4gICAgJHNjb3BlLnByb2Nlc3NGb3JtID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJQb3N0aW5nLi4uXCIpO1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUudXNlcixcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICAgICAgICAgIGFsZXJ0KFwiWW91ciBhY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQuXCIpXG4gICAgICAgIH0pXG4gICAgfTtcbn1dKTsiLCJhcHAuZGlyZWN0aXZlKCduZ0NzdkltcG9ydCcsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHNjb3BlOntcbiAgICAgICAgICAgIGNvbnRlbnQ6Jz0/JyxcbiAgICAgICAgICAgIGhlYWRlcjogJz0/JyxcbiAgICAgICAgICAgIGhlYWRlclZpc2libGU6ICc9PycsXG4gICAgICAgICAgICBzZXBhcmF0b3I6ICc9PycsXG4gICAgICAgICAgICBzZXBhcmF0b3JWaXNpYmxlOiAnPT8nLFxuICAgICAgICAgICAgcmVzdWx0OiAnPT8nLFxuICAgICAgICAgICAgZW5jb2Rpbmc6ICc9PycsXG4gICAgICAgICAgICBlbmNvZGluZ1Zpc2libGU6ICc9PydcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2PjxkaXYgbmctc2hvdz1cImhlYWRlclZpc2libGVcIj48ZGl2IGNsYXNzPVwibGFiZWxcIj5IZWFkZXI8L2Rpdj48aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJoZWFkZXJcIj48L2Rpdj4nK1xuICAgICAgICAnPGRpdiBuZy1zaG93PVwiZW5jb2RpbmcgJiYgZW5jb2RpbmdWaXNpYmxlXCI+PGRpdiBjbGFzcz1cImxhYmVsXCI+RW5jb2Rpbmc8L2Rpdj48c3Bhbj57e2VuY29kaW5nfX08L3NwYW4+PC9kaXY+JytcbiAgICAgICAgJzxkaXYgbmctc2hvdz1cInNlcGFyYXRvciAmJiBzZXBhcmF0b3JWaXNpYmxlXCI+PGRpdiBjbGFzcz1cImxhYmVsXCI+U2VwZXJhdG9yPC9kaXY+PHNwYW4+PGlucHV0IGNsYXNzPVwic2VwYXJhdG9yLWlucHV0XCIgdHlwZT1cInRleHRcIiBuZy1jaGFuZ2U9XCJjaGFuZ2VTZXBhcmF0b3JcIiBuZy1tb2RlbD1cInNlcGFyYXRvclwiPjxzcGFuPjwvZGl2PicrXG4gICAgICAgICc8ZGl2PjxpbnB1dCBjbGFzcz1cImJ0biBjdGEgZ3JheVwiIHR5cGU9XCJmaWxlXCIvPjwvZGl2PjwvZGl2PicsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgICBzY29wZS5zZXBhcmF0b3JWaXNpYmxlID0gc2NvcGUuc2VwYXJhdG9yVmlzaWJsZSB8fCBmYWxzZTtcbiAgICAgICAgICAgIHNjb3BlLmhlYWRlclZpc2libGUgPSBzY29wZS5oZWFkZXJWaXNpYmxlIHx8IGZhbHNlO1xuXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcuc2VwYXJhdG9yLWlucHV0JykpLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIHNjb3BlLmNvbnRlbnQgIT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjc3Y6IHNjb3BlLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IHNjb3BlLmhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcGFyYXRvcjogZS50YXJnZXQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGluZzogc2NvcGUuZW5jb2RpbmdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0ID0gY3N2VG9KU09OKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZWxlbWVudC5vbignY2hhbmdlJywgZnVuY3Rpb24ob25DaGFuZ2VFdmVudCkge1xuICAgICAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgICAgICAgIHNjb3BlLmZpbGVuYW1lID0gb25DaGFuZ2VFdmVudC50YXJnZXQuZmlsZXNbMF0ubmFtZTtcbiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24ob25Mb2FkRXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3N2OiBvbkxvYWRFdmVudC50YXJnZXQucmVzdWx0LnJlcGxhY2UoL1xcclxcbnxcXHIvZywnXFxuJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwYXJhdG9yOiBzY29wZS5zZXBhcmF0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jb250ZW50ID0gY29udGVudC5jc3Y7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQgPSBjc3ZUb0pTT04oY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQuZmlsZW5hbWUgPSBzY29wZS5maWxlbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICggKG9uQ2hhbmdlRXZlbnQudGFyZ2V0LnR5cGUgPT09IFwiZmlsZVwiKSAmJiAob25DaGFuZ2VFdmVudC50YXJnZXQuZmlsZXMgIT0gbnVsbCB8fCBvbkNoYW5nZUV2ZW50LnNyY0VsZW1lbnQuZmlsZXMgIT0gbnVsbCkgKSAge1xuICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzVGV4dCgob25DaGFuZ2VFdmVudC5zcmNFbGVtZW50IHx8IG9uQ2hhbmdlRXZlbnQudGFyZ2V0KS5maWxlc1swXSwgc2NvcGUuZW5jb2RpbmcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggc2NvcGUuY29udGVudCAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3N2OiBzY29wZS5jb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogIXNjb3BlLmhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXBhcmF0b3I6IHNjb3BlLnNlcGFyYXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VsdCA9IGNzdlRvSlNPTihjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgY3N2VG9KU09OID0gZnVuY3Rpb24oY29udGVudCkge1xuICAgICAgICAgICAgICAgIHZhciBsaW5lcz1jb250ZW50LmNzdi5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkNvdW50ID0gbGluZXNbMF0uc3BsaXQoY29udGVudC5zZXBhcmF0b3IpLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQuaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9bGluZXNbMF0uc3BsaXQoY29udGVudC5zZXBhcmF0b3IpO1xuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT1zdGFydDsgaTxsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50bGluZT1saW5lc1tpXS5zcGxpdChuZXcgUmVnRXhwKGNvbnRlbnQuc2VwYXJhdG9yKycoPyFbXlwiXSpcIig/Oig/OlteXCJdKlwiKXsyfSkqW15cIl0qJCknKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICggY3VycmVudGxpbmUubGVuZ3RoID09PSBjb2x1bW5Db3VudCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50LmhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGo9MDsgajxoZWFkZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtoZWFkZXJzW2pdXSA9IGN1cnJlbnRsaW5lW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaz0wOyBrPGN1cnJlbnRsaW5lLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtrXSA9IGN1cnJlbnRsaW5lW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9fSk7IiwiYXBwLmNvbnRyb2xsZXIoJ2Rhc2hib2FyZEN0cmwnLCBbJyRtZERpYWxvZycsICckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkbWREaWFsb2csICRzY29wZSwgJGh0dHApIHtcbiAgICAvL2xvYWQgcHJvamVjdCBsaXN0IG9uIHBhZ2UgbG9hZFxuICAgICRodHRwLmdldCgnL3Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgJHNjb3BlLnByb2plY3RMaXN0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgLy9yZXNwb25zZS5kYXRhLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIC8vICAgIGl0ZW0ucHJvamVjdF9uYW1lID0gaXRlbS5wcmltYXJ5X2NhdC50b0xvd2VyQ2FzZSgpO1xuICAgIH0pO1xuLy90aGlzIGlzIGZvciB0aGUgZGVsZXRlIG1vZGFsIGFsZXJ0IGZvciBkZWxldGluZyBhIHByb2plY3QtLSBzdGlsbCBub3Qgd29ya2luZyBjb3JyZWN0XG5cbiAgICAkc2NvcGUuc2hvd0RlbGV0ZSA9IGZ1bmN0aW9uKGV2KSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ0NMSUNLJyk7XG4gICAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxuICAgICAgICAgICAgLnRpdGxlKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHlvdXIgcHJvamVjdD8nKVxuICAgICAgICAgICAgLmNvbnRlbnQoJ1RoaXMgaXMgcGVybWFuZW50LicpXG4gICAgICAgICAgICAuYXJpYUxhYmVsKCdEZWxldGUgcHJvamVjdCBwZXJtYW5lbnRseScpXG4gICAgICAgICAgICAub2soJ0RlbGV0ZScpXG4gICAgICAgICAgICAuY2FuY2VsKCdDYW5jZWwnKVxuICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIHByb2plY3QgaGFzIGJlZW4gZGVsZXRlZC4nO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIHByb2plY3QgaGFzIG5vdCBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSk7XG4gICAgfTtcbi8vICAgIGZ1bmN0aW9uIERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2cpIHtcbi8vICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5hbnN3ZXIgPSBmdW5jdGlvbihhbnN3ZXIpIHtcbi8vICAgICAgICAkbWREaWFsb2cuaGlkZShhbnN3ZXIpO1xuLy8gICAgfTtcbi8vfVxuXG59XSk7IiwiLy8gTG9naW4gSFRNTCAtIEthdGVcbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpIHtcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgICAgIGRhdGE6ICRzY29wZS5mb3JtXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKHJlc3BvbnNlLmRhdGEudG9rZW4pO1xuICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgfSlcbiAgICB9XG59XSk7IiwiLy8gQ2hhbmdlIE5hdmlnYXRpb24gT3B0aW9ucyB3aXRoIExvZ2luXG5hcHAuY29udHJvbGxlcignbmF2Q3RybCcsIFsnYXV0aFNlcnZpY2UnLCAnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJywgJyRodHRwJywgZnVuY3Rpb24oYXV0aFNlcnZpY2UsICRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uLCAkaHR0cCl7XG4gICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuXG4gICAgaWYoJHJvb3RTY29wZS51c2VyICYmICRyb290U2NvcGUudXNlci51c2VybmFtZSl7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG4gICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgfVxufV0pO1xuIiwiLy8gUHJvamVjdCBQYWdlIC0gIEtpbS9NYWRlbGVpbmVcbmFwcC5jb250cm9sbGVyKCdwcm9qZWN0c0N0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYucHJvamVjdExpc3QgPSAnJztcbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgPSBzZWFyY2hUZXh0Q2hhbmdlO1xuICAgIHNlbGYucHJvamVjdFRvdGFsPSAwO1xuICAgIHNlbGYuZGVsZXRlUHJvamVjdEl0ZW0gPSBkZWxldGVQcm9qZWN0SXRlbTtcbiAgICBzZWxmLmlkID0gMDtcblxuXG4gICAgLy9sb2FkIHByb2plY3QgbGlzdCBvbiBwYWdlIGxvYWRcbiAgICBzZWxmLmdldFByb2plY3RMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vbmVlZCB0byBmaWd1cmUgb3V0IGhvdyB0byBwYXNzIHRoZSB1c2VyaWQgZnJvbSB0aGUgbG9naW4gcGFnZS0tdXNlIHRoZSBzYW1lIGNvbnRyb2xsZXI/XG4gICAgICAgICRodHRwLmdldCgnL3Byb2plY3QnLCB1c2VyaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB2YXIgcHJvamVjdExpc3QgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgcHJvamVjdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGl0ZW0ucHJvamVjdF9uYW1lID0gaXRlbS5wcm9qZWN0X25hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAvL2l0ZW0ucHJvamVjdF9kZXNjcmlwdGlvbiA9IGl0ZW0ucHJvamVjdF9kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAvL2l0ZW0uaXRlbUlkID0gaXRlbS5pZDtcbiAgICAgICAgICAgICAgICAvL2l0ZW0uY28yX29mZnNldCA9IGl0ZW0uY28yX29mZnNldDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZi5wcm9qZWN0TGlzdCA9IHByb2plY3RMaXN0O1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcXVlcnlTZWFyY2gocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5ID8gc2VsZi5wcm9qZWN0TGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiBzZWxmLnByb2plY3RMaXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvL3F1ZXJ5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcXVlcnkuc2xpY2UoMSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAob2JqLnByaW1hcnlfY2F0LmluZGV4T2YobG93ZXJjYXNlUXVlcnkpICE9IC0xKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWFyY2hUZXh0Q2hhbmdlKHRleHQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1RleHQgY2hhbmdlZCB0byAnLCB0ZXh0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1DaGFuZ2UoaXRlbSkge1xuICAgICAgICBpZiAoIGl0ZW0gPT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgc2VsZi5wcm9qZWN0X25hbWUgPSAnJztcbiAgICAgICAgICAgIHNlbGYucHJvamVjdF9kZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLnNob3dEZWxldGUgPSBmdW5jdGlvbihldikge1xuICAgICAgICBjb25zb2xlLmxvZygnQ0xJQ0snKTtcbiAgICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXG4gICAgICAgICAgICAudGl0bGUoJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBpdGVtPycpXG4gICAgICAgICAgICAuY29udGVudCgnVGhpcyB3aWxsIGJlIHBlcm1hbmVudC4nKVxuICAgICAgICAgICAgLmFyaWFMYWJlbCgnRGVsZXRlIGl0ZW0gcGVybWFuZW50bHknKVxuICAgICAgICAgICAgLm9rKCdEZWxldGUnKVxuICAgICAgICAgICAgLmNhbmNlbCgnQ2FuY2VsJylcbiAgICAgICAgICAgIC50YXJnZXRFdmVudChldik7XG4gICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBpdGVtIGhhcyBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBpdGVtIGhhcyBub3QgYmVlbiBkZWxldGVkLic7XG4gICAgICAgIH0pO1xuICAgIH07XG4vLyAgICBmdW5jdGlvbiBEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4vLyAgICAkc2NvcGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuYW5zd2VyID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbi8vICAgIH07XG4vL31cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZVByb2plY3RJdGVtKCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkRlbGV0aW5nLi4uXCIsIHNlbGYucHJvamVjdExpc3QuSUQpO1xuICAgICAgICAvLyRodHRwLnVwZGF0ZSgnL3Byb2plY3QnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAvL2ZpbmRPbmUgYW5kIGRlbGV0ZSBieSBpZCB1c2luZyBwcm9qZWN0bGlzdC5pZFxuICAgICAgICAvLyAgICBjb25zb2xlLmxvZyhcIkl0ZW0gd2FzIGRlbGV0ZWQuXCIsIHJlc3BvbnNlKTtcbiAgICAgICAgLy8gICAgc2VsZi5nZXRQcm9qZWN0TGlzdCgpO1xuICAgIH07XG5cbiAgICAvL3NlbGYuY2FsY3VsYXRlUHJvamVjdFRvdGFsKCl7XG4gICAgLy8vL2ZvckVhY2ggcHJvamVjdFxuICAgIC8vICAgIHZhciBwcm9qZWN0VG90YWwrPXByb2plY3RMaXN0LmNvMl9vZmZzZXQ7XG4gICAgLy8gICAgcmV0dXJuIHByb2plY3RUb3RhbDtcbiAgICAvL31cbiAgICAvL307XG59XSk7IiwiLy8gU2VydmljZXMgZm9yIGF1dGhlbnRpY2F0aW9uXG5hcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdyl7XG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSk7XG5cbmFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
