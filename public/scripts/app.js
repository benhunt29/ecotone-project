var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,o,r){o.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl"}).when("/login",{templateUrl:"/views/login.html",controller:""}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$scope","$http",function(e,t){function o(e){console.log("Text changed to ",e)}function r(e){void 0==e&&(c.category="",c.subcategory="",c.warmId="",c.weight="",c.conversion="")}function n(){var e={warmId:c.warmId||c.category.secondaries[0].warm_id,weight:parseFloat(c.weight)*c.conversion};t.post("/calculations",e).then(function(e){c.result=Math.floor(1e3*Math.abs(e.data))/1e3})}function a(e){return e?c.list.filter(l(e)):c.list}function l(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}t.get("/materials").then(function(e){var t=e.data;t.forEach(function(e){e.primary_cat=e.primary_cat.toLowerCase()}),c.list=t});var c=this;c.list="",c.result="",c.querySearch=a,c.selectedItemChange=r,c.searchTextChange=o,c.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],c.newCalculation=n}]),app.controller("loginCtrl",["$scope","$http","authService",function(e,t,o){e.login=function(){t({method:"POST",url:"/login",data:e.user}).then(function(e){o.saveToken(e.data.token)})}}]),app.controller("createAccountCtrl",["$scope","$http",function(e,t){e.user={},e.processForm=function(o){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),alert("Your account has been created.")})}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){t({method:"POST",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records})}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],r=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkc2NvcGUiLCIkaHR0cCIsInNlYXJjaFRleHRDaGFuZ2UiLCJ0ZXh0IiwiY29uc29sZSIsImxvZyIsInNlbGVjdGVkSXRlbUNoYW5nZSIsIml0ZW0iLCJ1bmRlZmluZWQiLCJzZWxmIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1JZCIsIndlaWdodCIsImNvbnZlcnNpb24iLCJuZXdDYWxjdWxhdGlvbiIsImNhbGN1bGF0ZSIsInNlY29uZGFyaWVzIiwid2FybV9pZCIsInBhcnNlRmxvYXQiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwicmVzdWx0IiwiTWF0aCIsImZsb29yIiwiYWJzIiwiZGF0YSIsInF1ZXJ5U2VhcmNoIiwicXVlcnkiLCJsaXN0IiwiZmlsdGVyIiwiY3JlYXRlRmlsdGVyRm9yIiwibG93ZXJjYXNlUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsIm9iaiIsInByaW1hcnlfY2F0IiwiaW5kZXhPZiIsImdldCIsImZvckVhY2giLCJ0aGlzIiwidW5pdHMiLCJuYW1lIiwiYXV0aFNlcnZpY2UiLCJsb2dpbiIsIm1ldGhvZCIsInVybCIsInVzZXIiLCJzYXZlVG9rZW4iLCJ0b2tlbiIsInByb2Nlc3NGb3JtIiwiZGF0YVR5cGUiLCJhbGVydCIsIm5hbWVzIiwicmVjb3JkcyIsInNlcnZpY2UiLCIkd2luZG93IiwicGFyc2VKd3QiLCJiYXNlNjRVcmwiLCJzcGxpdCIsImJhc2U2NCIsInJlcGxhY2UiLCJKU09OIiwicGFyc2UiLCJhdG9iIiwibG9jYWxTdG9yYWdlIiwiand0VG9rZW4iLCJnZXRUb2tlbiIsImlzQXV0aGVkIiwicGFyYW1zIiwibm90RXhwaXJlZCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJsb2dvdXQiLCJnZXRVc2VyIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwicmVxdWVzdCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwic3RhdHVzIiwicGF0aCIsInJlc3BvbnNlRXJyb3IiLCJyZWplY3QiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLEtBQU1DLFFBQVFDLE9BQU8sY0FBZSxVQUFXLGFBQWMsY0FFakVGLEtBQUlHLFFBQVEscUJBQXNCLGlCQUFrQixvQkFBcUIsZ0JBQWlCLFNBQVNDLEVBQW9CQyxFQUFnQkMsRUFBbUJDLEdBQ3RKRCxFQUFrQkUsV0FBVSxHQUc1QkosRUFBbUJLLE1BQU0sV0FDcEJDLGVBQWUsU0FDZkMsY0FBYyxhQUFjQyxVQUFVLFFBQ3RDQyxZQUFhLFVBR2xCUixFQUFlUyxLQUFLLEtBRVpDLFlBQWEseUJBQ2JDLFdBQVksa0JBQ2JGLEtBQUssVUFFSkMsWUFBYSxvQkFDYkMsV0FBWSxLQUNiRixLQUFLLGFBRUpDLFlBQWEsdUJBQ2JDLFdBQVksc0JBQ2JGLEtBQUssWUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxLQUNiRixLQUFLLGNBRUpDLFlBQWEsd0JBQ2JDLFdBQVksaUJBQ2JGLEtBQUssYUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxpQkFDYkYsS0FBSyxVQUVKQyxZQUFhLHNCQUNkRCxLQUFLLFlBRUpDLFlBQWEsc0JBQ2JDLFdBQVksS0FDYkYsS0FBSyxZQUVKQyxZQUFhLHdCQUNkRSxXQUNDQyxXQUFZLFNBTXhCbEIsSUFBSWdCLFdBQVcsaUJBQWtCLFNBQVUsUUFBUyxTQUFTRyxFQUFRQyxHQTJDakUsUUFBU0MsR0FBaUJDLEdBQ3RCQyxRQUFRQyxJQUFJLG1CQUFvQkYsR0FHcEMsUUFB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SUFBSWxCLEVBQU8sQ0FDUCxHQUFJb0IsR0FBUzdCLEtBQUtpQixTQUFTUixHQUN2QnFCLEVBQWE5QyxLQUFLK0MsT0FBTSxHQUFJQyxPQUFPQyxVQUFZLE1BQVNKLEVBQU9LLEdBSW5FLE9BSEtKLElBQ0Q5QixLQUFLbUMsU0FFRkwsRUFFUCxPQUFPLEdBSWY5QixLQUFLbUMsT0FBUyxpQkFDSG5CLEdBQVFTLGFBQWFDLFVBSWhDMUIsS0FBS29DLFFBQVUsV0FDWCxNQUFPcEMsTUFBS2lCLFNBQVNqQixLQUFLMkIsZ0JBSWxDdEYsSUFBSWdHLFFBQVEsbUJBQW9CLEtBQU0sWUFBYSxjQUFlLFNBQVVDLEVBQUlDLEVBQVdwQyxHQUN2RixPQUNJcUMsUUFBUyxTQUFVaEcsR0FLZixNQUpBQSxHQUFPaUcsUUFBVWpHLEVBQU9pRyxZQUNwQnRDLEVBQVl5QixhQUNacEYsRUFBT2lHLFFBQVFDLGNBQWdCLFVBQVl2QyxFQUFZd0IsWUFFcERuRixHQUVYc0MsU0FBVSxTQUFVQSxHQU9oQixNQUx3QixPQUFwQkEsRUFBUzZELFFBR1RKLEVBQVVLLEtBQUssVUFFWjlELEdBQVl3RCxFQUFHbkYsS0FBSzJCLElBQzVCK0QsY0FBZSxTQUFVL0QsR0FPeEIsTUFOd0IsT0FBcEJBLEVBQVM2RCxPQUNUSixFQUFVSyxLQUFLLFVBR2ZoRixRQUFRQyxJQUFJaUIsR0FFVHdELEVBQUdRLE9BQU9oRSIsImZpbGUiOiJzY3JpcHRzL2FwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZWNvdG9uZUFwcCcsIFsnbmdSb3V0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnXSk7XG5cbmFwcC5jb25maWcoWyckbWRUaGVtaW5nUHJvdmlkZXInLCAnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCAnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlciwgJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyKXtcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAvL3NldCB0aGVtZSBhbmQgY29sb3IgcGFsZXR0ZVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnZ3JlZW4nKVxuICAgICAgICAuYWNjZW50UGFsZXR0ZSgnYmx1ZS1ncmV5JywgeydkZWZhdWx0JzonNjAwJ30pXG4gICAgICAgIC53YXJuUGFsZXR0ZSAoJ29yYW5nZScpO1xuXG4gICAgLy9yb3V0ZXMgZm9yIHZpZXdzXG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NhbGN1bGF0b3IuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwnXG4gICAgICAgIH0pLndoZW4oJy9wcm9qZWN0cycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2plY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWJvdXQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hYm91dC5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcHJpdmFjeScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3ByaXZhY3kuaHRtbCdcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgICAgICB9KTtcblxuICAgIC8vJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnYXV0aEludGVyY2VwdG9yJyk7XG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdjYWxjdWxhdGVDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgLy8gSU5JVFxuICAgICRodHRwLmdldCgnL21hdGVyaWFscycpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgdmFyIGxpc3QgPSByZXNwb25zZS5kYXRhO1xuXG4gICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgIGl0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAvLyAvaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBpdGVtLnByaW1hcnlfY2F0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYubGlzdCA9IGxpc3Q7XG5cbiAgICB9KTtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5saXN0ID0gJyc7XG4gICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICBzZWxmLnF1ZXJ5U2VhcmNoID0gcXVlcnlTZWFyY2g7XG4gICAgc2VsZi5zZWxlY3RlZEl0ZW1DaGFuZ2UgPSBzZWxlY3RlZEl0ZW1DaGFuZ2U7XG4gICAgc2VsZi5zZWFyY2hUZXh0Q2hhbmdlICAgPSBzZWFyY2hUZXh0Q2hhbmdlO1xuICAgIHNlbGYudW5pdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDA1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdraWxvcycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMTEwMjMxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ21ldHJpYyB0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDEuMTAyMzFcbiAgICAgICAgfVxuICAgIF07XG4gICAgc2VsZi5uZXdDYWxjdWxhdGlvbiA9IG5ld0NhbGN1bGF0aW9uO1xuXG5cbiAgICBmdW5jdGlvbiBzZWFyY2hUZXh0Q2hhbmdlKHRleHQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1RleHQgY2hhbmdlZCB0byAnLCB0ZXh0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1DaGFuZ2UoaXRlbSkge1xuICAgICAgICBpZiAoIGl0ZW0gPT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgc2VsZi5jYXRlZ29yeSA9ICcnO1xuICAgICAgICAgICAgc2VsZi5zdWJjYXRlZ29yeSA9ICcnO1xuICAgICAgICAgICAgc2VsZi53YXJtSWQgPSAnJztcbiAgICAgICAgICAgIHNlbGYud2VpZ2h0ID0gJyc7XG4gICAgICAgICAgICBzZWxmLmNvbnZlcnNpb24gPSAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld0NhbGN1bGF0aW9uKCkge1xuXG4gICAgICAgIHZhciBjYWxjdWxhdGUgPSB7XG4gICAgICAgICAgICB3YXJtSWQ6IHNlbGYud2FybUlkIHx8IHNlbGYuY2F0ZWdvcnkuc2Vjb25kYXJpZXNbMF0ud2FybV9pZCxcbiAgICAgICAgICAgIHdlaWdodDogcGFyc2VGbG9hdChzZWxmLndlaWdodCkgKiBzZWxmLmNvbnZlcnNpb25cbiAgICAgICAgfTtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvY2FsY3VsYXRpb25zJywgY2FsY3VsYXRlKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9IE1hdGguZmxvb3IoTWF0aC5hYnMocmVzcG9uc2UuZGF0YSkgKiAxMDAwKSAvIDEwMDA7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhdmVUb1Byb2plY3QoKXtcbiAgICAgICAgdmFyIGxpbmVJdGVtID0ge1xuICAgICAgICAgICAgY2F0ZWdvcnk6IHNlbGYuY2F0ZWdvcnksXG4gICAgICAgICAgICBzdWJjYXRlZ29yeTogc2VsZi5zdWJjYXRlZ29yeSxcbiAgICAgICAgICAgIHdhcm1fSWQ6IHNlbGYud2FybUlkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSpzZWxmLmNvbnZlcnNpb24sXG4gICAgICAgICAgICB1bml0czogc2VsZi51bml0Lm5hbWVcbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5sb2cobGluZUl0ZW0pO1xuICAgICAgICAkaHR0cC5wb3N0KCcvYWRkVG9Qcm9qZWN0JykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBxdWVyeVNlYXJjaChxdWVyeSkge1xuICAgICAgICByZXR1cm4gcXVlcnkgPyBzZWxmLmxpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogc2VsZi5saXN0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpIC8vcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmoucHJpbWFyeV9jYXQuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cbn1dKTtcblxuLy8gTG9naW4gSFRNTCAtIEthdGVcbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUudXNlclxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhLnRva2VuKTtcbiAgICAgICAgfSlcbiAgICB9XG59XSk7XG5cbi8vIFJlZ2lzdGVyIEhUTUwgLSBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUFjY291bnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7XG5cbi8vIFByb2plY3QgSFRNTCAtIERhc2hib2FyZCBIVE1MIC0gS2ltXG5hcHAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgJGh0dHAoe1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL2FuZ3VsYXIvY3VzdG9tZXJzLnBocCdcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc2NvcGUubmFtZXMgPSByZXNwb25zZS5yZWNvcmRzO1xuICAgIH0pO1xuXG5cbn1dKTtcblxuLy8gU2VydmljZXMgZm9yIGF1dGhlbnRpY2F0aW9uXG5hcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdyl7XG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSk7XG5cbmFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
