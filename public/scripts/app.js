var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,o,r){o.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue").warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl"}).when("/login",{templateUrl:"/views/login.html",controller:""}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$scope","$http",function(e,t){function o(){var t=[{category:"blinds",subcategory:["wood","vinyl","aluminum"]},{category:"asphalt shingles",subcategory:[]},{category:"cabinets",subcategory:["aluminum","wood","fiberglass","glass","plastic","steel","vinyl","MDF"]}];e.list=t}function r(e){var t=angular.lowercase(e);return function(e){return console.log(e),-1!=e.category.indexOf(t)}}e.calculate={},e.list={},o(),e.major=["Category 1","Category 2","Category 3"],e.sub=["Sub-category 1","Sub-category 2","Sub-category 3"],e.unit=["lbs","tons","kg"],e.querySearch=function(t){return console.log(e.list),t?e.list.filter(r(t)):e.list}}]),app.controller("createAccountCtrl",["$scope","$http",function(e,t){e.user={},e.processForm=function(o){console.log("Posting..."),t({method:"POST",url:"/newUser",data:e.user,dataType:"json"}).then(function(e){console.log(e),alert("Your account has been created.")})}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){t({method:"POST",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records}),t({method:"GET",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records})}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],r=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwid2FyblBhbGV0dGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsIiRzY29wZSIsIiRodHRwIiwibG9hZENhdGVnb3JpZXMiLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsImxpc3QiLCJjcmVhdGVGaWx0ZXJGb3IiLCJxdWVyeSIsImxvd2VyY2FzZVF1ZXJ5IiwibG93ZXJjYXNlIiwib2JqIiwiY29uc29sZSIsImxvZyIsImluZGV4T2YiLCJjYWxjdWxhdGUiLCJtYWpvciIsInN1YiIsInVuaXQiLCJxdWVyeVNlYXJjaCIsImZpbHRlciIsInVzZXIiLCJwcm9jZXNzRm9ybSIsIm1ldGhvZCIsInVybCIsImRhdGEiLCJkYXRhVHlwZSIsInRoZW4iLCJyZXNwb25zZSIsImFsZXJ0IiwibmFtZXMiLCJyZWNvcmRzIiwic2VydmljZSIsIiR3aW5kb3ciLCJ0aGlzIiwicGFyc2VKd3QiLCJ0b2tlbiIsImJhc2U2NFVybCIsInNwbGl0IiwiYmFzZTY0IiwicmVwbGFjZSIsIkpTT04iLCJwYXJzZSIsImF0b2IiLCJzYXZlVG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwiTWF0aCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJsb2dvdXQiLCJnZXRVc2VyIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJzdGF0dXMiLCJwYXRoIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsS0FBTUMsUUFBUUMsT0FBTyxjQUFlLFVBQVcsYUFBYyxjQUVqRUYsS0FBSUcsUUFBUSxxQkFBc0IsaUJBQWtCLG9CQUFxQixnQkFBaUIsU0FBU0MsRUFBb0JDLEVBQWdCQyxFQUFtQkMsR0FDdEpELEVBQWtCRSxXQUFVLEdBRzVCSixFQUFtQkssTUFBTSxXQUNwQkMsZUFBZSxTQUNmQyxjQUFjLFFBQ2RDLFlBQWEsVUFHbEJQLEVBQWVRLEtBQUssS0FFWkMsWUFBYSx5QkFDYkMsV0FBWSxrQkFDYkYsS0FBSyxVQUVKQyxZQUFhLG9CQUNiQyxXQUFZLEtBQ2JGLEtBQUssYUFFSkMsWUFBYSx1QkFDYkMsV0FBWSxzQkFDYkYsS0FBSyxZQUVKQyxZQUFhLHNCQUNiQyxXQUFZLEtBQ2JGLEtBQUssY0FFSkMsWUFBYSx3QkFDYkMsV0FBWSxpQkFDYkYsS0FBSyxhQUVKQyxZQUFhLHNCQUNiQyxXQUFZLGlCQUNiRixLQUFLLFVBRUpDLFlBQWEsc0JBQ2RELEtBQUssWUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxLQUNiRixLQUFLLFlBRUpDLFlBQWEsd0JBQ2RFLFdBQ0NDLFdBQVksU0FPeEJqQixJQUFJZSxXQUFXLGlCQUFrQixTQUFVLFFBQVMsU0FBU0csRUFBUUMsR0FpRGpFLFFBQVNDLEtBQ0wsR0FBSUMsS0FFSUMsU0FBVSxTQUNWQyxhQUFjLE9BQVEsUUFBUyxjQUcvQkQsU0FBVSxtQkFDVkMsaUJBR0FELFNBQVUsV0FDVkMsYUFBYyxXQUFZLE9BQVEsYUFBYyxRQUM1QyxVQUFXLFFBQVMsUUFBUyxRQUd6Q0wsR0FBT00sS0FBT0gsRUFJbEIsUUFBU0ksR0FBZ0JDLEdBQ3JCLEdBQUlDLEdBQWlCMUIsUUFBUTJCLFVBQVVGLEVBQ3ZDLE9BQU8sVUFBa0JHLEdBRXJCLE1BREFDLFNBQVFDLElBQUlGLEdBQ29DLElBQXhDQSxFQUFJUCxTQUFTVSxRQUFRTCxJQXZFckNULEVBQU9lLGFBQ1BmLEVBQU9NLFFBQ1BKLElBR0FGLEVBQU9nQixPQUNILGFBQ0EsYUFDQSxjQUVKaEIsRUFBT2lCLEtBQ0gsaUJBQ0EsaUJBQ0Esa0JBRUpqQixFQUFPa0IsTUFDSCxNQUNBLE9BQ0EsTUFnQkpsQixFQUFPbUIsWUFBWSxTQUFTWCxHQUV4QixNQURBSSxTQUFRQyxJQUFJYixFQUFPTSxNQUNaRSxFQUFRUixFQUFPTSxLQUFLYyxPQUFPYixFQUFnQkMsSUFBVVIsRUFBT00sU0F5QzNFeEIsSUFBSWUsV0FBVyxxQkFBc0IsU0FBVSxRQUFTLFNBQVNHLEVBQVFDLEdBQ3JFRCxFQUFPcUIsUUFFUHJCLEVBQU9zQixZQUFjLFNBQVVELEdBQzNCVCxRQUFRQyxJQUFJLGNBQ1paLEdBQ0lzQixPQUFRLE9BQ1JDLElBQUssV0FDTEMsS0FBTXpCLEVBQU9xQixLQUNiSyxTQUFVLFNBQ1hDLEtBQUssU0FBVUMsR0FDZGhCLFFBQVFDLElBQUllLEdBQ1pDLE1BQU0sd0NBTWxCL0MsSUFBSWUsV0FBVyxnQkFBaUIsU0FBVSxRQUFTLFNBQVNHLEVBQVFDLEdBQ2hFQSxHQUNJc0IsT0FBUSxPQUNSQyxJQUFLLG1EQUNORyxLQUFLLFNBQVVDLEdBQ2Q1QixFQUFPOEIsTUFBUUYsRUFBU0csVUFHNUI5QixHQUNJc0IsT0FBUSxNQUNSQyxJQUFLLG1EQUNORyxLQUFLLFNBQVVDLEdBQ2Q1QixFQUFPOEIsTUFBUUYsRUFBU0csYUFLaENqRCxJQUFJa0QsUUFBUSxlQUFnQixVQUFXLFNBQVVDLEdBQzdDQyxLQUFLQyxTQUFXLFNBQVVDLEdBQ3RCLEdBQUlBLEVBQU8sQ0FDUCxHQUFJQyxHQUFZRCxFQUFNRSxNQUFNLEtBQUssR0FDN0JDLEVBQVNGLEVBQVVHLFFBQVEsSUFBSyxLQUFLQSxRQUFRLElBQUssSUFDdEQsT0FBT0MsTUFBS0MsTUFBTVQsRUFBUVUsS0FBS0osSUFDNUIsVUFHWEwsS0FBS1UsVUFBWSxTQUFVUixHQUN2QkgsRUFBUVksYUFBYUMsU0FBV1YsRUFDaEN4QixRQUFRQyxJQUFJLGVBQWVvQixFQUFRWSxhQUFhQyxXQUdwRFosS0FBS2EsU0FBVyxXQUNaLE1BQU9kLEdBQVFZLGFBQWFDLFVBR2hDWixLQUFLYyxTQUFXLFdBQ1osR0FBSVosR0FBUUYsS0FBS2EsVUFDakIsSUFBSVgsRUFBTyxDQUNQLEdBQUlhLEdBQVNmLEtBQUtDLFNBQVNDLEdBQ3ZCYyxFQUFhQyxLQUFLQyxPQUFNLEdBQUlDLE9BQU9DLFVBQVksTUFBU0wsRUFBT00sR0FJbkUsT0FIS0wsSUFDRGhCLEtBQUtzQixTQUVGTixFQUVQLE9BQU8sR0FJZmhCLEtBQUtzQixPQUFTLGlCQUNIdkIsR0FBUVksYUFBYUMsVUFJaENaLEtBQUt1QixRQUFVLFdBQ1gsTUFBT3ZCLE1BQUtDLFNBQVNELEtBQUthLGdCQUlsQ2pFLElBQUk0RSxRQUFRLG1CQUFvQixLQUFNLFlBQWEsY0FBZSxTQUFVQyxFQUFJQyxFQUFXQyxHQUN2RixPQUNJQyxRQUFTLFNBQVU3RSxHQUtmLE1BSkFBLEdBQU84RSxRQUFVOUUsRUFBTzhFLFlBQ3BCRixFQUFZYixhQUNaL0QsRUFBTzhFLFFBQVFDLGNBQWdCLFVBQVlILEVBQVlkLFlBRXBEOUQsR0FFWDJDLFNBQVUsU0FBVUEsR0FPaEIsTUFMd0IsT0FBcEJBLEVBQVNxQyxRQUdUTCxFQUFVTSxLQUFLLFVBRVp0QyxHQUFZK0IsRUFBR2hFLEtBQUtpQyxJQUM1QnVDLGNBQWUsU0FBVXZDLEdBT3hCLE1BTndCLE9BQXBCQSxFQUFTcUMsT0FDVEwsRUFBVU0sS0FBSyxVQUdmdEQsUUFBUUMsSUFBSWUsR0FFVCtCLEVBQUdTLE9BQU94QyIsImZpbGUiOiJzY3JpcHRzL2FwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZWNvdG9uZUFwcCcsIFsnbmdSb3V0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnXSk7XG5cbmFwcC5jb25maWcoWyckbWRUaGVtaW5nUHJvdmlkZXInLCAnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCAnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlciwgJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyKXtcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAvL3NldCB0aGVtZSBhbmQgY29sb3IgcGFsZXR0ZVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnZ3JlZW4nKVxuICAgICAgICAuYWNjZW50UGFsZXR0ZSgnYmx1ZScpXG4gICAgICAgIC53YXJuUGFsZXR0ZSAoJ29yYW5nZScpO1xuXG4gICAgLy9yb3V0ZXMgZm9yIHZpZXdzXG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NhbGN1bGF0b3IuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwnXG4gICAgICAgIH0pLndoZW4oJy9wcm9qZWN0cycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2plY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWJvdXQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hYm91dC5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcHJpdmFjeScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3ByaXZhY3kuaHRtbCdcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgICAgICB9KTtcblxuICAgIC8vJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnYXV0aEludGVyY2VwdG9yJyk7XG59XSk7XG5cbi8vIENhbGN1bGF0b3IgSFRNTCAtIEthdGUgKyBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NhbGN1bGF0ZUN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApe1xuICAgIC8vTVxuICAgICRzY29wZS5jYWxjdWxhdGUgPSB7fTtcbiAgICAkc2NvcGUubGlzdCA9IHt9O1xuICAgIGxvYWRDYXRlZ29yaWVzKCk7XG5cbiAgICAvL0tcbiAgICAkc2NvcGUubWFqb3IgPSBbXG4gICAgICAgICdDYXRlZ29yeSAxJyxcbiAgICAgICAgJ0NhdGVnb3J5IDInLFxuICAgICAgICAnQ2F0ZWdvcnkgMydcbiAgICBdO1xuICAgICRzY29wZS5zdWIgPSBbXG4gICAgICAgICdTdWItY2F0ZWdvcnkgMScsXG4gICAgICAgICdTdWItY2F0ZWdvcnkgMicsXG4gICAgICAgICdTdWItY2F0ZWdvcnkgMydcbiAgICBdO1xuICAgICRzY29wZS51bml0ID0gW1xuICAgICAgICAnbGJzJyxcbiAgICAgICAgJ3RvbnMnLFxuICAgICAgICAna2cnXG4gICAgXTtcblxuICAgIC8vTVxuICAgIC8vbG9hZCBjYXRlZ29yaWVzIGxpc3Qgb24gcGFnZSBsb2FkXG4vLyAkaHR0cCh7XG4vLyAgICAgICAgICAgICBtZXRob2Q6ICdHZXQnLFxuLy8gICAgICAgICAgICAgdXJsOiAnL2dldExpc3QnLFxuLy8gICAgICAgICAgICAgZGF0YTogcmVzcG9uc2UsXG4vLyAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4vLyAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4vLyAgICAgICAgICAgICAkc2NvcGUubGlzdCA9IHJlc3BvbnNlO1xuLy8gICAgICAgICB9KVxuXG4gICAgLy8gQXV0by1jb21wbGV0ZSBmdW5jdGlvbmFsaXR5XG4gICAgJHNjb3BlLnF1ZXJ5U2VhcmNoPWZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5saXN0KTtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5ID8gJHNjb3BlLmxpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogJHNjb3BlLmxpc3Q7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICAkbG9nLmluZm8oJ1RleHQgY2hhbmdlZCB0byAnICsgdGV4dCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlKGl0ZW0pIHtcbiAgICAgICAgJGxvZy5pbmZvKCdJdGVtIGNoYW5nZWQgdG8gJyArIEpTT04uc3RyaW5naWZ5KGl0ZW0pKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2FkQ2F0ZWdvcmllcygpIHtcbiAgICAgICAgdmFyIGNhdGVnb3JpZXMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IFwiYmxpbmRzXCIsXG4gICAgICAgICAgICAgICAgc3ViY2F0ZWdvcnk6IFtcIndvb2RcIiwgXCJ2aW55bFwiLCBcImFsdW1pbnVtXCJdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBcImFzcGhhbHQgc2hpbmdsZXNcIixcbiAgICAgICAgICAgICAgICBzdWJjYXRlZ29yeTogW11cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcnk6IFwiY2FiaW5ldHNcIixcbiAgICAgICAgICAgICAgICBzdWJjYXRlZ29yeTogW1wiYWx1bWludW1cIiwgXCJ3b29kXCIsIFwiZmliZXJnbGFzc1wiLCBcImdsYXNzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwicGxhc3RpY1wiLCBcInN0ZWVsXCIsIFwidmlueWxcIiwgXCJNREZcIl1cbiAgICAgICAgICAgIH1dO1xuXG4gICAgICAgICRzY29wZS5saXN0ID0gY2F0ZWdvcmllcztcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgZmlsdGVyIGZ1bmN0aW9uIGZvciBhIHF1ZXJ5IHN0cmluZ1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICB2YXIgbG93ZXJjYXNlUXVlcnkgPSBhbmd1bGFyLmxvd2VyY2FzZShxdWVyeSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG9iaik7XG4gICAgICAgICAgICByZXR1cm4gKG9iai5jYXRlZ29yeS5pbmRleE9mKGxvd2VyY2FzZVF1ZXJ5KSAhPSAtMSk7XG4gICAgICAgIH07XG4gICAgfVxufV0pO1xuXG4vLyBMb2dpbiBIVE1MIC0gTWFkZWxpbmVcbmFwcC5jb250cm9sbGVyKCdjcmVhdGVBY2NvdW50Q3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgICRzY29wZS51c2VyID0ge307XG5cbiAgICAkc2NvcGUucHJvY2Vzc0Zvcm0gPSBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlBvc3RpbmcuLi5cIik7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnL25ld1VzZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7XG5cbi8vIFByb2plY3QgSFRNTCAtIERhc2hib2FyZCBIVE1MIC0gS2ltXG5hcHAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKSB7XG4gICAgJGh0dHAoe1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL2FuZ3VsYXIvY3VzdG9tZXJzLnBocCdcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc2NvcGUubmFtZXMgPSByZXNwb25zZS5yZWNvcmRzO1xuICAgIH0pO1xuXG4gICAgJGh0dHAoe1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICB1cmw6ICdodHRwOi8vd3d3Lnczc2Nob29scy5jb20vYW5ndWxhci9jdXN0b21lcnMucGhwJ1xuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICRzY29wZS5uYW1lcyA9IHJlc3BvbnNlLnJlY29yZHM7XG4gICAgfSk7XG59XSk7XG5cbi8vIFNlcnZpY2VzIGZvciBhdXRoZW50aWNhdGlvblxuYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpe1xuICAgIHRoaXMucGFyc2VKd3QgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgICAgIH0gZWxzZSByZXR1cm4ge307XG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuID0gdG9rZW47XG4gICAgICAgIGNvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pO1xuXG5hcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
