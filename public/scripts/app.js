var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,o,n){o.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl as ctrl"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"}),n.interceptors.push("authInterceptor")}]),app.controller("editAccountCtrl",["$scope","$http","$location","$rootScope",function(e,t,o,n){e.user={},console.log(n.user),e.user=n.user;e.updateUserInfo=function(){console.log("Posting..."),t({method:"PUT",url:"/modifyUser",data:e.user,dataType:"json"}).then(function(e){console.log(e),o.path("/calculator"),alert("Your account information has been changed.")},function(e){console.log("error"),alert("There was a problem processing your changes. Please try again later.")})}}]),app.controller("adminCtrl",["$http","$scope","$parse",function(e,t,o){function n(){var o=t.csv.result;console.log(o),e.post("/bulk",o).then(function(e){return console.log(e),e.data.forEach(function(e){e.project_id=3}),e.data}).then(function(t){e.post("/project/calculation/",t)})["catch"](function(e){console.log(e)})}function r(t){var o=t.id;console.log(o),e.put("/suggestion/complete/"+o).then(function(e){a()})}function a(){e.get("/suggestion").then(function(e){var t=e.data;console.log(t),l.suggestions=t})}a();var l=this;l.suggestions="",l.markComplete=r,l.submitCSV=n,t.csv={content:null,header:!0,headerVisible:!0,separator:",",separatorVisible:!0,result:null,encoding:"ISO-8859-1",encodingVisible:!0};var i="";t.toPrettyJSON=function(e,t){var n=JSON.stringify(e),r=null;try{r=o(n)({})}catch(a){return i}var l=JSON.stringify(r,null,Number(t));return i=l,l}}]),app.controller("calculateCtrl",["$http","$mdDialog","$rootScope","authService","$location",function(e,t,o,n,r){function a(e){console.log("Text changed to ",e)}function l(e){void 0==e&&(f.category="",f.subcategory="",f.warmId="",f.weight="",f.item_description="",f.conversion="",f.result="")}function i(){var t={warmId:f.warmId||f.category.secondaries[0].warm_id,weight:parseFloat(f.weight)*f.conversion};e.post("/calculations",t).then(function(e){f.result=Math.floor(1e3*Math.abs(e.data))/1e3})}function c(){var t={category:f.category,subcategory:f.subcategory,warm_Id:f.warmId,weight:parseFloat(f.weight)*f.conversion,units:f.unit.name,item_description:f.item_description};console.log(t),e.post("/addToProject").then(function(e){console.log(e)})}function s(e){return e?f.list.filter(u(e)):f.list}function u(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function p(){e.post("/suggestion",f.suggestSubmission).then(function(e){t.hide()})}function h(e){t.show({templateUrl:"/views/suggest-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:f.searchText}})}function d(){f.projectSubmission.user_id=o.user.id,e.post("/project",f.projectSubmission).then(function(e){t.hide()})}function g(e){t.show({templateUrl:"views/project-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl"})}o.user=n.getUser(),o.user&&o.user.username&&r.path("/"),e.get("/materials").then(function(e){var t=e.data;t.forEach(function(e){e.primary_cat=e.primary_cat.toLowerCase()}),f.list=t});var f=this;f.list="",f.isDisabled=!1,f.result="",f.querySearch=s,f.selectedItemChange=l,f.searchTextChange=a,f.newSuggestion=h,f.submitSuggestion=p,f.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],f.submission={email:"",material:"",notes:""},f.newCalculation=i,f.saveToProject=c,f.newProject=g,f.createProject=d}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(e,t,o){e.user={},e.processForm=function(n){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),o.path("/login"),alert("Your account has been created.")})}}]),app.directive("ngCsvImport",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{content:"=?",header:"=?",headerVisible:"=?",separator:"=?",separatorVisible:"=?",result:"=?",encoding:"=?",encodingVisible:"=?"},template:'<div><div ng-show="headerVisible"><div class="label">Header</div><input type="checkbox" ng-model="header"></div><div ng-show="encoding && encodingVisible"><div class="label">Encoding</div><span>{{encoding}}</span></div><div ng-show="separator && separatorVisible"><div class="label">Seperator</div><span><input class="separator-input" type="text" ng-change="changeSeparator" ng-model="separator"><span></div><div><input class="btn cta gray" type="file"/></div></div>',link:function(e,t){e.separatorVisible=e.separatorVisible||!1,e.headerVisible=e.headerVisible||!1,angular.element(t[0].querySelector(".separator-input")).on("keyup",function(t){if(null!=e.content){var n={csv:e.content,header:e.header,separator:t.target.value,encoding:e.encoding};e.result=o(n),e.$apply()}}),t.on("change",function(t){var n=new FileReader;if(e.filename=t.target.files[0].name,n.onload=function(t){e.$apply(function(){var n={csv:t.target.result.replace(/\r\n|\r/g,"\n"),header:e.header,separator:e.separator};e.content=n.csv,e.result=o(n),e.result.filename=e.filename})},"file"!==t.target.type||null==t.target.files&&null==t.srcElement.files){if(null!=e.content){var r={csv:e.content,header:!e.header,separator:e.separator};e.result=o(r)}}else n.readAsText((t.srcElement||t.target).files[0],e.encoding)});var o=function(e){var t=e.csv.split("\n"),o=[],n=0,r=t[0].split(e.separator).length,a=[];e.header&&(a=t[0].split(e.separator),n=1);for(var l=n;l<t.length;l++){var i={},c=t[l].split(new RegExp(e.separator+'(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)'));if(c.length===r){if(e.header)for(var s=0;s<a.length;s++)i[a[s]]=c[s];else for(var u=0;u<c.length;u++)i[u]=c[u];o.push(i)}}return o}}}}),app.controller("dashboardCtrl",["$mdDialog","$rootScope","$scope","$http",function(e,t,o,n){var r=t.user;n.get("/project/"+r.id).then(function(e){o.projectList=e.data}),o.showDelete=function(t){console.log("CLICK");var n=e.confirm().title("Are you sure you want to remove your project?").content("This is permanent.").ariaLabel("Remove project from account permanently").ok("Delete").cancel("Cancel").targetEvent(t);e.show(n).then(function(){o.alert="Your project has been removed."},function(){o.alert="Your project has not been removed."})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(e,t,o,n,r){e.login=function(){t({method:"POST",url:"/login",data:e.form}).then(function(e){o.saveToken(e.data.token),r.user=o.getUser(),n.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,o,n,r){o.user=e.getUser(),o.user&&o.user.username&&n.path("/"),t.logout=function(){e.logout(),o.user=e.getUser(),n.path("/")}}]),app.controller("projectsCtrl",["$mdDialog","$scope","$rootScope","$http",function(e,t,o,n){function r(){n.get("/project/?user_id="+o.user.id).then(function(e){console.log(e);var t=[];e.data[0].project_name;e.data.forEach(function(e){}),console.log(t)})}function a(e){return e?u.projectList.filter(l(e)):u.projectList}function l(e){var t=e.toLowerCase();return function(e){return-1!=e.project_name.indexOf(t)}}function i(e){console.log("Text changed to ",e)}function c(e){console.log("item",e),console.log("selected_ project",u.selected_project),void 0==e&&(u.selected_project="",u.project_description="")}function s(e){console.log("Deleting...",e)}var u=this;u.projectList="",u.result="",u.querySearch=a,u.selectedItemChange=c,u.searchTextChange=i,u.projectTotal=0,u.deleteProjectItem=s,u.id=0,r(),t.showDelete=function(o,n){console.log("CLICK");var r=e.confirm().title("Are you sure you want to delete this item?").content("This will be permanent.").ariaLabel("Delete item permanently").ok("Delete").cancel("Cancel").targetEvent(o);e.show(r).then(function(){console.log("Deleting",n),u.deleteProjectItem(n),t.alert="Your item has been deleted."},function(){t.alert="Your item has not been deleted."})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],n=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(n))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzY3JpcHRzL2FjY291bnRDdHJsLmpzIiwic2NyaXB0cy9hZG1pbkN0cmwuanMiLCJzY3JpcHRzL2NhbGN1bGF0ZUN0cmwuanMiLCJzY3JpcHRzL2NyZWF0ZUFjY291bnRDdHJsLmpzIiwic2NyaXB0cy9jc3ZJbXBvcnQuanMiLCJzY3JpcHRzL2Rhc2hib2FyZEN0cmwuanMiLCJzY3JpcHRzL2xvZ2luQ3RybC5qcyIsInNjcmlwdHMvbmF2Q3RybC5qcyIsInNjcmlwdHMvcHJvamVjdHNDdHJsLmpzIiwic2NyaXB0cy9zZXJ2aWNlcy5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIiRodHRwUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsImRlZmF1bHQiLCJ3YXJuUGFsZXR0ZSIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaW50ZXJjZXB0b3JzIiwicHVzaCIsIiRzY29wZSIsIiRodHRwIiwiJGxvY2F0aW9uIiwiJHJvb3RTY29wZSIsInVzZXIiLCJjb25zb2xlIiwibG9nIiwidXBkYXRlVXNlckluZm8iLCJtZXRob2QiLCJ1cmwiLCJkYXRhIiwiZGF0YVR5cGUiLCJ0aGVuIiwicmVzcG9uc2UiLCJwYXRoIiwiYWxlcnQiLCJlcnJvciIsIiRwYXJzZSIsInN1Ym1pdENTViIsImNzdk9iamVjdCIsImNzdiIsInJlc3VsdCIsInBvc3QiLCJyZXMiLCJmb3JFYWNoIiwiaXRlbSIsInByb2plY3RfaWQiLCJwcm9qZWN0cyIsImVyciIsIm1hcmtDb21wbGV0ZSIsInN1Z2dlc3Rpb24iLCJpZCIsInB1dCIsImluaXQiLCJnZXQiLCJzdWdnZXN0aW9ucyIsInNlbGYiLCJ0aGlzIiwiY29udGVudCIsImhlYWRlciIsImhlYWRlclZpc2libGUiLCJzZXBhcmF0b3IiLCJzZXBhcmF0b3JWaXNpYmxlIiwiZW5jb2RpbmciLCJlbmNvZGluZ1Zpc2libGUiLCJfbGFzdEdvb2RSZXN1bHQiLCJ0b1ByZXR0eUpTT04iLCJqc29uIiwidGFiV2lkdGgiLCJvYmpTdHIiLCJKU09OIiwic3RyaW5naWZ5Iiwib2JqIiwiZSIsIk51bWJlciIsIiRtZERpYWxvZyIsImF1dGhTZXJ2aWNlIiwic2VhcmNoVGV4dENoYW5nZSIsInRleHQiLCJzZWxlY3RlZEl0ZW1DaGFuZ2UiLCJ1bmRlZmluZWQiLCJjYXRlZ29yeSIsInN1YmNhdGVnb3J5Iiwid2FybUlkIiwid2VpZ2h0IiwiaXRlbV9kZXNjcmlwdGlvbiIsImNvbnZlcnNpb24iLCJuZXdDYWxjdWxhdGlvbiIsImNhbGN1bGF0ZSIsInNlY29uZGFyaWVzIiwid2FybV9pZCIsInBhcnNlRmxvYXQiLCJNYXRoIiwiZmxvb3IiLCJhYnMiLCJzYXZlVG9Qcm9qZWN0IiwibGluZUl0ZW0iLCJ3YXJtX0lkIiwidW5pdHMiLCJ1bml0IiwibmFtZSIsInF1ZXJ5U2VhcmNoIiwicXVlcnkiLCJsaXN0IiwiZmlsdGVyIiwiY3JlYXRlRmlsdGVyRm9yIiwibG93ZXJjYXNlUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsInByaW1hcnlfY2F0IiwiaW5kZXhPZiIsInN1Ym1pdFN1Z2dlc3Rpb24iLCJzdWdnZXN0U3VibWlzc2lvbiIsImhpZGUiLCJuZXdTdWdnZXN0aW9uIiwic2hvdyIsImNsaWNrT3V0c2lkZVRvQ2xvc2UiLCJjb250cm9sbGVyQXMiLCJsb2NhbHMiLCJtYXRlcmlhbCIsInNlYXJjaFRleHQiLCJjcmVhdGVQcm9qZWN0IiwicHJvamVjdFN1Ym1pc3Npb24iLCJ1c2VyX2lkIiwibmV3UHJvamVjdCIsImdldFVzZXIiLCJ1c2VybmFtZSIsImlzRGlzYWJsZWQiLCJzdWJtaXNzaW9uIiwiZW1haWwiLCJub3RlcyIsInByb2Nlc3NGb3JtIiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJ0cmFuc2NsdWRlIiwicmVwbGFjZSIsInNjb3BlIiwidGVtcGxhdGUiLCJsaW5rIiwiZWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJvbiIsInRhcmdldCIsInZhbHVlIiwiY3N2VG9KU09OIiwiJGFwcGx5Iiwib25DaGFuZ2VFdmVudCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJmaWxlbmFtZSIsImZpbGVzIiwib25sb2FkIiwib25Mb2FkRXZlbnQiLCJ0eXBlIiwic3JjRWxlbWVudCIsInJlYWRBc1RleHQiLCJsaW5lcyIsInNwbGl0Iiwic3RhcnQiLCJjb2x1bW5Db3VudCIsImxlbmd0aCIsImhlYWRlcnMiLCJpIiwiY3VycmVudGxpbmUiLCJSZWdFeHAiLCJqIiwiayIsInByb2plY3RMaXN0Iiwic2hvd0RlbGV0ZSIsImV2IiwiY29uZmlybSIsInRpdGxlIiwiYXJpYUxhYmVsIiwib2siLCJjYW5jZWwiLCJ0YXJnZXRFdmVudCIsImxvZ2luIiwiZm9ybSIsInNhdmVUb2tlbiIsInRva2VuIiwibG9nb3V0IiwiZ2V0UHJvamVjdExpc3QiLCJwcm9qZWN0X25hbWUiLCJzZWxlY3RlZF9wcm9qZWN0IiwicHJvamVjdF9kZXNjcmlwdGlvbiIsImRlbGV0ZVByb2plY3RJdGVtIiwicHJvamVjdFRvdGFsIiwic2VydmljZSIsIiR3aW5kb3ciLCJwYXJzZUp3dCIsImJhc2U2NFVybCIsImJhc2U2NCIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiZ2V0VG9rZW4iLCJpc0F1dGhlZCIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwiZmFjdG9yeSIsIiRxIiwicmVxdWVzdCIsIkF1dGhvcml6YXRpb24iLCJzdGF0dXMiLCJyZXNwb25zZUVycm9yIiwicmVqZWN0Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxLQUFBQyxRQUFBQyxPQUFBLGNBQUEsVUFBQSxhQUFBLGFBQUEsb0JBRUFGLEtBQUFHLFFBQUEscUJB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LEdBQ0EsT0FDQWlJLFFBQUEsU0FBQTNNLEdBS0EsTUFKQUEsR0FBQThKLFFBQUE5SixFQUFBOEosWUFDQXBGLEVBQUF3SCxhQUNBbE0sRUFBQThKLFFBQUE4QyxjQUFBLFVBQUFsSSxFQUFBdUgsWUFFQWpNLEdBRUErQixTQUFBLFNBQUFBLEdBT0EsTUFMQSxPQUFBQSxFQUFBOEssUUFHQXpMLEVBQUFZLEtBQUEsVUFFQUQsR0FBQTJLLEVBQUEvTCxLQUFBb0IsSUFDQStLLGNBQUEsU0FBQS9LLEdBT0EsTUFOQSxPQUFBQSxFQUFBOEssT0FDQXpMLEVBQUFZLEtBQUEsVUFHQVQsUUFBQUMsSUFBQU8sR0FFQTJLLEVBQUFLLE9BQUFoTCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdlY290b25lQXBwJywgWyduZ1JvdXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcycsICd2YWxpZGF0aW9uLm1hdGNoJ10pO1xuXG5hcHAuY29uZmlnKFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywgJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJGh0dHBQcm92aWRlcil7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy9zZXQgdGhlbWUgYW5kIGNvbG9yIHBhbGV0dGVcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2dyZWVuJylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2JsdWUtZ3JleScsIHsnZGVmYXVsdCc6JzYwMCd9KVxuICAgICAgICAud2FyblBhbGV0dGUgKCdvcmFuZ2UnKTtcblxuICAgIC8vcm91dGVzIGZvciB2aWV3c1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jYWxjdWxhdG9yLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhbGN1bGF0ZUN0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FkbWluJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWRtaW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWRtaW5DdHJsIGFzIGN0cmwnXG5cbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkYXNoYm9hcmRDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvcHJvamVjdHMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcm9qZWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RzQ3RybCBhcyBjdHJsJ1xuICAgICAgICB9KS53aGVuKCcvc291cmNlcycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3NvdXJjZXMuaHRtbCdcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgICAgICB9KTtcblxuICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xufV0pOyIsIlxuLy8gRWRpdCBhY2NvdW50IGluZm8gSFRNTCAtIEtpbVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRBY2NvdW50Q3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcbiAgICBjb25zb2xlLmxvZygkcm9vdFNjb3BlLnVzZXIpO1xuICAgICRzY29wZS51c2VyID0gJHJvb3RTY29wZS51c2VyO1xuICAgIHZhciBpbmZvVG9VcGRhdGU7XG5cbiAgICAkc2NvcGUudXBkYXRlVXNlckluZm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIHVybDogJy9tb2RpZnlVc2VyJyxcbiAgICAgICAgICAgIGRhdGE6ICRzY29wZS51c2VyLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9jYWxjdWxhdG9yJyk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBpbmZvcm1hdGlvbiBoYXMgYmVlbiBjaGFuZ2VkLlwiKVxuICAgICAgICB9LCBmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InKTtcbiAgICAgICAgICAgIGFsZXJ0KFwiVGhlcmUgd2FzIGEgcHJvYmxlbSBwcm9jZXNzaW5nIHlvdXIgY2hhbmdlcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIilcbiAgICAgICAgfSk7XG4gICAgfTtcbn1dKTsiLCIvKipcbiAqIEFETUlOXG4gKi9cbmFwcC5jb250cm9sbGVyKCdhZG1pbkN0cmwnLCBbJyRodHRwJywgJyRzY29wZScsJyRwYXJzZScsIGZ1bmN0aW9uKCAkaHR0cCwgJHNjb3BlLCAkcGFyc2UgKXtcbiAgICAvLyBJTklUXG4gICAgaW5pdCgpO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuc3VnZ2VzdGlvbnMgPSAnJztcbiAgICBzZWxmLm1hcmtDb21wbGV0ZSA9IG1hcmtDb21wbGV0ZTtcbiAgICBzZWxmLnN1Ym1pdENTViA9IHN1Ym1pdENTVjtcblxuICAgIGZ1bmN0aW9uIHN1Ym1pdENTViggKXtcbiAgICAgICAgdmFyIGNzdk9iamVjdCA9ICRzY29wZS5jc3YucmVzdWx0O1xuICAgICAgICBjb25zb2xlLmxvZyhjc3ZPYmplY3QpO1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9idWxrJywgY3N2T2JqZWN0KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oIHJlcyApe1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTtcbiAgICAgICAgICAgICAgICByZXMuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnByb2plY3RfaWQgPSAzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5kYXRhfSlcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCBwcm9qZWN0cyApIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvcHJvamVjdC9jYWxjdWxhdGlvbi8nLCBwcm9qZWN0cylcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFya0NvbXBsZXRlKCBzdWdnZXN0aW9uICkge1xuICAgICAgICB2YXIgaWQgPSBzdWdnZXN0aW9uLmlkO1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgICAgICRodHRwLnB1dCgnL3N1Z2dlc3Rpb24vY29tcGxldGUvJyArIGlkKS50aGVuKGZ1bmN0aW9uKCByZXMgKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRodHRwLmdldCgnL3N1Z2dlc3Rpb24nKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIHZhciBzdWdnZXN0aW9ucyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgc2VsZi5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuY3N2ID0ge1xuICAgICAgICBjb250ZW50OiBudWxsLFxuICAgICAgICBoZWFkZXI6IHRydWUsXG4gICAgICAgIGhlYWRlclZpc2libGU6IHRydWUsXG4gICAgICAgIHNlcGFyYXRvcjogJywnLFxuICAgICAgICBzZXBhcmF0b3JWaXNpYmxlOiB0cnVlLFxuICAgICAgICByZXN1bHQ6IG51bGwsXG4gICAgICAgIGVuY29kaW5nOiAnSVNPLTg4NTktMScsXG4gICAgICAgIGVuY29kaW5nVmlzaWJsZTogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdmFyIF9sYXN0R29vZFJlc3VsdCA9ICcnO1xuICAgICRzY29wZS50b1ByZXR0eUpTT04gPSBmdW5jdGlvbiAoanNvbiwgdGFiV2lkdGgpIHtcbiAgICAgICAgdmFyIG9ialN0ciA9IEpTT04uc3RyaW5naWZ5KGpzb24pO1xuICAgICAgICB2YXIgb2JqID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9iaiA9ICRwYXJzZShvYmpTdHIpKHt9KTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIGVhdCAkcGFyc2UgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBfbGFzdEdvb2RSZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkob2JqLCBudWxsLCBOdW1iZXIodGFiV2lkdGgpKTtcbiAgICAgICAgX2xhc3RHb29kUmVzdWx0ID0gcmVzdWx0O1xuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxufV0pOyIsImFwcC5jb250cm9sbGVyKCdjYWxjdWxhdGVDdHJsJywgWyckaHR0cCcsICckbWREaWFsb2cnLCAnJHJvb3RTY29wZScsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCBmdW5jdGlvbiggJGh0dHAsICRtZERpYWxvZywgJHJvb3RTY29wZSwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiApIHtcblxuICAgIC8vIENoZWNrIHVzZXJcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG5cbiAgICAvLyBJTklUXG4gICAgJGh0dHAuZ2V0KCcvbWF0ZXJpYWxzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICB2YXIgbGlzdCA9IHJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIC8vIC9pdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGl0ZW0ucHJpbWFyeV9jYXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5saXN0ID0gbGlzdDtcblxuICAgIH0pO1xuXG4gICAgLy8gU2VsZiBkZWNcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBzZWxmLmxpc3QgPSAnJztcbiAgICBzZWxmLmlzRGlzYWJsZWQgPSBmYWxzZTtcbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgICA9IHNlYXJjaFRleHRDaGFuZ2U7XG4gICAgc2VsZi5uZXdTdWdnZXN0aW9uID0gbmV3U3VnZ2VzdGlvbjtcbiAgICBzZWxmLnN1Ym1pdFN1Z2dlc3Rpb24gPSBzdWJtaXRTdWdnZXN0aW9uO1xuICAgIHNlbGYudW5pdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDA1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdraWxvcycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMTEwMjMxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ21ldHJpYyB0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDEuMTAyMzFcbiAgICAgICAgfVxuICAgIF07XG4gICAgc2VsZi5zdWJtaXNzaW9uID0ge1xuICAgICAgICBlbWFpbDogJycsXG4gICAgICAgIG1hdGVyaWFsOiAnJyxcbiAgICAgICAgbm90ZXM6ICcnXG4gICAgfTtcbiAgICBzZWxmLm5ld0NhbGN1bGF0aW9uID0gbmV3Q2FsY3VsYXRpb247XG4gICAgc2VsZi5zYXZlVG9Qcm9qZWN0ID0gc2F2ZVRvUHJvamVjdDtcbiAgICBzZWxmLm5ld1Byb2plY3QgPSBuZXdQcm9qZWN0O1xuICAgIHNlbGYuY3JlYXRlUHJvamVjdCA9IGNyZWF0ZVByb2plY3Q7XG5cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLnN1YmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLndhcm1JZCA9ICcnO1xuICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAnJztcbiAgICAgICAgICAgIHNlbGYuaXRlbV9kZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICAgICAgc2VsZi5jb252ZXJzaW9uID0gJyc7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3Q2FsY3VsYXRpb24oKSB7XG5cbiAgICAgICAgdmFyIGNhbGN1bGF0ZSA9IHtcbiAgICAgICAgICAgIHdhcm1JZDogc2VsZi53YXJtSWQgfHwgc2VsZi5jYXRlZ29yeS5zZWNvbmRhcmllc1swXS53YXJtX2lkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSAqIHNlbGYuY29udmVyc2lvblxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9jYWxjdWxhdGlvbnMnLCBjYWxjdWxhdGUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHNlbGYucmVzdWx0ID0gTWF0aC5mbG9vcihNYXRoLmFicyhyZXNwb25zZS5kYXRhKSAqIDEwMDApIC8gMTAwMDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVRvUHJvamVjdCgpe1xuICAgICAgICB2YXIgbGluZUl0ZW0gPSB7XG4gICAgICAgICAgICBjYXRlZ29yeTogc2VsZi5jYXRlZ29yeSxcbiAgICAgICAgICAgIHN1YmNhdGVnb3J5OiBzZWxmLnN1YmNhdGVnb3J5LFxuICAgICAgICAgICAgd2FybV9JZDogc2VsZi53YXJtSWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoc2VsZi53ZWlnaHQpKnNlbGYuY29udmVyc2lvbixcbiAgICAgICAgICAgIHVuaXRzOiBzZWxmLnVuaXQubmFtZSxcbiAgICAgICAgICAgIGl0ZW1fZGVzY3JpcHRpb246IHNlbGYuaXRlbV9kZXNjcmlwdGlvblxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhsaW5lSXRlbSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9hZGRUb1Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYubGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiBzZWxmLmxpc3Q7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmoucHJpbWFyeV9jYXQuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFN1Z2dlc3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnL3N1Z2dlc3Rpb24nLCBzZWxmLnN1Z2dlc3RTdWJtaXNzaW9uKS50aGVuKGZ1bmN0aW9uKCByZXMgKXtcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld1N1Z2dlc3Rpb24oIHN1Z2dlc3Rpb24gKXtcblxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zdWdnZXN0LW1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgICAgICAgICAgbG9jYWxzOiB7bWF0ZXJpYWw6IHNlbGYuc2VhcmNoVGV4dH1cbiAgICAgICAgfSlcblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QoKSB7XG4gICAgICAgIHNlbGYucHJvamVjdFN1Ym1pc3Npb24udXNlcl9pZCA9ICRyb290U2NvcGUudXNlci5pZDtcblxuICAgICAgICAkaHR0cC5wb3N0KCcvcHJvamVjdCcsIHNlbGYucHJvamVjdFN1Ym1pc3Npb24pLnRoZW4oZnVuY3Rpb24ocmVzKXtcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3UHJvamVjdCggbmV3UHJvamVjdCApe1xuXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcHJvamVjdC1tb2RhbC5odG1sJyxcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICdjdHJsJ1xuICAgICAgICB9KVxuXG4gICAgfVxuXG59XSk7IiwiLy8gUmVnaXN0ZXIgSFRNTCAtIE1hZGVsaW5lXG5hcHAuY29udHJvbGxlcignY3JlYXRlQWNjb3VudEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICckbG9jYXRpb24nLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUudXNlciA9IHt9O1xuXG4gICAgJHNjb3BlLnByb2Nlc3NGb3JtID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJQb3N0aW5nLi4uXCIpO1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUudXNlcixcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICAgICAgICAgIGFsZXJ0KFwiWW91ciBhY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQuXCIpXG4gICAgICAgIH0pXG4gICAgfTtcbn1dKTsiLCJhcHAuZGlyZWN0aXZlKCduZ0NzdkltcG9ydCcsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHRyYW5zY2x1ZGU6IHRydWUsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIHNjb3BlOntcbiAgICAgICAgICAgIGNvbnRlbnQ6Jz0/JyxcbiAgICAgICAgICAgIGhlYWRlcjogJz0/JyxcbiAgICAgICAgICAgIGhlYWRlclZpc2libGU6ICc9PycsXG4gICAgICAgICAgICBzZXBhcmF0b3I6ICc9PycsXG4gICAgICAgICAgICBzZXBhcmF0b3JWaXNpYmxlOiAnPT8nLFxuICAgICAgICAgICAgcmVzdWx0OiAnPT8nLFxuICAgICAgICAgICAgZW5jb2Rpbmc6ICc9PycsXG4gICAgICAgICAgICBlbmNvZGluZ1Zpc2libGU6ICc9PydcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2PjxkaXYgbmctc2hvdz1cImhlYWRlclZpc2libGVcIj48ZGl2IGNsYXNzPVwibGFiZWxcIj5IZWFkZXI8L2Rpdj48aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgbmctbW9kZWw9XCJoZWFkZXJcIj48L2Rpdj4nK1xuICAgICAgICAnPGRpdiBuZy1zaG93PVwiZW5jb2RpbmcgJiYgZW5jb2RpbmdWaXNpYmxlXCI+PGRpdiBjbGFzcz1cImxhYmVsXCI+RW5jb2Rpbmc8L2Rpdj48c3Bhbj57e2VuY29kaW5nfX08L3NwYW4+PC9kaXY+JytcbiAgICAgICAgJzxkaXYgbmctc2hvdz1cInNlcGFyYXRvciAmJiBzZXBhcmF0b3JWaXNpYmxlXCI+PGRpdiBjbGFzcz1cImxhYmVsXCI+U2VwZXJhdG9yPC9kaXY+PHNwYW4+PGlucHV0IGNsYXNzPVwic2VwYXJhdG9yLWlucHV0XCIgdHlwZT1cInRleHRcIiBuZy1jaGFuZ2U9XCJjaGFuZ2VTZXBhcmF0b3JcIiBuZy1tb2RlbD1cInNlcGFyYXRvclwiPjxzcGFuPjwvZGl2PicrXG4gICAgICAgICc8ZGl2PjxpbnB1dCBjbGFzcz1cImJ0biBjdGEgZ3JheVwiIHR5cGU9XCJmaWxlXCIvPjwvZGl2PjwvZGl2PicsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50KSB7XG4gICAgICAgICAgICBzY29wZS5zZXBhcmF0b3JWaXNpYmxlID0gc2NvcGUuc2VwYXJhdG9yVmlzaWJsZSB8fCBmYWxzZTtcbiAgICAgICAgICAgIHNjb3BlLmhlYWRlclZpc2libGUgPSBzY29wZS5oZWFkZXJWaXNpYmxlIHx8IGZhbHNlO1xuXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcuc2VwYXJhdG9yLWlucHV0JykpLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIHNjb3BlLmNvbnRlbnQgIT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjc3Y6IHNjb3BlLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IHNjb3BlLmhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcGFyYXRvcjogZS50YXJnZXQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGluZzogc2NvcGUuZW5jb2RpbmdcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0ID0gY3N2VG9KU09OKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZWxlbWVudC5vbignY2hhbmdlJywgZnVuY3Rpb24ob25DaGFuZ2VFdmVudCkge1xuICAgICAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgICAgICAgIHNjb3BlLmZpbGVuYW1lID0gb25DaGFuZ2VFdmVudC50YXJnZXQuZmlsZXNbMF0ubmFtZTtcbiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24ob25Mb2FkRXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3N2OiBvbkxvYWRFdmVudC50YXJnZXQucmVzdWx0LnJlcGxhY2UoL1xcclxcbnxcXHIvZywnXFxuJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBzY29wZS5oZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VwYXJhdG9yOiBzY29wZS5zZXBhcmF0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jb250ZW50ID0gY29udGVudC5jc3Y7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQgPSBjc3ZUb0pTT04oY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQuZmlsZW5hbWUgPSBzY29wZS5maWxlbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICggKG9uQ2hhbmdlRXZlbnQudGFyZ2V0LnR5cGUgPT09IFwiZmlsZVwiKSAmJiAob25DaGFuZ2VFdmVudC50YXJnZXQuZmlsZXMgIT0gbnVsbCB8fCBvbkNoYW5nZUV2ZW50LnNyY0VsZW1lbnQuZmlsZXMgIT0gbnVsbCkgKSAge1xuICAgICAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzVGV4dCgob25DaGFuZ2VFdmVudC5zcmNFbGVtZW50IHx8IG9uQ2hhbmdlRXZlbnQudGFyZ2V0KS5maWxlc1swXSwgc2NvcGUuZW5jb2RpbmcpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggc2NvcGUuY29udGVudCAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3N2OiBzY29wZS5jb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogIXNjb3BlLmhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXBhcmF0b3I6IHNjb3BlLnNlcGFyYXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VsdCA9IGNzdlRvSlNPTihjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgY3N2VG9KU09OID0gZnVuY3Rpb24oY29udGVudCkge1xuICAgICAgICAgICAgICAgIHZhciBsaW5lcz1jb250ZW50LmNzdi5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkNvdW50ID0gbGluZXNbMF0uc3BsaXQoY29udGVudC5zZXBhcmF0b3IpLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQuaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM9bGluZXNbMF0uc3BsaXQoY29udGVudC5zZXBhcmF0b3IpO1xuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IDE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaT1zdGFydDsgaTxsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50bGluZT1saW5lc1tpXS5zcGxpdChuZXcgUmVnRXhwKGNvbnRlbnQuc2VwYXJhdG9yKycoPyFbXlwiXSpcIig/Oig/OlteXCJdKlwiKXsyfSkqW15cIl0qJCknKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICggY3VycmVudGxpbmUubGVuZ3RoID09PSBjb2x1bW5Db3VudCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50LmhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGo9MDsgajxoZWFkZXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtoZWFkZXJzW2pdXSA9IGN1cnJlbnRsaW5lW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaz0wOyBrPGN1cnJlbnRsaW5lLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtrXSA9IGN1cnJlbnRsaW5lW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9fSk7IiwiYXBwLmNvbnRyb2xsZXIoJ2Rhc2hib2FyZEN0cmwnLCBbJyRtZERpYWxvZycsICckcm9vdFNjb3BlJywgJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRtZERpYWxvZywgJHJvb3RTY29wZSwgJHNjb3BlLCAkaHR0cCkge1xuICAgIHZhciB1c2VyPSRyb290U2NvcGUudXNlcjtcblxuXG4gICAgLy9sb2FkIHByb2plY3QgbGlzdCBvbiBwYWdlIGxvYWRcbiAgICAkaHR0cC5nZXQoJy9wcm9qZWN0LycgKyB1c2VyLmlkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICRzY29wZS5wcm9qZWN0TGlzdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgIC8vcmVzcG9uc2UuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAvLyAgICBpdGVtLnByb2plY3RfbmFtZSA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcbi8vdGhpcyBpcyBmb3IgdGhlIHJlbW92ZSBwcm9qZWN0IG1vZGFsIGFsZXJ0IGZvciByZW1vdmluZyBhIHByb2plY3QsIGRhdGEgd2lsbCBzdGlsbCBiZSBpbiBkYXRhYmFzZS0tIHN0aWxsIG5vdCB3b3JraW5nIGNvcnJlY3RcblxuICAgICRzY29wZS5zaG93RGVsZXRlID0gZnVuY3Rpb24oZXYpIHtcblxuICAgICAgICBjb25zb2xlLmxvZygnQ0xJQ0snKTtcbiAgICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXG4gICAgICAgICAgICAudGl0bGUoJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmUgeW91ciBwcm9qZWN0PycpXG4gICAgICAgICAgICAuY29udGVudCgnVGhpcyBpcyBwZXJtYW5lbnQuJylcbiAgICAgICAgICAgIC5hcmlhTGFiZWwoJ1JlbW92ZSBwcm9qZWN0IGZyb20gYWNjb3VudCBwZXJtYW5lbnRseScpXG4gICAgICAgICAgICAub2soJ0RlbGV0ZScpXG4gICAgICAgICAgICAuY2FuY2VsKCdDYW5jZWwnKVxuICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIHByb2plY3QgaGFzIGJlZW4gcmVtb3ZlZC4nO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIHByb2plY3QgaGFzIG5vdCBiZWVuIHJlbW92ZWQuJztcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vbmVlZCB0byBjaGVjayBpZiB3ZSBuZWVkIHRoaXMhXG4vLyAgICBmdW5jdGlvbiBEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4vLyAgICAkc2NvcGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuYW5zd2VyID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbi8vICAgIH07XG4vL31cblxufV0pOyIsIi8vIExvZ2luIEhUTUwgLSBLYXRlXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUuZm9ybVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhLnRva2VuKTtcbiAgICAgICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgIH0pXG4gICAgfVxufV0pOyIsIi8vIENoYW5nZSBOYXZpZ2F0aW9uIE9wdGlvbnMgd2l0aCBMb2dpblxuYXBwLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBbJ2F1dGhTZXJ2aWNlJywgJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICckaHR0cCcsIGZ1bmN0aW9uKGF1dGhTZXJ2aWNlLCAkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJGh0dHApe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cbn1dKTtcbiIsIi8vIFByb2plY3QgUGFnZSAtICBLaW0vTWFkZWxlaW5lXG5hcHAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckbWREaWFsb2cnLCAnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkbWREaWFsb2csICRzY29wZSwgJHJvb3RTY29wZSwgJGh0dHApIHtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYucHJvamVjdExpc3QgPSAnJztcbiAgICAgICAgLy9bXG4gICAgICAgIC8vICAgICAgICB7XG4gICAgICAgIC8vICAgICAgICAgICAgaWQ6IDIxLFxuICAgICAgICAvLyAgICAgICAgICAgIHByb2plY3RfbmFtZTogXCJiZW4ncyBob3VzZVwiLFxuICAgICAgICAvLyAgICAgICAgICAgIHByb2plY3RfZGVzY3JpcHRpb246IFwiUmVtb2RlbFwiLFxuICAgICAgICAvLyAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IFwiMjAxNS0xMC0xNFQxNjo0Mjo0MC44OTZaXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgdXBkYXRlZF9hdDogXCIyMDE1LTEwLTE0VDE2OjQyOjQwLjkwMVpcIixcbiAgICAgICAgLy8gICAgICAgICAgICB1c2VyX2lkOiA0LFxuICAgICAgICAvLyAgICAgICAgICAgIGNhdGVnb3J5OiBcIndvb2RcIixcbiAgICAgICAgLy8gICAgICAgICAgICBzdWJfY2F0ZWdvcnk6IFwib2FrXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgdW5pdHM6IFwibGJzXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgd2VpZ2h0OiAxMCxcbiAgICAgICAgLy8gICAgICAgICAgICBjbzJfb2Zmc2V0OiAwLjAzLFxuICAgICAgICAvLyAgICAgICAgICAgIHByb2plY3RfaWQ6IDYsXG4gICAgICAgIC8vICAgICAgICAgICAgaXRlbV9kZXNjcmlwdGlvbjogXCJwb3JjaCBzcGluZGxlc1wiXG4gICAgICAgIC8vICAgICAgICB9LFxuICAgICAgICAvLyAgICAgICAge1xuICAgICAgICAvLyAgICAgICAgICAgIGlkOiAyMDIsXG4gICAgICAgIC8vICAgICAgICAgICAgcHJvamVjdF9uYW1lOiBcImphbWVzJyBob3VzZVwiLFxuICAgICAgICAvLyAgICAgICAgICAgIHByb2plY3RfZGVzY3JpcHRpb246IFwiU3VtbWl0IEF2ZSBjYXJyaWFnZSBob3VzZSB0ZWFyZG93biBhbmQgcmVidWlsZFwiLFxuICAgICAgICAvLyAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IFwiMjAxNC0xMC0xNFQxNjo0Mjo0MC44OTZaXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgdXBkYXRlZF9hdDogXCIyMDE0LTEwLTE0VDE2OjQyOjQwLjkwMVpcIixcbiAgICAgICAgLy8gICAgICAgICAgICB1c2VyX2lkOiAyNCxcbiAgICAgICAgLy8gICAgICAgICAgICBjYXRlZ29yeTogXCJhc3BoYWx0IHNoaW5nbGVzXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgc3ViX2NhdGVnb3J5OiBcIm51bGxcIixcbiAgICAgICAgLy8gICAgICAgICAgICB1bml0czogXCJsYnNcIixcbiAgICAgICAgLy8gICAgICAgICAgICB3ZWlnaHQ6IDEwMCxcbiAgICAgICAgLy8gICAgICAgICAgICBjbzJfb2Zmc2V0OiAwLjMwMyxcbiAgICAgICAgLy8gICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgICAgICAvLyAgICAgICAgICAgIGl0ZW1fZGVzY3JpcHRpb246IFwiZGFyayBicm93biByb29mIHNoaW5nbGVzLS0zMCB5ZWFyIGxpZmUsIHNvbWUgd2F0ZXIgZGFtYWdlXCJcbiAgICAgICAgLy8gICAgICAgIH0sXG4gICAgICAgIC8vICAgICAgICB7XG4gICAgICAgIC8vICAgICAgICAgICAgaWQ6IDIxMTIsXG4gICAgICAgIC8vICAgICAgICAgICAgcHJvamVjdF9uYW1lOiBcImtpbSdzIGJhcm5cIixcbiAgICAgICAgLy8gICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlJlbW9kZWxcIixcbiAgICAgICAgLy8gICAgICAgICAgICBjcmVhdGVkX2F0OiBcIjIwMTMtMTAtMTRUMTY6NDI6NDAuODk2WlwiLFxuICAgICAgICAvLyAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IFwiMjAxMy0xMC0xNFQxNjo0Mjo0MC45MDFaXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgdXNlcl9pZDogMTQsXG4gICAgICAgIC8vICAgICAgICAgICAgY2F0ZWdvcnk6IFwid29vZCBmbG9vcmluZ1wiLFxuICAgICAgICAvLyAgICAgICAgICAgIHN1Yl9jYXRlZ29yeTogXCJwaW5lXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgdW5pdHM6IFwibGJzXCIsXG4gICAgICAgIC8vICAgICAgICAgICAgd2VpZ2h0OiA1MDAsXG4gICAgICAgIC8vICAgICAgICAgICAgY28yX29mZnNldDogMy4wMyxcbiAgICAgICAgLy8gICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgICAgICAvLyAgICAgICAgICAgIGl0ZW1fZGVzY3JpcHRpb246IFwiYmFybiB3b29kXCJcbiAgICAgICAgLy8gICAgICAgIH1dO1xuXG4gICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICBzZWxmLnF1ZXJ5U2VhcmNoID0gcXVlcnlTZWFyY2g7XG4gICAgc2VsZi5zZWxlY3RlZEl0ZW1DaGFuZ2UgPSBzZWxlY3RlZEl0ZW1DaGFuZ2U7XG4gICAgc2VsZi5zZWFyY2hUZXh0Q2hhbmdlID0gc2VhcmNoVGV4dENoYW5nZTtcbiAgICBzZWxmLnByb2plY3RUb3RhbCA9IDA7XG4gICAgc2VsZi5kZWxldGVQcm9qZWN0SXRlbSA9IGRlbGV0ZVByb2plY3RJdGVtO1xuICAgIHNlbGYuaWQgPSAwO1xuXG4vL2NvbnNvbGUubG9nKHNlbGYucHJvamVjdExpc3QpO1xuXG4gICAgLy9yZWZyZXNoIHByb2plY3QgbGlzdFxuICAgIGZ1bmN0aW9uIGdldFByb2plY3RMaXN0KCkge1xuICAgICAgICAkaHR0cC5nZXQoJy9wcm9qZWN0Lz91c2VyX2lkPScgKyAkcm9vdFNjb3BlLnVzZXIuaWQpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvamVjdExpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFByb2plY3QgPSByZXNwb25zZS5kYXRhWzBdLnByb2plY3RfbmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pcXVlTmFtZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAvL2l0ZW0ucHJvamVjdF9uYW1lID0gaXRlbS5wcm9qZWN0X25hbWUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAgICAgICAgICAgICAvL3Byb2plY3RMaXN0LmZvckVhY2goZnVuY3Rpb24gKGxpc3RJdGVtLCBpbmRleCwgYXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgaWYgKGxpc3RJdGVtICE9PSBpdGVtLnByb2plY3RfbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgdW5pcXVlTmFtZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy99KTtcbiAgICAgICAgICAgICAgICAgICAgLy9pZihpdGVtLnByb2plY3RfbmFtZSAhPSBjdXJyZW50UHJvamVjdCl7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgIHByb2plY3RMaXN0LnB1c2goaXRlbS5wcm9qZWN0X25hbWUpO1xuICAgICAgICAgICAgICAgICAgICAvL31cbiAgICAgICAgICAgICAgICAgICAgLy9jdXJyZW50UHJvamVjdCA9IGl0ZW0ucHJvamVjdF9uYW1lO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0TGlzdCk7XG4gICAgICAgICAgICAgICAgLy8gICAgLy9pdGVtLnByb2plY3RfZGVzY3JpcHRpb24gPSBpdGVtLnByb2plY3RfZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgLy8gICAgLy9pdGVtLml0ZW1JZCA9IGl0ZW0uaWQ7XG4gICAgICAgICAgICAgICAgLy8gICAgLy9pdGVtLmNvMl9vZmZzZXQgPSBpdGVtLmNvMl9vZmZzZXQ7XG4gICAgICAgICAgICAgICAgLy99KTtcbiAgICAgICAgICAgICAgICAvL3NlbGYucHJvamVjdExpc3QgPSBwcm9qZWN0TGlzdDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy9nZXQgaXRlbXMgZm9yIHNlbGVjdGVkIHByb2plY3RcbiAgICBmdW5jdGlvbiBnZXRQcm9qZWN0SXRlbXMoKSB7XG4gICAgICAgICRodHRwLmdldCgnL3Byb2plY3QvP3VzZXJfaWQ9JyArICRyb290U2NvcGUudXNlci5pZCArIFwiJnByb2plY3RfaWQ9MlwiKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgc2VsZi5wcm9qZWN0SXRlbXMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvL2xvYWQgcHJvamVjdCBsaXN0IG9uIHBhZ2UgbG9hZFxuICAgIGdldFByb2plY3RMaXN0KCk7XG5cblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYucHJvamVjdExpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogc2VsZi5wcm9qZWN0TGlzdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy9xdWVyeS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHF1ZXJ5LnNsaWNlKDEpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyRm4ob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gKG9iai5wcm9qZWN0X25hbWUuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdpdGVtJywgaXRlbSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzZWxlY3RlZF8gcHJvamVjdCcsc2VsZi5zZWxlY3RlZF9wcm9qZWN0KTtcbiAgICAgICAgaWYgKCBpdGVtID09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRfcHJvamVjdCA9ICcnO1xuICAgICAgICAgICAgc2VsZi5wcm9qZWN0X2Rlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuc2hvd0RlbGV0ZSA9IGZ1bmN0aW9uKGV2LCBpZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnQ0xJQ0snKTtcbiAgICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXG4gICAgICAgICAgICAudGl0bGUoJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBpdGVtPycpXG4gICAgICAgICAgICAuY29udGVudCgnVGhpcyB3aWxsIGJlIHBlcm1hbmVudC4nKVxuICAgICAgICAgICAgLmFyaWFMYWJlbCgnRGVsZXRlIGl0ZW0gcGVybWFuZW50bHknKVxuICAgICAgICAgICAgLm9rKCdEZWxldGUnKVxuICAgICAgICAgICAgLmNhbmNlbCgnQ2FuY2VsJylcbiAgICAgICAgICAgIC50YXJnZXRFdmVudChldik7XG4gICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGVsZXRpbmdcIiwgaWQpO1xuICAgICAgICAgICAgc2VsZi5kZWxldGVQcm9qZWN0SXRlbShpZCk7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBpdGVtIGhhcyBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuYWxlcnQgPSAnWW91ciBpdGVtIGhhcyBub3QgYmVlbiBkZWxldGVkLic7XG4gICAgICAgIH0pO1xuICAgIH07XG4vLyAgICBmdW5jdGlvbiBEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4vLyAgICAkc2NvcGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuYW5zd2VyID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbi8vICAgIH07XG4vL31cblxuICAgIGZ1bmN0aW9uIGRlbGV0ZVByb2plY3RJdGVtKGlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGVsZXRpbmcuLi5cIiwgaWQpO1xuXG4gICAgICAgIC8vJGh0dHAudXBkYXRlKCcvcHJvamVjdCcsIHNlbGYuaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIC8vZmluZE9uZSBhbmQgZGVsZXRlIGJ5IGlkIHVzaW5nIHByb2plY3RsaXN0LmlkXG4gICAgICAgIC8vICAgIGNvbnNvbGUubG9nKFwiSXRlbSB3YXMgZGVsZXRlZC5cIiwgcmVzcG9uc2UpO1xuICAgICAgICAvLyAgICBzZWxmLmdldFByb2plY3RMaXN0KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVByb2plY3QoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiU2F2aW5nLi4uXCIsIHNlbGYuaWQpO1xuICAgICAgICAvL3NhdmUgYWxsIHByb2plY3QgZmllbGRzPyBob3cgZG8gSSBldmVuIGRvIHRoaXM/XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVByb2plY3RUb3RhbCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJjYWxjdWxhdGluZy4uLlwiKTtcbiAgICAgICAgcHJvamVjdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgcHJvamVjdFRvdGFsICs9IGl0ZW0uY28yX29mZnNldDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RUb3RhbCk7XG4gICAgICAgIHJldHVybiBwcm9qZWN0VG90YWw7XG5cbiAgICB9KVxuICAgIH1cblxuXG5cbn1dKTsiLCIvLyBTZXJ2aWNlcyBmb3IgYXV0aGVudGljYXRpb25cbmFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KXtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
