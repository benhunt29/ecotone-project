var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(t,e,o,r){o.html5Mode(!0),t.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),e.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:""}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$http",function(t){function e(t){console.log("Text changed to ",t)}function o(t){void 0==t&&(l.category="",l.subcategory="",l.warmId="",l.weight="",l.conversion="",l.result="")}function r(){var e={warmId:l.warmId||l.category.secondaries[0].warm_id,weight:parseFloat(l.weight)*l.conversion};t.post("/calculations",e).then(function(t){l.result=Math.floor(1e3*Math.abs(t.data))/1e3})}function n(t){return t?l.list.filter(a(t)):l.list}function a(t){var e=t.toLowerCase();return function(t){return-1!=t.primary_cat.indexOf(e)}}t.get("/materials").then(function(t){var e=t.data;e.forEach(function(t){t.primary_cat=t.primary_cat.toLowerCase()}),l.list=e});var l=this;l.list="",l.result="",l.querySearch=n,l.selectedItemChange=o,l.searchTextChange=e,l.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],l.newCalculation=r}]),app.controller("adminCtrl",["$http",function(t){t.get("/suggestions").then(function(t){var o=t.data;console.log(o),e.suggestions=o});var e=this;e.suggestions=""}]),app.controller("loginCtrl",["$scope","$http","authService",function(t,e,o){t.login=function(){e({method:"POST",url:"/login",data:t.user}).then(function(t){o.saveToken(t.data.token)})}}]),app.controller("createAccountCtrl",["$scope","$http",function(t,e){t.user={},t.processForm=function(o){console.log("Posting..."),e({method:"POST",url:"/register",data:t.user,dataType:"json"}).then(function(t){console.log(t),alert("Your account has been created.")})}}]),app.controller("projectsCtrl",["$scope","$http",function(t,e){e.get("/project").then(function(e){console.log(e),t.projectList=e.data}),e({method:"GET",url:"http://www.w3schools.com/angular/customers.php"}).then(function(e){t.names=e.records})}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var o=e.split(".")[1],r=o.replace("-","+").replace("_","/");return JSON.parse(t.atob(r))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e,console.log("Saved token:",t.localStorage.jwtToken)},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),o=Math.round((new Date).getTime()/1e3)<=e.exp;return o||this.logout(),o}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,o){return{request:function(t){return t.headers=t.headers||{},o.isAuthed()&&(t.headers.Authorization="Bearer "+o.getToken()),t},response:function(o){return 401===o.status&&e.path("/login"),o||t.when(o)},responseError:function(o){return 401===o.status?e.path("/login"):console.log(o),t.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkaHR0cCIsInNlYXJjaFRleHRDaGFuZ2UiLCJ0ZXh0IiwiY29uc29sZSIsImxvZyIsInNlbGVjdGVkSXRlbUNoYW5nZSIsIml0ZW0iLCJ1bmRlZmluZWQiLCJzZWxmIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1JZCIsIndlaWdodCIsImNvbnZlcnNpb24iLCJyZXN1bHQiLCJuZXdDYWxjdWxhdGlvbiIsImNhbGN1bGF0ZSIsInNlY29uZGFyaWVzIiwid2FybV9pZCIsInBhcnNlRmxvYXQiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwiTWF0aCIsImZsb29yIiwiYWJzIiwiZGF0YSIsInF1ZXJ5U2VhcmNoIiwicXVlcnkiLCJsaXN0IiwiZmlsdGVyIiwiY3JlYXRlRmlsdGVyRm9yIiwibG93ZXJjYXNlUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsIm9iaiIsInByaW1hcnlfY2F0IiwiaW5kZXhPZiIsImdldCIsImZvckVhY2giLCJ0aGlzIiwidW5pdHMiLCJuYW1lIiwicmVzIiwic3VnZ2VzdGlvbnMiLCIkc2NvcGUiLCJhdXRoU2VydmljZSIsImxvZ2luIiwibWV0aG9kIiwidXJsIiwidXNlciIsInNhdmVUb2tlbiIsInRva2VuIiwicHJvY2Vzc0Zvcm0iLCJkYXRhVHlwZSIsImFsZXJ0IiwicHJvamVjdExpc3QiLCJuYW1lcyIsInJlY29yZHMiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInBhcnNlSnd0IiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiZ2V0VG9rZW4iLCJpc0F1dGhlZCIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImZhY3RvcnkiLCIkcSIsIiRsb2NhdGlvbiIsInJlcXVlc3QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsInN0YXR1cyIsInBhdGgiLCJyZXNwb25zZUVycm9yIiwicmVqZWN0Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxLQUFNQyxRQUFRQyxPQUFPLGNBQWUsVUFBVyxhQUFjLGNBRWpFRixLQUFJRyxRQUFRLHFCQUFzQixpQkFBa0Isb0JBQXFCLGdCQUFpQixTQUFTQyxFQUFvQkMsRUFBZ0JDLEVBQW1CQyxHQUN0SkQsRUFBa0JFLFdBQVUsR0FHNUJKLEVBQW1CSyxNQUFNLFdBQ3BCQyxlQUFlLFNBQ2ZDLGNBQWMsYUFBY0MsVUFBVSxRQUN0Q0MsWUFBYSxVQUdsQlIsRUFBZVMsS0FBSyxLQUVaQyxZQUFhLHlCQUNiQyxXQUFZLDBCQUNiRixLQUFLLFVBRUpDLFlBQWEsb0JBQ2JDLFdBQVksS0FDYkYsS0FBSyxhQUVKQyxZQUFhLHVCQUNiQyxXQUFZLHNCQUNiRixLQUFLLFVBRUpDLFlBQWEsb0JBQ2JDLFdBQVksc0JBRWJGLEtBQUssWUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxLQUNiRixLQUFLLGNBRUpDLFlBQWEsd0JBQ2JDLFdBQVksaUJBQ2JGLEtBQUssYUFFSkMsWUFBYSxzQkFDYkMsV0FBWSxpQkFDYkYsS0FBSyxVQUVKQyxZQUFhLHNCQUNkRCxLQUFLLFlBRUpDLFlBQWEsc0JBQ2JDLFdBQVksS0FDYkYsS0FBSyxZQUVKQyxZQUFhLHdCQUNkRCxLQUFLLFlBRUpDLFlBQWEsd0JBQ2RFLFdBQ0NDLFdBQVksU0FNeEJsQixJQUFJ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LE9BQXBCQSxFQUFTZ0UsT0FDVEosRUFBVUssS0FBSyxVQUdmcEYsUUFBUUMsSUFBSWtCLEdBRVQyRCxFQUFHUSxPQUFPbkUiLCJmaWxlIjoic2NyaXB0cy9hcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2Vjb3RvbmVBcHAnLCBbJ25nUm91dGUnLCAnbmdNYXRlcmlhbCcsICduZ01lc3NhZ2VzJ10pO1xuXG5hcHAuY29uZmlnKFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywgJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgJyRodHRwUHJvdmlkZXInLCBmdW5jdGlvbigkbWRUaGVtaW5nUHJvdmlkZXIsICRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJGh0dHBQcm92aWRlcil7XG4gICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXG4gICAgLy9zZXQgdGhlbWUgYW5kIGNvbG9yIHBhbGV0dGVcbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxuICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2dyZWVuJylcbiAgICAgICAgLmFjY2VudFBhbGV0dGUoJ2JsdWUtZ3JleScsIHsnZGVmYXVsdCc6JzYwMCd9KVxuICAgICAgICAud2FyblBhbGV0dGUgKCdvcmFuZ2UnKTtcblxuICAgIC8vcm91dGVzIGZvciB2aWV3c1xuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy8nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jYWxjdWxhdG9yLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhbGN1bGF0ZUN0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FkbWluJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWRtaW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnYWRtaW5DdHJsIGFzIGN0cmwnXG5cbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwnXG4gICAgICAgIH0pLndoZW4oJy9wcm9qZWN0cycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2plY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWJvdXQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hYm91dC5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcHJpdmFjeScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3ByaXZhY3kuaHRtbCdcbiAgICAgICAgfSkud2hlbignL3NvdXJjZXMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zb3VyY2VzLmh0bWwnXG4gICAgICAgIH0pLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG5cbiAgICAvLyRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignY2FsY3VsYXRlQ3RybCcsIFsnJGh0dHAnLCBmdW5jdGlvbiggJGh0dHAgKSB7XG4gICAgLy8gSU5JVFxuICAgICRodHRwLmdldCgnL21hdGVyaWFscycpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgdmFyIGxpc3QgPSByZXNwb25zZS5kYXRhO1xuXG4gICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgIGl0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAvLyAvaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBpdGVtLnByaW1hcnlfY2F0LnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYubGlzdCA9IGxpc3Q7XG5cbiAgICB9KTtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VsZi5saXN0ID0gJyc7XG4gICAgc2VsZi5yZXN1bHQgPSAnJztcbiAgICBzZWxmLnF1ZXJ5U2VhcmNoID0gcXVlcnlTZWFyY2g7XG4gICAgc2VsZi5zZWxlY3RlZEl0ZW1DaGFuZ2UgPSBzZWxlY3RlZEl0ZW1DaGFuZ2U7XG4gICAgc2VsZi5zZWFyY2hUZXh0Q2hhbmdlICAgPSBzZWFyY2hUZXh0Q2hhbmdlO1xuICAgIHNlbGYudW5pdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDA1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdraWxvcycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMTEwMjMxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ21ldHJpYyB0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDEuMTAyMzFcbiAgICAgICAgfVxuICAgIF07XG4gICAgc2VsZi5uZXdDYWxjdWxhdGlvbiA9IG5ld0NhbGN1bGF0aW9uO1xuXG5cbiAgICBmdW5jdGlvbiBzZWFyY2hUZXh0Q2hhbmdlKHRleHQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1RleHQgY2hhbmdlZCB0byAnLCB0ZXh0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWxlY3RlZEl0ZW1DaGFuZ2UoaXRlbSkge1xuICAgICAgICBpZiAoIGl0ZW0gPT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgc2VsZi5jYXRlZ29yeSA9ICcnO1xuICAgICAgICAgICAgc2VsZi5zdWJjYXRlZ29yeSA9ICcnO1xuICAgICAgICAgICAgc2VsZi53YXJtSWQgPSAnJztcbiAgICAgICAgICAgIHNlbGYud2VpZ2h0ID0gJyc7XG4gICAgICAgICAgICBzZWxmLmNvbnZlcnNpb24gPSAnJztcbiAgICAgICAgICAgIHNlbGYucmVzdWx0ID0gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXdDYWxjdWxhdGlvbigpIHtcblxuICAgICAgICB2YXIgY2FsY3VsYXRlID0ge1xuICAgICAgICAgICAgd2FybUlkOiBzZWxmLndhcm1JZCB8fCBzZWxmLmNhdGVnb3J5LnNlY29uZGFyaWVzWzBdLndhcm1faWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoc2VsZi53ZWlnaHQpICogc2VsZi5jb252ZXJzaW9uXG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAucG9zdCgnL2NhbGN1bGF0aW9ucycsIGNhbGN1bGF0ZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgc2VsZi5yZXN1bHQgPSBNYXRoLmZsb29yKE1hdGguYWJzKHJlc3BvbnNlLmRhdGEpICogMTAwMCkgLyAxMDAwO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzYXZlVG9Qcm9qZWN0KCl7XG4gICAgICAgIHZhciBsaW5lSXRlbSA9IHtcbiAgICAgICAgICAgIGNhdGVnb3J5OiBzZWxmLmNhdGVnb3J5LFxuICAgICAgICAgICAgc3ViY2F0ZWdvcnk6IHNlbGYuc3ViY2F0ZWdvcnksXG4gICAgICAgICAgICB3YXJtX0lkOiBzZWxmLndhcm1JZCxcbiAgICAgICAgICAgIHdlaWdodDogcGFyc2VGbG9hdChzZWxmLndlaWdodCkqc2VsZi5jb252ZXJzaW9uLFxuICAgICAgICAgICAgdW5pdHM6IHNlbGYudW5pdC5uYW1lXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKGxpbmVJdGVtKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL2FkZFRvUHJvamVjdCcpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcXVlcnlTZWFyY2gocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5ID8gc2VsZi5saXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSA6IHNlbGYubGlzdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKSAvL3F1ZXJ5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcXVlcnkuc2xpY2UoMSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAob2JqLnByaW1hcnlfY2F0LmluZGV4T2YobG93ZXJjYXNlUXVlcnkpICE9IC0xKTtcbiAgICAgICAgfTtcbiAgICB9XG59XSk7XG5cbi8qKlxuICogQURNSU5cbiAqL1xuYXBwLmNvbnRyb2xsZXIoJ2FkbWluQ3RybCcsIFsnJGh0dHAnLCBmdW5jdGlvbiggJGh0dHAgKXtcbiAgICAvLyBJTklUXG4gICAgJGh0dHAuZ2V0KCcvc3VnZ2VzdGlvbnMnKS50aGVuKGZ1bmN0aW9uKCByZXMgKSB7XG4gICAgICAgIHZhciBzdWdnZXN0aW9ucyA9IHJlcy5kYXRhO1xuICAgICAgICBjb25zb2xlLmxvZyhzdWdnZXN0aW9ucyk7XG4gICAgICAgIHNlbGYuc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucztcbiAgICB9KTtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLnN1Z2dlc3Rpb25zID0gJyc7XG5cblxufV0pO1xuXG4vLyBMb2dpbiBIVE1MIC0gS2F0ZVxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgYXV0aFNlcnZpY2UpIHtcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgICAgIGRhdGE6ICRzY29wZS51c2VyXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKHJlc3BvbnNlLmRhdGEudG9rZW4pO1xuICAgICAgICB9KVxuICAgIH1cbn1dKTtcblxuLy8gUmVnaXN0ZXIgSFRNTCAtIE1hZGVsaW5lXG5hcHAuY29udHJvbGxlcignY3JlYXRlQWNjb3VudEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcbiAgICAkc2NvcGUudXNlciA9IHt9O1xuXG4gICAgJHNjb3BlLnByb2Nlc3NGb3JtID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJQb3N0aW5nLi4uXCIpO1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUudXNlcixcbiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIGFsZXJ0KFwiWW91ciBhY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQuXCIpXG4gICAgICAgIH0pXG4gICAgfTtcbn1dKTtcblxuLy8gUHJvamVjdCBIVE1MIC0gRGFzaGJvYXJkIEhUTUwgLSBLaW1cbmFwcC5jb250cm9sbGVyKCdwcm9qZWN0c0N0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcbiAgICAvL2xvYWQgcHJvamVjdCBsaXN0IG9uIHBhZ2UgbG9hZFxuICAgICRodHRwLmdldCgnL3Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgJHNjb3BlLnByb2plY3RMaXN0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgLy9yZXNwb25zZS5kYXRhLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIC8vICAgIGl0ZW0ucHJvamVjdF9uYW1lID0gaXRlbS5wcmltYXJ5X2NhdC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9KTtcblxuICAgICRodHRwKHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL2FuZ3VsYXIvY3VzdG9tZXJzLnBocCdcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc2NvcGUubmFtZXMgPSByZXNwb25zZS5yZWNvcmRzO1xuICAgIH0pO1xuXG59XSk7XG5cbi8vIFNlcnZpY2VzIGZvciBhdXRoZW50aWNhdGlvblxuYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpe1xuICAgIHRoaXMucGFyc2VKd3QgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgICAgIH0gZWxzZSByZXR1cm4ge307XG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuID0gdG9rZW47XG4gICAgICAgIGNvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pO1xuXG5hcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
