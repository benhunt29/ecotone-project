var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,o,r){o.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue").warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl"}).when("/login",{templateUrl:"/views/login.html",controller:""}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$scope","$http",function(e,t){function o(){var t=[{category:"blinds",subcategory:["wood","vinyl","aluminum"]},{category:"asphalt shingles",subcategory:[]},{category:"cabinets",subcategory:["aluminum","wood","fiberglass","glass","plastic","steel","vinyl","MDF"]}];e.list=t}function r(e){var t=angular.lowercase(e);return function(e){return console.log(e),-1!=e.category.indexOf(t)}}e.calculate={},e.list={},o(),e.querySearch=function(t){return console.log(e.list),t?e.list.filter(r(t)):e.list}}]),app.controller("loginCtrl",["$scope","$http","authService",function(e,t,o){e.login=function(){t({method:"POST",url:"/login",data:e.user}).then(function(e){o.saveToken(e.data)})}}]),app.controller("createAccountCtrl",["$scope","$http",function(e,t){e.user={},e.processForm=function(o){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),alert("Your account has been created.")})}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){t({method:"POST",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records}),t({method:"GET",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records})}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],r=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwid2FyblBhbGV0dGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsIiRzY29wZSIsIiRodHRwIiwibG9hZENhdGVnb3JpZXMiLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsImxpc3QiLCJjcmVhdGVGaWx0ZXJGb3IiLCJxdWVyeSIsImxvd2VyY2FzZVF1ZXJ5IiwibG93ZXJjYXNlIiwib2JqIiwiY29uc29sZSIsImxvZyIsImluZGV4T2YiLCJjYWxjdWxhdGUiLCJxdWVyeVNlYXJjaCIsImZpbHRlciIsImF1dGhTZXJ2aWNlIiwibG9naW4iLCJtZXRob2QiLCJ1cmwiLCJkYXRhIiwidXNlciIsInRoZW4iLCJyZXNwb25zZSIsInNhdmVUb2tlbiIsInByb2Nlc3NGb3JtIiwiZGF0YVR5cGUiLCJhbGVydCIsIm5hbWVzIiwicmVjb3JkcyIsInNlcnZpY2UiLCIkd2luZG93IiwidGhpcyIsInBhcnNlSnd0IiwidG9rZW4iLCJiYXNlNjRVcmwiLCJzcGxpdCIsImJhc2U2NCIsInJlcGxhY2UiLCJKU09OIiwicGFyc2UiLCJhdG9iIiwibG9jYWxTdG9yYWdlIiwiand0VG9rZW4iLCJnZXRUb2tlbiIsImlzQXV0aGVkIiwicGFyYW1zIiwibm90RXhwaXJlZCIsIk1hdGgiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwibG9nb3V0IiwiZ2V0VXNlciIsImZhY3RvcnkiLCIkcSIsIiRsb2NhdGlvbiIsInJlcXVlc3QiLCJoZWFkZXJzIiwi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SixJQUM1QixVQUdYTCxLQUFLUixVQUFZLFNBQVVVLEdBQ3ZCSCxFQUFRVyxhQUFhQyxTQUFXVCxFQUNoQ3hCLFFBQVFDLElBQUksZUFBZW9CLEVBQVFXLGFBQWFDLFdBR3BEWCxLQUFLWSxTQUFXLFdBQ1osTUFBT2IsR0FBUVcsYUFBYUMsVUFHaENYLEtBQUthLFNBQVcsV0FDWixHQUFJWCxHQUFRRixLQUFLWSxVQUNqQixJQUFJVixFQUFPLENBQ1AsR0FBSVksR0FBU2QsS0FBS0MsU0FBU0MsR0FDdkJhLEVBQWFDLEtBQUtDLE9BQU0sR0FBSUMsT0FBT0MsVUFBWSxNQUFTTCxFQUFPTSxHQUluRSxPQUhLTCxJQUNEZixLQUFLcUIsU0FFRk4sRUFFUCxPQUFPLEdBSWZmLEtBQUtxQixPQUFTLGlCQUNIdEIsR0FBUVcsYUFBYUMsVUFJaENYLEtBQUtzQixRQUFVLFdBQ1gsTUFBT3RCLE1BQUtDLFNBQVNELEtBQUtZLGdCQUlsQ2hFLElBQUkyRSxRQUFRLG1CQUFvQixLQUFNLFlBQWEsY0FBZSxTQUFVQyxFQUFJQyxFQUFXekMsR0FDdkYsT0FDSTBDLFFBQVMsU0FBVTNFLEdBS2YsTUFKQUEsR0FBTzRFLFFBQVU1RSxFQUFPNEUsWUFDcEIzQyxFQUFZNkIsYUFDWjlELEVBQU80RSxRQUFRQyxjQUFnQixVQUFZNUMsRUFBWTRCLFlBRXBEN0QsR0FFWHdDLFNBQVUsU0FBVUEsR0FPaEIsTUFMd0IsT0FBcEJBLEVBQVNzQyxRQUdUSixFQUFVSyxLQUFLLFVBRVp2QyxHQUFZaUMsRUFBRy9ELEtBQUs4QixJQUM1QndDLGNBQWUsU0FBVXhDLEdBT3hCLE1BTndCLE9BQXBCQSxFQUFTc0MsT0FDVEosRUFBVUssS0FBSyxVQUdmcEQsUUFBUUMsSUFBSVksR0FFVGlDLEVBQUdRLE9BQU96QyIsImZpbGUiOiJzY3JpcHRzL2FwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZWNvdG9uZUFwcCcsIFsnbmdSb3V0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnXSk7XG5cbmFwcC5jb25maWcoWyckbWRUaGVtaW5nUHJvdmlkZXInLCAnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCAnJGh0dHBQcm92aWRlcicsIGZ1bmN0aW9uKCRtZFRoZW1pbmdQcm92aWRlciwgJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkaHR0cFByb3ZpZGVyKXtcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cbiAgICAvL3NldCB0aGVtZSBhbmQgY29sb3IgcGFsZXR0ZVxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXG4gICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnZ3JlZW4nKVxuICAgICAgICAuYWNjZW50UGFsZXR0ZSgnYmx1ZScpXG4gICAgICAgIC53YXJuUGFsZXR0ZSAoJ29yYW5nZScpO1xuXG4gICAgLy9yb3V0ZXMgZm9yIHZpZXdzXG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NhbGN1bGF0b3IuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCdcbiAgICAgICAgfSkud2hlbignL2xvZ2luJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcmVnaXN0ZXInLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjcmVhdGVBY2NvdW50Q3RybCdcbiAgICAgICAgfSkud2hlbignL2FjY291bnQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hY2NvdW50Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL2Rhc2hib2FyZCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Rhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwnXG4gICAgICAgIH0pLndoZW4oJy9wcm9qZWN0cycsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3Byb2plY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncHJvamVjdHNDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWJvdXQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9hYm91dC5odG1sJ1xuICAgICAgICB9KS53aGVuKCcvY29udGFjdCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2NvbnRhY3QuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvcHJpdmFjeScsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3ByaXZhY3kuaHRtbCdcbiAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvJ1xuICAgICAgICB9KTtcblxuICAgIC8vJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnYXV0aEludGVyY2VwdG9yJyk7XG59XSk7XG5cbi8vIENhbGN1bGF0b3IgSFRNTCAtIEthdGUgKyBNYWRlbGluZVxuLy9hcHAuY29udHJvbGxlcignY2FsY3VsYXRlQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCl7XG4vLyAgICAvL01cbi8vICAgICRzY29wZS5jYWxjdWxhdGUgPSB7fTtcbi8vICAgICRzY29wZS5saXN0ID0ge307XG4vLyAgICBsb2FkQ2F0ZWdvcmllcygpO1xuXG4gICAgLy9LXG4gICAgLy8kc2NvcGUubWFqb3IgPSBbXG4gICAgLy8gICAgJ0NhdGVnb3J5IDEnLFxuICAgIC8vICAgICdDYXRlZ29yeSAyJyxcbiAgICAvLyAgICAnQ2F0ZWdvcnkgMydcbiAgICAvL107XG4gICAgLy8kc2NvcGUuc3ViID0gW1xuICAgIC8vICAgICdTdWItY2F0ZWdvcnkgMScsXG4gICAgLy8gICAgJ1N1Yi1jYXRlZ29yeSAyJyxcbiAgICAvLyAgICAnU3ViLWNhdGVnb3J5IDMnXG4gICAgLy9dO1xuICAgIC8vJHNjb3BlLnVuaXQgPSBbXG4gICAgLy8gICAgJ2xicycsXG4gICAgLy8gICAgJ3RvbnMnLFxuICAgIC8vICAgICdrZydcbiAgICAvL107XG5cbiAgICAvL00vL2Rlc2lnbmF0ZSBjb250cm9sbGVyXG4gICAgYXBwLmNvbnRyb2xsZXIoJ2NhbGN1bGF0ZUN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcbiAgICAgICAgJHNjb3BlLmNhbGN1bGF0ZSA9IHt9O1xuICAgICAgICAkc2NvcGUubGlzdCA9IHt9O1xuXG4gICAgICAgIGxvYWRDYXRlZ29yaWVzKCk7XG5cbi8vbG9hZCBjYXRlZ29yaWVzIGxpc3Qgb24gcGFnZSBsb2FkXG4vLyAkaHR0cCh7XG4vLyAgICAgICAgICAgICBtZXRob2Q6ICdHZXQnLFxuLy8gICAgICAgICAgICAgdXJsOiAnL2dldExpc3QnLFxuLy8gICAgICAgICAgICAgZGF0YTogcmVzcG9uc2UsXG4vLyAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4vLyAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4vLyAgICAgICAgICAgICAkc2NvcGUubGlzdCA9IHJlc3BvbnNlO1xuLy8gICAgICAgICB9KVxuXG5cbi8vYXV0b2NvbXBsZXRlIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgJHNjb3BlLnF1ZXJ5U2VhcmNoPWZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUubGlzdCk7XG4gICAgICAgICAgICByZXR1cm4gcXVlcnkgPyAkc2NvcGUubGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiAkc2NvcGUubGlzdDtcbiAgICAgICAgfTtcblxuICAgICAgICBmdW5jdGlvbiBsb2FkQ2F0ZWdvcmllcygpIHtcblxuICAgICAgICAgICAgdmFyIGNhdGVnb3JpZXMgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogXCJibGluZHNcIixcbiAgICAgICAgICAgICAgICAgICAgc3ViY2F0ZWdvcnk6IFtcIndvb2RcIiwgXCJ2aW55bFwiLCBcImFsdW1pbnVtXCJdXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBcImFzcGhhbHQgc2hpbmdsZXNcIixcbiAgICAgICAgICAgICAgICAgICAgc3ViY2F0ZWdvcnk6IFtdXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBcImNhYmluZXRzXCIsXG4gICAgICAgICAgICAgICAgICAgIHN1YmNhdGVnb3J5OiBbXCJhbHVtaW51bVwiLCBcIndvb2RcIiwgXCJmaWJlcmdsYXNzXCIsIFwiZ2xhc3NcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicGxhc3RpY1wiLCBcInN0ZWVsXCIsIFwidmlueWxcIiwgXCJNREZcIl1cbiAgICAgICAgICAgICAgICB9XTtcblxuICAgICAgICAgICAgJHNjb3BlLmxpc3QgPSBjYXRlZ29yaWVzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9DcmVhdGUgZmlsdGVyIGZ1bmN0aW9uIGZvciBhIHF1ZXJ5IHN0cmluZ1xuICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IGFuZ3VsYXIubG93ZXJjYXNlKHF1ZXJ5KTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBmaWx0ZXJGbihvYmopIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhvYmopO1xuICAgICAgICAgICAgICAgIHJldHVybiAob2JqLmNhdGVnb3J5LmluZGV4T2YobG93ZXJjYXNlUXVlcnkpICE9IC0xKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbi8vIExvZ2luIEhUTUwgLSBLYXRlXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSkge1xuICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXJcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICBhdXRoU2VydmljZS5zYXZlVG9rZW4ocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgIH0pXG4gICAgfVxufV0pO1xuXG4vLyBSZWdpc3RlciBIVE1MIC0gTWFkZWxpbmVcbmFwcC5jb250cm9sbGVyKCdjcmVhdGVBY2NvdW50Q3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgICRzY29wZS51c2VyID0ge307XG5cbiAgICAkc2NvcGUucHJvY2Vzc0Zvcm0gPSBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlBvc3RpbmcuLi5cIik7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgICAgIGRhdGE6ICRzY29wZS51c2VyLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgYWxlcnQoXCJZb3VyIGFjY291bnQgaGFzIGJlZW4gY3JlYXRlZC5cIilcbiAgICAgICAgfSlcbiAgICB9O1xufV0pO1xuXG4vLyBQcm9qZWN0IEhUTUwgLSBEYXNoYm9hcmQgSFRNTCAtIEtpbVxuYXBwLmNvbnRyb2xsZXIoJ3Byb2plY3RzQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgICRodHRwKHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIHVybDogJ2h0dHA6Ly93d3cudzNzY2hvb2xzLmNvbS9hbmd1bGFyL2N1c3RvbWVycy5waHAnXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgJHNjb3BlLm5hbWVzID0gcmVzcG9uc2UucmVjb3JkcztcbiAgICB9KTtcblxuICAgICRodHRwKHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL2FuZ3VsYXIvY3VzdG9tZXJzLnBocCdcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc2NvcGUubmFtZXMgPSByZXNwb25zZS5yZWNvcmRzO1xuICAgIH0pO1xufV0pO1xuXG4vLyBTZXJ2aWNlcyBmb3IgYXV0aGVudGljYXRpb25cbmFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KXtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
