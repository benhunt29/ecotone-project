var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,r,o){r.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue").warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl"}).when("/login",{templateUrl:"/views/login.html",controller:""}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"projectsCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$scope","$http",function(e,t){function r(){var t=[{category:"blinds",subcategory:["wood","vinyl","aluminum"]},{category:"asphalt shingles",subcategory:[]},{category:"cabinets",subcategory:["aluminum","wood","fiberglass","glass","plastic","steel","vinyl","MDF"]}];e.list=t}function o(e){var t=angular.lowercase(e);return function(e){return console.log(e),-1!=e.category.indexOf(t)}}e.calculate={},e.list={},r(),e.querySearch=function(t){return console.log(e.list),t?e.list.filter(o(t)):e.list}}]),app.controller("createAccountCtrl",["$scope","$http",function(e,t){e.user={},e.processForm=function(r){console.log("Posting..."),t({method:"POST",url:"/newUser",data:e.user,dataType:"json"}).then(function(e){console.log(e),alert("Your account has been created.")})}}]),app.controller("projectsCtrl",["$scope","$http",function(e,t){t({method:"POST",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records}),t({method:"GET",url:"http://www.w3schools.com/angular/customers.php"}).then(function(t){e.names=t.records})}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var r=t.split(".")[1],o=r.replace("-","+").replace("_","/");return JSON.parse(e.atob(o))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),r=Math.round((new Date).getTime()/1e3)<=t.exp;return r||this.logout(),r}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,r){return{request:function(e){return e.headers=e.headers||{},r.isAuthed()&&(e.headers.Authorization="Bearer "+r.getToken()),e},response:function(r){return 401===r.status&&t.path("/login"),r||e.when(r)},responseError:function(r){return 401===r.status?t.path("/login"):console.log(r),e.reject(r)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwid2FyblBhbGV0dGUiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsIiRzY29wZSIsIiRodHRwIiwibG9hZENhdGVnb3JpZXMiLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsImxpc3QiLCJjcmVhdGVGaWx0ZXJGb3IiLCJxdWVyeSIsImxvd2VyY2FzZVF1ZXJ5IiwibG93ZXJjYXNlIiwib2JqIiwiY29uc29sZSIsImxvZyIsImluZGV4T2YiLCJjYWxjdWxhdGUiLCJxdWVyeVNlYXJjaCIsImZpbHRlciIsInVzZXIiLCJwcm9jZXNzRm9ybSIsIm1ldGhvZCIsInVybCIsImRhdGEiLCJkYXRhVHlwZSIsInRoZW4iLCJyZXNwb25zZSIsImFsZXJ0IiwibmFtZXMiLCJyZWNvcmRzIiwic2VydmljZSIsIiR3aW5kb3ciLCJ0aGlzIiwicGFyc2VKd3QiLCJ0b2tlbiIsImJhc2U2NFVybCIsInNwbGl0IiwiYmFzZTY0IiwicmVwbGFjZSIsIkpTT04iLCJwYXJzZSIsImF0b2IiLCJzYXZlVG9rZW4iLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwiTWF0aCIsInJvdW5kIiwiRGF0ZSIsImdldFRpbWUiLCJleHAiLCJsb2dvdXQiLCJnZXRVc2VyIiwiZmFjdG9yeSIsIiRxIiwiJGxvY2F0aW9uIiwiYXV0aFNlcnZpY2UiLCJyZXF1ZXN0IiwiaGVhZGVycyIsIkF1dGhvcml6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QUNqQixJQUFJWCxFQUFPLENBQ1AsR0FBSWEsR0FBU2YsS0FBS0MsU0FBU0MsR0FDdkJjLEVBQWFDLEtBQUtDLE9BQU0sR0FBSUMsT0FBT0MsVUFBWSxNQUFTTCxFQUFPTSxHQUluRSxPQUhLTCxJQUNEaEIsS0FBS3NCLFNBRUZOLEVBRVAsT0FBTyxHQUlmaEIsS0FBS3NCLE9BQVMsaUJBQ0h2QixHQUFRWSxhQUFhQyxVQUloQ1osS0FBS3VCLFFBQVUsV0FDWCxNQUFPdkIsTUFBS0MsU0FBU0QsS0FBS2EsZ0JBSWxDOUQsSUFBSXlFLFFBQVEsbUJBQW9CLEtBQU0sWUFBYSxjQUFlLFNBQVVDLEVBQUlDLEVBQVdDLEdBQ3ZGLE9BQ0lDLFFBQVMsU0FBVTFFLEdBS2YsTUFKQUEsR0FBTzJFLFFBQVUzRSxFQUFPMkUsWUFDcEJGLEVBQVliLGFBQ1o1RCxFQUFPMkUsUUFBUUMsY0FBZ0IsVUFBWUgsRUFBWWQsWUFFcEQzRCxHQUVYd0MsU0FBVSxTQUFVQSxHQU9oQixNQUx3QixPQUFwQkEsRUFBU3FDLFFBR1RMLEVBQVVNLEtBQUssVUFFWnRDLEdBQVkrQixFQUFHN0QsS0FBSzhCLElBQzVCdUMsY0FBZSxTQUFVdkMsR0FPeEIsTUFOd0IsT0FBcEJBLEVBQVNxQyxPQUNUTCxFQUFVTSxLQUFLLFVBR2ZuRCxRQUFRQyxJQUFJWSxHQUVUK0IsRUFBR1MsT0FBT3hDIiwiZmlsZSI6InNjcmlwdHMvYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdlY290b25lQXBwJywgWyduZ1JvdXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcyddKTtcblxuYXBwLmNvbmZpZyhbJyRtZFRoZW1pbmdQcm92aWRlcicsICckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJG1kVGhlbWluZ1Byb3ZpZGVyLCAkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpe1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vc2V0IHRoZW1lIGFuZCBjb2xvciBwYWxldHRlXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcbiAgICAgICAgLnByaW1hcnlQYWxldHRlKCdncmVlbicpXG4gICAgICAgIC5hY2NlbnRQYWxldHRlKCdibHVlJylcbiAgICAgICAgLndhcm5QYWxldHRlICgnb3JhbmdlJyk7XG5cbiAgICAvL3JvdXRlcyBmb3Igdmlld3NcbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY2FsY3VsYXRvci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvbG9naW4nLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9yZWdpc3RlcicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3JlZ2lzdGVyLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NyZWF0ZUFjY291bnRDdHJsJ1xuICAgICAgICB9KS53aGVuKCcvYWNjb3VudCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2FjY291bnQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnJ1xuICAgICAgICB9KS53aGVuKCcvZGFzaGJvYXJkJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvZGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ3Byb2plY3RzQ3RybCdcbiAgICAgICAgfSkud2hlbignL3Byb2plY3RzJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcHJvamVjdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwnXG4gICAgICAgIH0pLndoZW4oJy9hYm91dCcsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2Fib3V0Lmh0bWwnXG4gICAgICAgIH0pLndoZW4oJy9jb250YWN0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY29udGFjdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9wcml2YWN5JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcHJpdmFjeS5odG1sJ1xuICAgICAgICB9KS5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICAgIH0pO1xuXG4gICAgLy8kaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdhdXRoSW50ZXJjZXB0b3InKTtcbn1dKTtcblxuLy8gQ2FsY3VsYXRvciBIVE1MIC0gS2F0ZSArIE1hZGVsaW5lXG4vL2FwcC5jb250cm9sbGVyKCdjYWxjdWxhdGVDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKXtcbi8vICAgIC8vTVxuLy8gICAgJHNjb3BlLmNhbGN1bGF0ZSA9IHt9O1xuLy8gICAgJHNjb3BlLmxpc3QgPSB7fTtcbi8vICAgIGxvYWRDYXRlZ29yaWVzKCk7XG5cbiAgICAvL0tcbiAgICAvLyRzY29wZS5tYWpvciA9IFtcbiAgICAvLyAgICAnQ2F0ZWdvcnkgMScsXG4gICAgLy8gICAgJ0NhdGVnb3J5IDInLFxuICAgIC8vICAgICdDYXRlZ29yeSAzJ1xuICAgIC8vXTtcbiAgICAvLyRzY29wZS5zdWIgPSBbXG4gICAgLy8gICAgJ1N1Yi1jYXRlZ29yeSAxJyxcbiAgICAvLyAgICAnU3ViLWNhdGVnb3J5IDInLFxuICAgIC8vICAgICdTdWItY2F0ZWdvcnkgMydcbiAgICAvL107XG4gICAgLy8kc2NvcGUudW5pdCA9IFtcbiAgICAvLyAgICAnbGJzJyxcbiAgICAvLyAgICAndG9ucycsXG4gICAgLy8gICAgJ2tnJ1xuICAgIC8vXTtcblxuICAgIC8vTS8vZGVzaWduYXRlIGNvbnRyb2xsZXJcbiAgICBhcHAuY29udHJvbGxlcignY2FsY3VsYXRlQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgICAgICAkc2NvcGUuY2FsY3VsYXRlID0ge307XG4gICAgICAgICRzY29wZS5saXN0ID0ge307XG5cbiAgICAgICAgbG9hZENhdGVnb3JpZXMoKTtcblxuLy9sb2FkIGNhdGVnb3JpZXMgbGlzdCBvbiBwYWdlIGxvYWRcbi8vICRodHRwKHtcbi8vICAgICAgICAgICAgIG1ldGhvZDogJ0dldCcsXG4vLyAgICAgICAgICAgICB1cmw6ICcvZ2V0TGlzdCcsXG4vLyAgICAgICAgICAgICBkYXRhOiByZXNwb25zZSxcbi8vICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbidcbi8vICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbi8vICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbi8vICAgICAgICAgICAgICRzY29wZS5saXN0ID0gcmVzcG9uc2U7XG4vLyAgICAgICAgIH0pXG5cblxuLy9hdXRvY29tcGxldGUgZnVuY3Rpb25hbGl0eVxuICAgICAgICAkc2NvcGUucXVlcnlTZWFyY2g9ZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5saXN0KTtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeSA/ICRzY29wZS5saXN0LmZpbHRlcihjcmVhdGVGaWx0ZXJGb3IocXVlcnkpKSA6ICRzY29wZS5saXN0O1xuICAgICAgICB9O1xuXG4gICAgICAgIGZ1bmN0aW9uIGxvYWRDYXRlZ29yaWVzKCkge1xuXG4gICAgICAgICAgICB2YXIgY2F0ZWdvcmllcyA9IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBcImJsaW5kc1wiLFxuICAgICAgICAgICAgICAgICAgICBzdWJjYXRlZ29yeTogW1wid29vZFwiLCBcInZpbnlsXCIsIFwiYWx1bWludW1cIl1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IFwiYXNwaGFsdCBzaGluZ2xlc1wiLFxuICAgICAgICAgICAgICAgICAgICBzdWJjYXRlZ29yeTogW11cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IFwiY2FiaW5ldHNcIixcbiAgICAgICAgICAgICAgICAgICAgc3ViY2F0ZWdvcnk6IFtcImFsdW1pbnVtXCIsIFwid29vZFwiLCBcImZpYmVyZ2xhc3NcIiwgXCJnbGFzc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwbGFzdGljXCIsIFwic3RlZWxcIiwgXCJ2aW55bFwiLCBcIk1ERlwiXVxuICAgICAgICAgICAgICAgIH1dO1xuXG4gICAgICAgICAgICAkc2NvcGUubGlzdCA9IGNhdGVnb3JpZXM7XG4gICAgICAgIH1cblxuICAgICAgICAvL0NyZWF0ZSBmaWx0ZXIgZnVuY3Rpb24gZm9yIGEgcXVlcnkgc3RyaW5nXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbHRlckZvcihxdWVyeSkge1xuICAgICAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gYW5ndWxhci5sb3dlcmNhc2UocXVlcnkpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG9iaik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChvYmouY2F0ZWdvcnkuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuLy8gTG9naW4gSFRNTCAtIE1hZGVsaW5lXG5hcHAuY29udHJvbGxlcignY3JlYXRlQWNjb3VudEN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcbiAgICAkc2NvcGUudXNlciA9IHt9O1xuXG4gICAgJHNjb3BlLnByb2Nlc3NGb3JtID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJQb3N0aW5nLi4uXCIpO1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9uZXdVc2VyJyxcbiAgICAgICAgICAgIGRhdGE6ICRzY29wZS51c2VyLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgYWxlcnQoXCJZb3VyIGFjY291bnQgaGFzIGJlZW4gY3JlYXRlZC5cIilcbiAgICAgICAgfSlcbiAgICB9O1xufV0pO1xuXG4vLyBQcm9qZWN0IEhUTUwgLSBEYXNoYm9hcmQgSFRNTCAtIEtpbVxuYXBwLmNvbnRyb2xsZXIoJ3Byb2plY3RzQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgICRodHRwKHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIHVybDogJ2h0dHA6Ly93d3cudzNzY2hvb2xzLmNvbS9hbmd1bGFyL2N1c3RvbWVycy5waHAnXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgJHNjb3BlLm5hbWVzID0gcmVzcG9uc2UucmVjb3JkcztcbiAgICB9KTtcblxuICAgICRodHRwKHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgdXJsOiAnaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL2FuZ3VsYXIvY3VzdG9tZXJzLnBocCdcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc2NvcGUubmFtZXMgPSByZXNwb25zZS5yZWNvcmRzO1xuICAgIH0pO1xufV0pO1xuXG4vLyBTZXJ2aWNlcyBmb3IgYXV0aGVudGljYXRpb25cbmFwcC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIFsnJHdpbmRvdycsIGZ1bmN0aW9uICgkd2luZG93KXtcbiAgICB0aGlzLnBhcnNlSnd0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoJHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgICAgICB9IGVsc2UgcmV0dXJuIHt9O1xuICAgIH07XG5cbiAgICB0aGlzLnNhdmVUb2tlbiA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbiA9IHRva2VuO1xuICAgICAgICBjb25zb2xlLmxvZygnU2F2ZWQgdG9rZW46Jywkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbik7XG4gICAgfTtcblxuICAgIHRoaXMuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgdGhpcy5pc0F1dGhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gdGhpcy5nZXRUb2tlbigpO1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB0aGlzLnBhcnNlSnd0KHRva2VuKTtcbiAgICAgICAgICAgIHZhciBub3RFeHBpcmVkID0gTWF0aC5yb3VuZChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIDw9IHBhcmFtcy5leHA7XG4gICAgICAgICAgICBpZiAoIW5vdEV4cGlyZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vdEV4cGlyZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRlbGV0ZSAkd2luZG93LmxvY2FsU3RvcmFnZS5qd3RUb2tlbjtcbiAgICB9O1xuXG4gICAgLy8gZXhwb3NlIHVzZXIgYXMgYW4gb2JqZWN0XG4gICAgdGhpcy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUp3dCh0aGlzLmdldFRva2VuKCkpXG4gICAgfTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2F1dGhJbnRlcmNlcHRvcicsIFsnJHEnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRxLCAkbG9jYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhdXRoU2VydmljZS5pc0F1dGhlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGF1dGhTZXJ2aWNlLmdldFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuXG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIHRoZSBjYXNlIHdoZXJlIHRoZSB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XG4gICAgICAgIH0sIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
