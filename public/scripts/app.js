var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(e,t,o,r){o.html5Mode(!0),e.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),t.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl as ctrl"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("editAccountCtrl",["$scope","$http","$location","$rootScope",function(e,t,o,r){e.user=r.user;e.user={};e.updateUserInfo=function(e){console.log("Posting..."),t({method:"POST",url:"/modifyUser",data:e,dataType:"json"}).then(function(e){console.log(e),o.path("/calculator"),alert("Your account information has been changed.")},function(e){console.log("error"),alert("There was a problem processing your changes. Please try again later.")})}}]),app.controller("adminCtrl",["$http","$scope","$parse",function(e,t,o){function r(){var o=t.csv.result;console.log(o),e.post("/bulk",o).then(function(e){console.log(e)})}function n(t){var o=t.id;console.log(o),e.put("/suggestion/complete/"+o).then(function(e){a()})}function a(){e.get("/suggestion").then(function(e){var t=e.data;console.log(t),i.suggestions=t})}a();var i=this;i.suggestions="",i.markComplete=n,i.submitCSV=r,t.csv={content:null,header:!0,headerVisible:!0,separator:",",separatorVisible:!0,result:null,encoding:"ISO-8859-1",encodingVisible:!0};var l="";t.toPrettyJSON=function(e,t){var r=JSON.stringify(e),n=null;try{n=o(r)({})}catch(a){return l}var i=JSON.stringify(n,null,Number(t));return l=i,i}}]),app.controller("calculateCtrl",["$http","$mdDialog","$rootScope","authService","$location",function(e,t,o,r,n){function a(e){console.log("Text changed to ",e)}function i(e){void 0==e&&(f.category="",f.subcategory="",f.warmId="",f.weight="",f.item_description="",f.conversion="",f.result="")}function l(){var t={warmId:f.warmId||f.category.secondaries[0].warm_id,weight:parseFloat(f.weight)*f.conversion};e.post("/calculations",t).then(function(e){f.result=Math.floor(1e3*Math.abs(e.data))/1e3})}function s(){var t={category:f.category,subcategory:f.subcategory,warm_Id:f.warmId,weight:parseFloat(f.weight)*f.conversion,units:f.unit.name,item_description:f.item_description};console.log(t),e.post("/addToProject").then(function(e){console.log(e)})}function c(e){return e?f.list.filter(u(e)):f.list}function u(e){var t=e.toLowerCase();return function(e){return-1!=e.primary_cat.indexOf(t)}}function p(){e.post("/suggestion",f.suggestSubmission).then(function(e){t.hide()})}function d(e){t.show({templateUrl:"/views/suggest-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:f.searchText}})}function h(){e.post("/project",f.projectSubmission).then(function(e){t.hide()})}function g(e){t.show({templateUrl:"views/project-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl"})}o.user=r.getUser(),o.user&&o.user.username&&n.path("/"),e.get("/materials").then(function(e){var t=e.data;t.forEach(function(e){e.primary_cat=e.primary_cat.toLowerCase()}),f.list=t});var f=this;f.list="",f.isDisabled=!1,f.result="",f.querySearch=c,f.selectedItemChange=i,f.searchTextChange=a,f.newSuggestion=d,f.submitSuggestion=p,f.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],f.submission={email:"",material:"",notes:""},f.newCalculation=l,f.saveToProject=s,f.newProject=g,f.createProject=h}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(e,t,o){e.user={},e.processForm=function(r){console.log("Posting..."),t({method:"POST",url:"/register",data:e.user,dataType:"json"}).then(function(e){console.log(e),o.path("/login"),alert("Your account has been created.")})}}]),app.directive("ngCsvImport",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{content:"=?",header:"=?",headerVisible:"=?",separator:"=?",separatorVisible:"=?",result:"=?",encoding:"=?",encodingVisible:"=?"},template:'<div><div ng-show="headerVisible"><div class="label">Header</div><input type="checkbox" ng-model="header"></div><div ng-show="encoding && encodingVisible"><div class="label">Encoding</div><span>{{encoding}}</span></div><div ng-show="separator && separatorVisible"><div class="label">Seperator</div><span><input class="separator-input" type="text" ng-change="changeSeparator" ng-model="separator"><span></div><div><input class="btn cta gray" type="file"/></div></div>',link:function(e,t){e.separatorVisible=e.separatorVisible||!1,e.headerVisible=e.headerVisible||!1,angular.element(t[0].querySelector(".separator-input")).on("keyup",function(t){if(null!=e.content){var r={csv:e.content,header:e.header,separator:t.target.value,encoding:e.encoding};e.result=o(r),e.$apply()}}),t.on("change",function(t){var r=new FileReader;if(e.filename=t.target.files[0].name,r.onload=function(t){e.$apply(function(){var r={csv:t.target.result.replace(/\r\n|\r/g,"\n"),header:e.header,separator:e.separator};e.content=r.csv,e.result=o(r),e.result.filename=e.filename})},"file"!==t.target.type||null==t.target.files&&null==t.srcElement.files){if(null!=e.content){var n={csv:e.content,header:!e.header,separator:e.separator};e.result=o(n)}}else r.readAsText((t.srcElement||t.target).files[0],e.encoding)});var o=function(e){var t=e.csv.split("\n"),o=[],r=0,n=t[0].split(e.separator).length,a=[];e.header&&(a=t[0].split(e.separator),r=1);for(var i=r;i<t.length;i++){var l={},s=t[i].split(new RegExp(e.separator+'(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)'));if(s.length===n){if(e.header)for(var c=0;c<a.length;c++)l[a[c]]=s[c];else for(var u=0;u<s.length;u++)l[u]=s[u];o.push(l)}}return o}}}}),app.controller("dashboardCtrl",["$mdDialog","$rootScope","$scope","$http",function(e,t,o,r){var n=t.user;r.get("/project/"+n.id).then(function(e){o.projectList=e.data}),o.showDelete=function(t){console.log("CLICK");var r=e.confirm().title("Are you sure you want to delete your project?").content("This is permanent.").ariaLabel("Delete project permanently").ok("Delete").cancel("Cancel").targetEvent(t);e.show(r).then(function(){o.alert="Your project has been deleted."},function(){o.alert="Your project has not been deleted."})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(e,t,o,r,n){e.login=function(){t({method:"POST",url:"/login",data:e.form}).then(function(e){o.saveToken(e.data.token),n.user=o.getUser(),r.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(e,t,o,r,n){o.user=e.getUser(),o.user&&o.user.username&&r.path("/"),t.logout=function(){e.logout(),o.user=e.getUser(),r.path("/")}}]),app.controller("projectsCtrl",["$mdDialog","$scope","$rootScope","$http",function(e,t,o,r){function n(e){return e?c.projectList.filter(a(e)):c.projectList}function a(e){var t=e.toLowerCase();return function(e){return-1!=e.project_name.indexOf(t)}}function i(e){console.log("Text changed to ",e)}function l(e){void 0==e&&(c.project_name="",c.project_description="")}function s(){console.log("Deleting...",c.project_id)}var c=this;c.projectList=[{id:21,project_name:"ben's house",project_description:"Remodel",created_at:"2015-10-14T16:42:40.896Z",updated_at:"2015-10-14T16:42:40.901Z",user_id:4,category:"wood",sub_category:"oak",units:"lbs",weight:10,co2_offset:.03,project_id:6,item_description:"porch spindles"},{id:202,project_name:"james' house",project_description:"Teardown",created_at:"2014-10-14T16:42:40.896Z",updated_at:"2014-10-14T16:42:40.901Z",user_id:24,category:"asphalt shingles",sub_category:"null",units:"lbs",weight:100,co2_offset:.303,project_id:6,item_description:"roof shingles"},{id:2112,project_name:"kim's barn",project_description:"Remodel",created_at:"2013-10-14T16:42:40.896Z",updated_at:"2013-10-14T16:42:40.901Z",user_id:14,category:"wood flooring",sub_category:"pine",units:"lbs",weight:500,co2_offset:3.03,project_id:6,item_description:"barn wood"}],c.result="",c.querySearch=n,c.selectedItemChange=l,c.searchTextChange=i,c.projectTotal=0,c.deleteProjectItem=s,c.id=0,console.log(c.projectList),t.showDelete=function(o){console.log("CLICK");var r=e.confirm().title("Are you sure you want to delete this item?").content("This will be permanent.").ariaLabel("Delete item permanently").ok("Delete").cancel("Cancel").targetEvent(o);e.show(r).then(function(){t.alert="Your item has been deleted."},function(){t.alert="Your item has not been deleted."})}}]),app.service("authService",["$window",function(e){this.parseJwt=function(t){if(t){var o=t.split(".")[1],r=o.replace("-","+").replace("_","/");return JSON.parse(e.atob(r))}return{}},this.saveToken=function(t){e.localStorage.jwtToken=t,console.log("Saved token:",e.localStorage.jwtToken)},this.getToken=function(){return e.localStorage.jwtToken},this.isAuthed=function(){var e=this.getToken();if(e){var t=this.parseJwt(e),o=Math.round((new Date).getTime()/1e3)<=t.exp;return o||this.logout(),o}return!1},this.logout=function(){delete e.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.isAuthed()&&(e.headers.Authorization="Bearer "+o.getToken()),e},response:function(o){return 401===o.status&&t.path("/login"),o||e.when(o)},responseError:function(o){return 401===o.status?t.path("/login"):console.log(o),e.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzY3JpcHRzL2FjY291bnRDdHJsLmpzIiwic2NyaXB0cy9hZG1pbkN0cmwuanMiLCJzY3JpcHRzL2NhbGN1bGF0ZUN0cmwuanMiLCJzY3JpcHRzL2NyZWF0ZUFjY291bnRDdHJsLmpzIiwic2NyaXB0cy9jc3ZJbXBvcnQuanMiLCJzY3JpcHRzL2Rhc2hib2FyZEN0cmwuanMiLCJzY3JpcHRzL2xvZ2luQ3RybC5qcyIsInNjcmlwdHMvbmF2Q3RybC5qcyIsInNjcmlwdHMvcHJvamVjdHNDdHJsLmpzIiwic2NyaXB0cy9zZXJ2aWNlcy5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIiRodHRwUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsImRlZmF1bHQiLCJ3YXJuUGFsZXR0ZSIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiJHNjb3BlIiwiJGh0dHAiLCIkbG9jYXRpb24iLCIkcm9vdFNjb3BlIiwidXNlciIsInVwZGF0ZVVzZXJJbmZvIiwiY29uc29sZSIsImxvZyIsIm1ldGhvZCIsInVybCIsImRhdGEiLCJkYXRhVHlwZSIsInRoZW4iLCJyZXNwb25zZSIsInBhdGgiLCJhbGVydCIsImVycm9yIiwiJHBhcnNlIiwic3VibWl0Q1NWIiwiY3N2T2JqZWN0IiwiY3N2IiwicmVzdWx0IiwicG9zdCIsInJlcyIsIm1hcmtDb21wbGV0ZSIsInN1Z2dlc3Rpb24iLCJpZCIsInB1dCIsImluaXQiLCJnZXQiLCJzdWdnZXN0aW9ucyIsInNlbGYiLCJ0aGlzIiwiY29udGVudCIsImhlYWRlciIsImhlYWRlclZpc2libGUiLCJzZXBhcmF0b3IiLCJzZXBhcmF0b3JWaXNpYmxlIiwiZW5jb2RpbmciLCJlbmNvZGluZ1Zpc2libGUiLCJfbGFzdEdvb2RSZXN1bHQiLCJ0b1ByZXR0eUpTT04iLCJqc29uIiwidGFiV2lkdGgiLCJvYmpTdHIiLCJKU09OIiwic3RyaW5naWZ5Iiwib2JqIiwiZSIsIk51bWJlciIsIiRtZERpYWxvZyIsImF1dGhTZXJ2aWNlIiwic2VhcmNoVGV4dENoYW5nZSIsInRleHQiLCJzZWxlY3RlZEl0ZW1DaGFuZ2UiLCJpdGVtIiwidW5kZWZpbmVkIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1JZCIsIndlaWdodCIsIml0ZW1fZGVzY3JpcHRpb24iLCJjb252ZXJzaW9uIiwibmV3Q2FsY3VsYXRpb24iLCJjYWxjdWxhdGUiLCJzZWNvbmRhcmllcyIsIndhcm1faWQiLCJwYXJzZUZsb2F0IiwiTWF0aCIsImZsb29yIiwiYWJzIiwic2F2ZVRvUHJvamVjdCIsImxpbmVJdGVtIiwid2FybV9JZCIsInVuaXRzIiwidW5pdCIsIm5hbWUiLCJxdWVyeVNlYXJjaCIsInF1ZXJ5IiwibGlzdCIsImZpbHRlciIsImNyZWF0ZUZpbHRlckZvciIsImxvd2VyY2FzZVF1ZXJ5IiwidG9Mb3dlckNhc2UiLCJwcmltYXJ5X2NhdCIsImluZGV4T2YiLCJzdWJtaXRTdWdnZXN0aW9uIiwic3VnZ2VzdFN1Ym1pc3Npb24iLCJoaWRlIiwibmV3U3VnZ2VzdGlvbiIsInNob3ciLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiY29udHJvbGxlckFzIiwibG9jYWxzIiwibWF0ZXJpYWwiLCJzZWFyY2hUZXh0IiwiY3JlYXRlUHJvamVjdCIsInByb2plY3RTdWJtaXNzaW9uIiwibmV3UHJvamVjdCIsImdldFVzZXIiLCJ1c2VybmFtZSIsImZvckVhY2giLCJpc0Rpc2FibGVkIiwic3VibWlzc2lvbiIsImVtYWlsIiwibm90ZXMiLCJwcm9jZXNzRm9ybSIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwidHJhbnNjbHVkZSIsInJlcGxhY2UiLCJzY29wZSIsInRlbXBsYXRlIiwibGluayIsImVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib24iLCJ0YXJnZXQiLCJ2YWx1ZSIsImNzdlRvSlNPTiIsIiRhcHBseSIsIm9uQ2hhbmdlRXZlbnQiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwiZmlsZW5hbWUiLCJmaWxlcyIsIm9ubG9hZCIsIm9uTG9hZEV2ZW50IiwidHlwZSIsInNyY0VsZW1lbnQiLCJyZWFkQXNUZXh0IiwibGluZXMiLCJzcGxpdCIsInN0YXJ0IiwiY29sdW1uQ291bnQiLCJsZW5ndGgiLCJoZWFkZXJzIiwiaSIsImN1cnJlbnRsaW5lIiwiUmVnRXhwIiwiaiIsImsiLCJwdXNoIiwicHJvamVjdExpc3QiLCJzaG93RGVsZXRlIiwiZXYiLCJjb25maXJtIiwidGl0bGUiLCJhcmlhTGFiZWwiLCJvayIsImNhbmNlbCIsInRhcmdldEV2ZW50IiwibG9naW4iLCJmb3JtIiwic2F2ZVRva2VuIiwidG9rZW4iLCJsb2dvdXQiLCJwcm9qZWN0X25hbWUiLCJwcm9qZWN0X2Rlc2NyaXB0aW9uIiwiZGVsZXRlUHJvamVjdEl0ZW0iLCJwcm9qZWN0X2lkIiwiY3JlYXRlZF9hdCIsInVwZGF0ZWRfYXQiLCJ1c2VyX2lkIiwic3ViX2NhdGVnb3J5IiwiY28yX29mZnNldCIsInByb2plY3RUb3RhbCIsInNlcnZpY2UiLCIkd2luZG93IiwicGFyc2VKd3QiLCJiYXNlNjRVcmwiLCJiYXNlNjQiLCJwYXJzZSIsImF0b2IiLCJsb2NhbFN0b3JhZ2UiLCJqd3RUb2tlbiIsImdldFRva2VuIiwiaXNBdXRoZWQiLCJwYXJhbXMiLCJub3RFeHBpcmVkIiwicm91bmQiLCJEYXRlIiwiZ2V0VGltZSIsImV4cCIsImZhY3RvcnkiLCIkcSIsInJlcXVlc3QiLCJBdXRob3JpemF0aW9uIiwic3RhdHVzIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxjQUFBLFVBQUEsYUFBQSxhQUFBLG9CQUVBRixLQUFBRyxRQUFBLHFCQUFBLGlCQUFBLG9CQUFB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YUFDQWpNLEVBQUF3SixRQUFBbUQsY0FBQSxVQUFBeEksRUFBQTZILFlBRUFoTSxHQUVBNkIsU0FBQSxTQUFBQSxHQU9BLE1BTEEsT0FBQUEsRUFBQStLLFFBR0ExTCxFQUFBWSxLQUFBLFVBRUFELEdBQUE0SyxFQUFBOUwsS0FBQWtCLElBQ0FnTCxjQUFBLFNBQUFoTCxHQU9BLE1BTkEsT0FBQUEsRUFBQStLLE9BQ0ExTCxFQUFBWSxLQUFBLFVBR0FSLFFBQUFDLElBQUFNLEdBRUE0SyxFQUFBSyxPQUFBakwiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiICAgIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZWNvdG9uZUFwcCcsIFsnbmdSb3V0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnLCAndmFsaWRhdGlvbi5tYXRjaCddKTtcblxuYXBwLmNvbmZpZyhbJyRtZFRoZW1pbmdQcm92aWRlcicsICckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJG1kVGhlbWluZ1Byb3ZpZGVyLCAkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpe1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vc2V0IHRoZW1lIGFuZCBjb2xvciBwYWxldHRlXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcbiAgICAgICAgLnByaW1hcnlQYWxldHRlKCdncmVlbicpXG4gICAgICAgIC5hY2NlbnRQYWxldHRlKCdibHVlLWdyZXknLCB7J2RlZmF1bHQnOic2MDAnfSlcbiAgICAgICAgLndhcm5QYWxldHRlICgnb3JhbmdlJyk7XG5cbiAgICAvL3JvdXRlcyBmb3Igdmlld3NcbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY2FsY3VsYXRvci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsIGFzIGN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9sb2dpbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICAgICAgfSkud2hlbignL3JlZ2lzdGVyJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcmVnaXN0ZXIuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY3JlYXRlQWNjb3VudEN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9hZG1pbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2FkbWluLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2FkbWluQ3RybCBhcyBjdHJsJ1xuXG4gICAgICAgIH0pLndoZW4oJy9hY2NvdW50JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWNjb3VudC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9kYXNoYm9hcmQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfSkud2hlbignL3Byb2plY3RzJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcHJvamVjdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL3NvdXJjZXMnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zb3VyY2VzLmh0bWwnXG4gICAgICAgIH0pLm90aGVyd2lzZSh7XG4gICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgfSk7XG5cbiAgICAvLyRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ2F1dGhJbnRlcmNlcHRvcicpO1xufV0pOyIsIlxuLy8gRWRpdCBhY2NvdW50IGluZm8gSFRNTCAtIEtpbVxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRBY2NvdW50Q3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLnVzZXIgPSAkcm9vdFNjb3BlLnVzZXI7XG4gICAgdmFyIGluZm9Ub1VwZGF0ZSA9XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS51cGRhdGVVc2VySW5mbyA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvbW9kaWZ5VXNlcicsXG4gICAgICAgICAgICBkYXRhOiB1c2VyLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9jYWxjdWxhdG9yJyk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBpbmZvcm1hdGlvbiBoYXMgYmVlbiBjaGFuZ2VkLlwiKVxuICAgICAgICB9LCBmdW5jdGlvbihlcnJvcil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InKTtcbiAgICAgICAgICAgIGFsZXJ0KFwiVGhlcmUgd2FzIGEgcHJvYmxlbSBwcm9jZXNzaW5nIHlvdXIgY2hhbmdlcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIilcbiAgICAgICAgfSk7XG4gICAgfTtcbn1dKTsiLCIvKipcbiAqIEFETUlOXG4gKi9cbmFwcC5jb250cm9sbGVyKCdhZG1pbkN0cmwnLCBbJyRodHRwJywgJyRzY29wZScsJyRwYXJzZScsIGZ1bmN0aW9uKCAkaHR0cCwgJHNjb3BlLCAkcGFyc2UgKXtcbiAgICAvLyBJTklUXG4gICAgaW5pdCgpO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuc3VnZ2VzdGlvbnMgPSAnJztcbiAgICBzZWxmLm1hcmtDb21wbGV0ZSA9IG1hcmtDb21wbGV0ZTtcbiAgICBzZWxmLnN1Ym1pdENTViA9IHN1Ym1pdENTVjtcblxuICAgIGZ1bmN0aW9uIHN1Ym1pdENTViggKXtcbiAgICAgICAgdmFyIGNzdk9iamVjdCA9ICRzY29wZS5jc3YucmVzdWx0O1xuICAgICAgICBjb25zb2xlLmxvZyhjc3ZPYmplY3QpO1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9idWxrJywgY3N2T2JqZWN0KS50aGVuKGZ1bmN0aW9uKCByZXMgKXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFya0NvbXBsZXRlKCBzdWdnZXN0aW9uICkge1xuICAgICAgICB2YXIgaWQgPSBzdWdnZXN0aW9uLmlkO1xuICAgICAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgICAgICRodHRwLnB1dCgnL3N1Z2dlc3Rpb24vY29tcGxldGUvJyArIGlkKS50aGVuKGZ1bmN0aW9uKCByZXMgKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICRodHRwLmdldCgnL3N1Z2dlc3Rpb24nKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIHZhciBzdWdnZXN0aW9ucyA9IHJlcy5kYXRhO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgc2VsZi5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuY3N2ID0ge1xuICAgICAgICBjb250ZW50OiBudWxsLFxuICAgICAgICBoZWFkZXI6IHRydWUsXG4gICAgICAgIGhlYWRlclZpc2libGU6IHRydWUsXG4gICAgICAgIHNlcGFyYXRvcjogJywnLFxuICAgICAgICBzZXBhcmF0b3JWaXNpYmxlOiB0cnVlLFxuICAgICAgICByZXN1bHQ6IG51bGwsXG4gICAgICAgIGVuY29kaW5nOiAnSVNPLTg4NTktMScsXG4gICAgICAgIGVuY29kaW5nVmlzaWJsZTogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdmFyIF9sYXN0R29vZFJlc3VsdCA9ICcnO1xuICAgICRzY29wZS50b1ByZXR0eUpTT04gPSBmdW5jdGlvbiAoanNvbiwgdGFiV2lkdGgpIHtcbiAgICAgICAgdmFyIG9ialN0ciA9IEpTT04uc3RyaW5naWZ5KGpzb24pO1xuICAgICAgICB2YXIgb2JqID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9iaiA9ICRwYXJzZShvYmpTdHIpKHt9KTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIGVhdCAkcGFyc2UgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBfbGFzdEdvb2RSZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkob2JqLCBudWxsLCBOdW1iZXIodGFiV2lkdGgpKTtcbiAgICAgICAgX2xhc3RHb29kUmVzdWx0ID0gcmVzdWx0O1xuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxufV0pOyIsImFwcC5jb250cm9sbGVyKCdjYWxjdWxhdGVDdHJsJywgWyckaHR0cCcsICckbWREaWFsb2cnLCAnJHJvb3RTY29wZScsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCBmdW5jdGlvbiggJGh0dHAsICRtZERpYWxvZywgJHJvb3RTY29wZSwgYXV0aFNlcnZpY2UsICRsb2NhdGlvbiApIHtcblxuICAgIC8vIENoZWNrIHVzZXJcbiAgICAkcm9vdFNjb3BlLnVzZXIgPSBhdXRoU2VydmljZS5nZXRVc2VyKCk7XG5cbiAgICBpZigkcm9vdFNjb3BlLnVzZXIgJiYgJHJvb3RTY29wZS51c2VyLnVzZXJuYW1lKXtcbiAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICB9XG5cbiAgICAvLyBJTklUXG4gICAgJGh0dHAuZ2V0KCcvbWF0ZXJpYWxzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICB2YXIgbGlzdCA9IHJlc3BvbnNlLmRhdGE7XG5cbiAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgICAgaXRlbS5wcmltYXJ5X2NhdCA9IGl0ZW0ucHJpbWFyeV9jYXQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIC8vIC9pdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGl0ZW0ucHJpbWFyeV9jYXQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgc2VsZi5saXN0ID0gbGlzdDtcblxuICAgIH0pO1xuXG4gICAgLy8gU2VsZiBkZWNcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICBzZWxmLmxpc3QgPSAnJztcbiAgICBzZWxmLmlzRGlzYWJsZWQgPSBmYWxzZTtcbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgICA9IHNlYXJjaFRleHRDaGFuZ2U7XG4gICAgc2VsZi5uZXdTdWdnZXN0aW9uID0gbmV3U3VnZ2VzdGlvbjtcbiAgICBzZWxmLnN1Ym1pdFN1Z2dlc3Rpb24gPSBzdWJtaXRTdWdnZXN0aW9uO1xuICAgIHNlbGYudW5pdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMC4wMDA1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdraWxvcycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMTEwMjMxXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ21ldHJpYyB0b25zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDEuMTAyMzFcbiAgICAgICAgfVxuICAgIF07XG4gICAgc2VsZi5zdWJtaXNzaW9uID0ge1xuICAgICAgICBlbWFpbDogJycsXG4gICAgICAgIG1hdGVyaWFsOiAnJyxcbiAgICAgICAgbm90ZXM6ICcnXG4gICAgfTtcbiAgICBzZWxmLm5ld0NhbGN1bGF0aW9uID0gbmV3Q2FsY3VsYXRpb247XG4gICAgc2VsZi5zYXZlVG9Qcm9qZWN0ID0gc2F2ZVRvUHJvamVjdDtcbiAgICBzZWxmLm5ld1Byb2plY3QgPSBuZXdQcm9qZWN0O1xuICAgIHNlbGYuY3JlYXRlUHJvamVjdCA9IGNyZWF0ZVByb2plY3Q7XG5cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLnN1YmNhdGVnb3J5ID0gJyc7XG4gICAgICAgICAgICBzZWxmLndhcm1JZCA9ICcnO1xuICAgICAgICAgICAgc2VsZi53ZWlnaHQgPSAnJztcbiAgICAgICAgICAgIHNlbGYuaXRlbV9kZXNjcmlwdGlvbiA9ICcnO1xuICAgICAgICAgICAgc2VsZi5jb252ZXJzaW9uID0gJyc7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3Q2FsY3VsYXRpb24oKSB7XG5cbiAgICAgICAgdmFyIGNhbGN1bGF0ZSA9IHtcbiAgICAgICAgICAgIHdhcm1JZDogc2VsZi53YXJtSWQgfHwgc2VsZi5jYXRlZ29yeS5zZWNvbmRhcmllc1swXS53YXJtX2lkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSAqIHNlbGYuY29udmVyc2lvblxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9jYWxjdWxhdGlvbnMnLCBjYWxjdWxhdGUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHNlbGYucmVzdWx0ID0gTWF0aC5mbG9vcihNYXRoLmFicyhyZXNwb25zZS5kYXRhKSAqIDEwMDApIC8gMTAwMDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVRvUHJvamVjdCgpe1xuICAgICAgICB2YXIgbGluZUl0ZW0gPSB7XG4gICAgICAgICAgICBjYXRlZ29yeTogc2VsZi5jYXRlZ29yeSxcbiAgICAgICAgICAgIHN1YmNhdGVnb3J5OiBzZWxmLnN1YmNhdGVnb3J5LFxuICAgICAgICAgICAgd2FybV9JZDogc2VsZi53YXJtSWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoc2VsZi53ZWlnaHQpKnNlbGYuY29udmVyc2lvbixcbiAgICAgICAgICAgIHVuaXRzOiBzZWxmLnVuaXQubmFtZSxcbiAgICAgICAgICAgIGl0ZW1fZGVzY3JpcHRpb246IHNlbGYuaXRlbV9kZXNjcmlwdGlvblxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhsaW5lSXRlbSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9hZGRUb1Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYubGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiBzZWxmLmxpc3Q7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmoucHJpbWFyeV9jYXQuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFN1Z2dlc3Rpb24oKXtcbiAgICAgICAgJGh0dHAucG9zdCgnL3N1Z2dlc3Rpb24nLCBzZWxmLnN1Z2dlc3RTdWJtaXNzaW9uKS50aGVuKGZ1bmN0aW9uKCByZXMgKXtcbiAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5ld1N1Z2dlc3Rpb24oIHN1Z2dlc3Rpb24gKXtcblxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zdWdnZXN0LW1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgICAgICAgICAgbG9jYWxzOiB7bWF0ZXJpYWw6IHNlbGYuc2VhcmNoVGV4dH1cbiAgICAgICAgfSlcblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QoKSB7XG4gICAgICAgICRodHRwLnBvc3QoJy9wcm9qZWN0Jywgc2VsZi5wcm9qZWN0U3VibWlzc2lvbikudGhlbihmdW5jdGlvbihyZXMpe1xuICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXdQcm9qZWN0KCBuZXdQcm9qZWN0ICl7XG5cbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wcm9qZWN0LW1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnXG4gICAgICAgIH0pXG5cbiAgICB9XG5cbn1dKTsiLCIvLyBSZWdpc3RlciBIVE1MIC0gTWFkZWxpbmVcbmFwcC5jb250cm9sbGVyKCdjcmVhdGVBY2NvdW50Q3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbikge1xuICAgICRzY29wZS51c2VyID0ge307XG5cbiAgICAkc2NvcGUucHJvY2Vzc0Zvcm0gPSBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlBvc3RpbmcuLi5cIik7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgICAgICAgIGRhdGE6ICRzY29wZS51c2VyLFxuICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJ1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xuICAgICAgICAgICAgYWxlcnQoXCJZb3VyIGFjY291bnQgaGFzIGJlZW4gY3JlYXRlZC5cIilcbiAgICAgICAgfSlcbiAgICB9O1xufV0pOyIsImFwcC5kaXJlY3RpdmUoJ25nQ3N2SW1wb3J0JywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgdHJhbnNjbHVkZTogdHJ1ZSxcbiAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgc2NvcGU6e1xuICAgICAgICAgICAgY29udGVudDonPT8nLFxuICAgICAgICAgICAgaGVhZGVyOiAnPT8nLFxuICAgICAgICAgICAgaGVhZGVyVmlzaWJsZTogJz0/JyxcbiAgICAgICAgICAgIHNlcGFyYXRvcjogJz0/JyxcbiAgICAgICAgICAgIHNlcGFyYXRvclZpc2libGU6ICc9PycsXG4gICAgICAgICAgICByZXN1bHQ6ICc9PycsXG4gICAgICAgICAgICBlbmNvZGluZzogJz0/JyxcbiAgICAgICAgICAgIGVuY29kaW5nVmlzaWJsZTogJz0/J1xuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZTogJzxkaXY+PGRpdiBuZy1zaG93PVwiaGVhZGVyVmlzaWJsZVwiPjxkaXYgY2xhc3M9XCJsYWJlbFwiPkhlYWRlcjwvZGl2PjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBuZy1tb2RlbD1cImhlYWRlclwiPjwvZGl2PicrXG4gICAgICAgICc8ZGl2IG5nLXNob3c9XCJlbmNvZGluZyAmJiBlbmNvZGluZ1Zpc2libGVcIj48ZGl2IGNsYXNzPVwibGFiZWxcIj5FbmNvZGluZzwvZGl2PjxzcGFuPnt7ZW5jb2Rpbmd9fTwvc3Bhbj48L2Rpdj4nK1xuICAgICAgICAnPGRpdiBuZy1zaG93PVwic2VwYXJhdG9yICYmIHNlcGFyYXRvclZpc2libGVcIj48ZGl2IGNsYXNzPVwibGFiZWxcIj5TZXBlcmF0b3I8L2Rpdj48c3Bhbj48aW5wdXQgY2xhc3M9XCJzZXBhcmF0b3ItaW5wdXRcIiB0eXBlPVwidGV4dFwiIG5nLWNoYW5nZT1cImNoYW5nZVNlcGFyYXRvclwiIG5nLW1vZGVsPVwic2VwYXJhdG9yXCI+PHNwYW4+PC9kaXY+JytcbiAgICAgICAgJzxkaXY+PGlucHV0IGNsYXNzPVwiYnRuIGN0YSBncmF5XCIgdHlwZT1cImZpbGVcIi8+PC9kaXY+PC9kaXY+JyxcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHNjb3BlLnNlcGFyYXRvclZpc2libGUgPSBzY29wZS5zZXBhcmF0b3JWaXNpYmxlIHx8IGZhbHNlO1xuICAgICAgICAgICAgc2NvcGUuaGVhZGVyVmlzaWJsZSA9IHNjb3BlLmhlYWRlclZpc2libGUgfHwgZmFsc2U7XG5cbiAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3IoJy5zZXBhcmF0b3ItaW5wdXQnKSkub24oJ2tleXVwJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIGlmICggc2NvcGUuY29udGVudCAhPSBudWxsICkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNzdjogc2NvcGUuY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogc2NvcGUuaGVhZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VwYXJhdG9yOiBlLnRhcmdldC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuY29kaW5nOiBzY29wZS5lbmNvZGluZ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5yZXN1bHQgPSBjc3ZUb0pTT04oY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlbGVtZW50Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihvbkNoYW5nZUV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgICAgICAgICAgc2NvcGUuZmlsZW5hbWUgPSBvbkNoYW5nZUV2ZW50LnRhcmdldC5maWxlc1swXS5uYW1lO1xuICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihvbkxvYWRFdmVudCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3Y6IG9uTG9hZEV2ZW50LnRhcmdldC5yZXN1bHQucmVwbGFjZSgvXFxyXFxufFxcci9nLCdcXG4nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IHNjb3BlLmhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXBhcmF0b3I6IHNjb3BlLnNlcGFyYXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNvbnRlbnQgPSBjb250ZW50LmNzdjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VsdCA9IGNzdlRvSlNPTihjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VsdC5maWxlbmFtZSA9IHNjb3BlLmZpbGVuYW1lO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKCAob25DaGFuZ2VFdmVudC50YXJnZXQudHlwZSA9PT0gXCJmaWxlXCIpICYmIChvbkNoYW5nZUV2ZW50LnRhcmdldC5maWxlcyAhPSBudWxsIHx8IG9uQ2hhbmdlRXZlbnQuc3JjRWxlbWVudC5maWxlcyAhPSBudWxsKSApICB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KChvbkNoYW5nZUV2ZW50LnNyY0VsZW1lbnQgfHwgb25DaGFuZ2VFdmVudC50YXJnZXQpLmZpbGVzWzBdLCBzY29wZS5lbmNvZGluZyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBzY29wZS5jb250ZW50ICE9IG51bGwgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjc3Y6IHNjb3BlLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAhc2NvcGUuaGVhZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcGFyYXRvcjogc2NvcGUuc2VwYXJhdG9yXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzdWx0ID0gY3N2VG9KU09OKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHZhciBjc3ZUb0pTT04gPSBmdW5jdGlvbihjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpbmVzPWNvbnRlbnQuY3N2LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgY29sdW1uQ291bnQgPSBsaW5lc1swXS5zcGxpdChjb250ZW50LnNlcGFyYXRvcikubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAoY29udGVudC5oZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1saW5lc1swXS5zcGxpdChjb250ZW50LnNlcGFyYXRvcik7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gMTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPXN0YXJ0OyBpPGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRsaW5lPWxpbmVzW2ldLnNwbGl0KG5ldyBSZWdFeHAoY29udGVudC5zZXBhcmF0b3IrJyg/IVteXCJdKlwiKD86KD86W15cIl0qXCIpezJ9KSpbXlwiXSokKScpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50bGluZS5sZW5ndGggPT09IGNvbHVtbkNvdW50ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQuaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaj0wOyBqPGhlYWRlcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW2hlYWRlcnNbal1dID0gY3VycmVudGxpbmVbal07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrPTA7IGs8Y3VycmVudGxpbmUubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW2tdID0gY3VycmVudGxpbmVba107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH19KTsiLCJhcHAuY29udHJvbGxlcignZGFzaGJvYXJkQ3RybCcsIFsnJG1kRGlhbG9nJywgJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJG1kRGlhbG9nLCAkcm9vdFNjb3BlLCAkc2NvcGUsICRodHRwKSB7XG4gICAgdmFyIHVzZXI9JHJvb3RTY29wZS51c2VyO1xuXG5cbiAgICAvL2xvYWQgcHJvamVjdCBsaXN0IG9uIHBhZ2UgbG9hZFxuICAgICRodHRwLmdldCgnL3Byb2plY3QvJyArIHVzZXIuaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgJHNjb3BlLnByb2plY3RMaXN0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgLy9yZXNwb25zZS5kYXRhLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgIC8vICAgIGl0ZW0ucHJvamVjdF9uYW1lID0gaXRlbS5wcmltYXJ5X2NhdC50b0xvd2VyQ2FzZSgpO1xuICAgIH0pO1xuLy90aGlzIGlzIGZvciB0aGUgZGVsZXRlIG1vZGFsIGFsZXJ0IGZvciBkZWxldGluZyBhIHByb2plY3QtLSBzdGlsbCBub3Qgd29ya2luZyBjb3JyZWN0XG5cbiAgICAkc2NvcGUuc2hvd0RlbGV0ZSA9IGZ1bmN0aW9uKGV2KSB7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ0NMSUNLJyk7XG4gICAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxuICAgICAgICAgICAgLnRpdGxlKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHlvdXIgcHJvamVjdD8nKVxuICAgICAgICAgICAgLmNvbnRlbnQoJ1RoaXMgaXMgcGVybWFuZW50LicpXG4gICAgICAgICAgICAuYXJpYUxhYmVsKCdEZWxldGUgcHJvamVjdCBwZXJtYW5lbnRseScpXG4gICAgICAgICAgICAub2soJ0RlbGV0ZScpXG4gICAgICAgICAgICAuY2FuY2VsKCdDYW5jZWwnKVxuICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIHByb2plY3QgaGFzIGJlZW4gZGVsZXRlZC4nO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIHByb2plY3QgaGFzIG5vdCBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vbmVlZCB0byBjaGVjayBpZiB3ZSBuZWVkIHRoaXMhXG4vLyAgICBmdW5jdGlvbiBEaWFsb2dDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nKSB7XG4vLyAgICAkc2NvcGUuaGlkZSA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4vLyAgICB9O1xuLy8gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuYW5zd2VyID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbi8vICAgIH07XG4vL31cblxufV0pOyIsIi8vIExvZ2luIEhUTUwgLSBLYXRlXG5hcHAuY29udHJvbGxlcignbG9naW5DdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnYXV0aFNlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBhdXRoU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgICAgICBkYXRhOiAkc2NvcGUuZm9ybVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnNhdmVUb2tlbihyZXNwb25zZS5kYXRhLnRva2VuKTtcbiAgICAgICAgICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XG4gICAgICAgIH0pXG4gICAgfVxufV0pOyIsIi8vIENoYW5nZSBOYXZpZ2F0aW9uIE9wdGlvbnMgd2l0aCBMb2dpblxuYXBwLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBbJ2F1dGhTZXJ2aWNlJywgJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICckaHR0cCcsIGZ1bmN0aW9uKGF1dGhTZXJ2aWNlLCAkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJGh0dHApe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cbn1dKTtcbiIsIi8vIFByb2plY3QgUGFnZSAtICBLaW0vTWFkZWxlaW5lXG5hcHAuY29udHJvbGxlcigncHJvamVjdHNDdHJsJywgWyckbWREaWFsb2cnLCAnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGh0dHAnLCBmdW5jdGlvbigkbWREaWFsb2csICRzY29wZSwgJHJvb3RTY29wZSwgJGh0dHApIHtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYucHJvamVjdExpc3QgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZDogMjEsXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RfbmFtZTogXCJiZW4ncyBob3VzZVwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlJlbW9kZWxcIixcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogXCIyMDE1LTEwLTE0VDE2OjQyOjQwLjg5NlpcIixcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogXCIyMDE1LTEwLTE0VDE2OjQyOjQwLjkwMVpcIixcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogNCxcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnk6IFwid29vZFwiLFxuICAgICAgICAgICAgICAgICAgICBzdWJfY2F0ZWdvcnk6IFwib2FrXCIsXG4gICAgICAgICAgICAgICAgICAgIHVuaXRzOiBcImxic1wiLFxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IDEwLFxuICAgICAgICAgICAgICAgICAgICBjbzJfb2Zmc2V0OiAwLjAzLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgICAgICAgICAgICAgICAgICBpdGVtX2Rlc2NyaXB0aW9uOiBcInBvcmNoIHNwaW5kbGVzXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IDIwMixcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdF9uYW1lOiBcImphbWVzJyBob3VzZVwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlRlYXJkb3duXCIsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IFwiMjAxNC0xMC0xNFQxNjo0Mjo0MC44OTZaXCIsXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IFwiMjAxNC0xMC0xNFQxNjo0Mjo0MC45MDFaXCIsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJfaWQ6IDI0LFxuICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeTogXCJhc3BoYWx0IHNoaW5nbGVzXCIsXG4gICAgICAgICAgICAgICAgICAgIHN1Yl9jYXRlZ29yeTogXCJudWxsXCIsXG4gICAgICAgICAgICAgICAgICAgIHVuaXRzOiBcImxic1wiLFxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgY28yX29mZnNldDogMC4zMDMsXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RfaWQ6IDYsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1fZGVzY3JpcHRpb246IFwicm9vZiBzaGluZ2xlc1wiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAyMTEyLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X25hbWU6IFwia2ltJ3MgYmFyblwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlJlbW9kZWxcIixcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZF9hdDogXCIyMDEzLTEwLTE0VDE2OjQyOjQwLjg5NlpcIixcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogXCIyMDEzLTEwLTE0VDE2OjQyOjQwLjkwMVpcIixcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogMTQsXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiBcIndvb2QgZmxvb3JpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgc3ViX2NhdGVnb3J5OiBcInBpbmVcIixcbiAgICAgICAgICAgICAgICAgICAgdW5pdHM6IFwibGJzXCIsXG4gICAgICAgICAgICAgICAgICAgIHdlaWdodDogNTAwLFxuICAgICAgICAgICAgICAgICAgICBjbzJfb2Zmc2V0OiAzLjAzLFxuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgICAgICAgICAgICAgICAgICBpdGVtX2Rlc2NyaXB0aW9uOiBcImJhcm4gd29vZFwiXG4gICAgICAgICAgICAgICAgfV07XG5cbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgPSBzZWFyY2hUZXh0Q2hhbmdlO1xuICAgIHNlbGYucHJvamVjdFRvdGFsID0gMDtcbiAgICBzZWxmLmRlbGV0ZVByb2plY3RJdGVtID0gZGVsZXRlUHJvamVjdEl0ZW07XG4gICAgc2VsZi5pZCA9IDA7XG5cbmNvbnNvbGUubG9nKHNlbGYucHJvamVjdExpc3QpO1xuXG4gICAgLy9yZWZyZXNoIHByb2plY3QgbGlzdFxuICAgIC8vZnVuY3Rpb24gZ2V0UHJvamVjdExpc3QoKSB7XG4gICAgLy8gICAgJGh0dHAuZ2V0KCcvcHJvamVjdCcsICRyb290U2NvcGUudXNlci5pZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAvLyAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgIC8vICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIgaWQ6IFwiLCAkcm9vdFNjb3BlLnVzZXIuaWQpO1xuICAgIC8vICAgICAgICB2YXIgcHJvamVjdExpc3QgPSByZXNwb25zZS5kYXRhO1xuICAgIC8vICAgICAgICBwcm9qZWN0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgLy8gICAgICAgICAgICBpdGVtLnByb2plY3RfbmFtZSA9IGl0ZW0ucHJvamVjdF9uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgLy8gICAgICAgICAgICAvL2l0ZW0ucHJvamVjdF9kZXNjcmlwdGlvbiA9IGl0ZW0ucHJvamVjdF9kZXNjcmlwdGlvbjtcbiAgICAvLyAgICAgICAgICAgIC8vaXRlbS5pdGVtSWQgPSBpdGVtLmlkO1xuICAgIC8vICAgICAgICAgICAgLy9pdGVtLmNvMl9vZmZzZXQgPSBpdGVtLmNvMl9vZmZzZXQ7XG4gICAgLy8gICAgICAgIH0pO1xuICAgIC8vICAgICAgICBzZWxmLnByb2plY3RMaXN0ID0gcHJvamVjdExpc3Q7XG4gICAgLy8gICAgfSk7XG4gICAgLy99XG5cbiAgICAvL2xvYWQgcHJvamVjdCBsaXN0IG9uIHBhZ2UgbG9hZFxuICAgIC8vZ2V0UHJvamVjdExpc3QoKTtcblxuICAgIC8vZnVuY3Rpb24gZ2V0UHJvamVjdExpc3QoKXtcbiAgICAvLyAgICBjb25zb2xlLmxvZyhcIlByb2plY3QgbGlzdCBsb2FkZWQ6IFwiLCBzZWxmLnByb2plY3RMaXN0KTtcbiAgICAvLyAgICBwcm9qZWN0TGlzdCA9IFtcbiAgICAvLyAgICAgICAge1xuICAgIC8vICAgICAgICAgICAgaWQ6IDIxLFxuICAgIC8vICAgICAgICAgICAgcHJvamVjdF9uYW1lOiBcIkJlbidzIEhvdXNlXCIsXG4gICAgLy8gICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlJlbW9kZWxcIixcbiAgICAvLyAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IFwiMjAxNS0xMC0xNFQxNjo0Mjo0MC44OTZaXCIsXG4gICAgLy8gICAgICAgICAgICB1cGRhdGVkX2F0OiBcIjIwMTUtMTAtMTRUMTY6NDI6NDAuOTAxWlwiLFxuICAgIC8vICAgICAgICAgICAgdXNlcl9pZDogNCxcbiAgICAvLyAgICAgICAgICAgIGNhdGVnb3J5OiBcIndvb2RcIixcbiAgICAvLyAgICAgICAgICAgIHN1Yl9jYXRlZ29yeTogXCJvYWtcIixcbiAgICAvLyAgICAgICAgICAgIHVuaXRzOiBcImxic1wiLFxuICAgIC8vICAgICAgICAgICAgd2VpZ2h0OiAxMCxcbiAgICAvLyAgICAgICAgICAgIGNvMl9vZmZzZXQ6IDAuMDMsXG4gICAgLy8gICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgIC8vICAgICAgICAgICAgaXRlbV9kZXNjcmlwdGlvbjogXCJwb3JjaCBzcGluZGxlc1wiXG4gICAgLy8gICAgICAgIH0sXG4gICAgLy8gICAgICAgIHtcbiAgICAvLyAgICAgICAgICAgIGlkOiAyMDIsXG4gICAgLy8gICAgICAgICAgICBwcm9qZWN0X25hbWU6IFwiSmFtZXMnIEhvdXNlXCIsXG4gICAgLy8gICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlRlYXJkb3duXCIsXG4gICAgLy8gICAgICAgICAgICBjcmVhdGVkX2F0OiBcIjIwMTQtMTAtMTRUMTY6NDI6NDAuODk2WlwiLFxuICAgIC8vICAgICAgICAgICAgdXBkYXRlZF9hdDogXCIyMDE0LTEwLTE0VDE2OjQyOjQwLjkwMVpcIixcbiAgICAvLyAgICAgICAgICAgIHVzZXJfaWQ6IDI0LFxuICAgIC8vICAgICAgICAgICAgY2F0ZWdvcnk6IFwiYXNwaGFsdCBzaGluZ2xlc1wiLFxuICAgIC8vICAgICAgICAgICAgc3ViX2NhdGVnb3J5OiBcIm51bGxcIixcbiAgICAvLyAgICAgICAgICAgIHVuaXRzOiBcImxic1wiLFxuICAgIC8vICAgICAgICAgICAgd2VpZ2h0OiAxMDAsXG4gICAgLy8gICAgICAgICAgICBjbzJfb2Zmc2V0OiAwLjMwMyxcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfaWQ6IDYsXG4gICAgLy8gICAgICAgICAgICBpdGVtX2Rlc2NyaXB0aW9uOiBcInJvb2Ygc2hpbmdsZXNcIlxuICAgIC8vICAgICAgICB9LFxuICAgIC8vICAgICAgICB7XG4gICAgLy8gICAgICAgICAgICBpZDogMjExMixcbiAgICAvLyAgICAgICAgICAgIHByb2plY3RfbmFtZTogXCJLaW0ncyBCYXJuXCIsXG4gICAgLy8gICAgICAgICAgICBwcm9qZWN0X2Rlc2NyaXB0aW9uOiBcIlJlbW9kZWxcIixcbiAgICAvLyAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IFwiMjAxMy0xMC0xNFQxNjo0Mjo0MC44OTZaXCIsXG4gICAgLy8gICAgICAgICAgICB1cGRhdGVkX2F0OiBcIjIwMTMtMTAtMTRUMTY6NDI6NDAuOTAxWlwiLFxuICAgIC8vICAgICAgICAgICAgdXNlcl9pZDogMTQsXG4gICAgLy8gICAgICAgICAgICBjYXRlZ29yeTogXCJ3b29kIGZsb29yaW5nXCIsXG4gICAgLy8gICAgICAgICAgICBzdWJfY2F0ZWdvcnk6IFwicGluZVwiLFxuICAgIC8vICAgICAgICAgICAgdW5pdHM6IFwibGJzXCIsXG4gICAgLy8gICAgICAgICAgICB3ZWlnaHQ6IDUwMCxcbiAgICAvLyAgICAgICAgICAgIGNvMl9vZmZzZXQ6IDMuMDMsXG4gICAgLy8gICAgICAgICAgICBwcm9qZWN0X2lkOiA2LFxuICAgIC8vICAgICAgICAgICAgaXRlbV9kZXNjcmlwdGlvbjogXCJiYXJuIHdvb2RcIlxuICAgIC8vICAgICAgICB9XG4gICAgLy8gICAgXTtcbiAgICAvL31cblxuXG5cblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYucHJvamVjdExpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogc2VsZi5wcm9qZWN0TGlzdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy9xdWVyeS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHF1ZXJ5LnNsaWNlKDEpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyRm4ob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gKG9iai5wcm9qZWN0X25hbWUuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlYXJjaFRleHRDaGFuZ2UodGV4dCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVGV4dCBjaGFuZ2VkIHRvICcsIHRleHQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNlbGVjdGVkSXRlbUNoYW5nZShpdGVtKSB7XG4gICAgICAgIGlmICggaXRlbSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICBzZWxmLnByb2plY3RfbmFtZSA9ICcnO1xuICAgICAgICAgICAgc2VsZi5wcm9qZWN0X2Rlc2NyaXB0aW9uID0gJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuc2hvd0RlbGV0ZSA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDTElDSycpO1xuICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcbiAgICAgICAgICAgIC50aXRsZSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGl0ZW0/JylcbiAgICAgICAgICAgIC5jb250ZW50KCdUaGlzIHdpbGwgYmUgcGVybWFuZW50LicpXG4gICAgICAgICAgICAuYXJpYUxhYmVsKCdEZWxldGUgaXRlbSBwZXJtYW5lbnRseScpXG4gICAgICAgICAgICAub2soJ0RlbGV0ZScpXG4gICAgICAgICAgICAuY2FuY2VsKCdDYW5jZWwnKVxuICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcbiAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIGl0ZW0gaGFzIGJlZW4gZGVsZXRlZC4nO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5hbGVydCA9ICdZb3VyIGl0ZW0gaGFzIG5vdCBiZWVuIGRlbGV0ZWQuJztcbiAgICAgICAgfSk7XG4gICAgfTtcbi8vICAgIGZ1bmN0aW9uIERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2cpIHtcbi8vICAgICRzY29wZS5oaWRlID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbi8vICAgIH07XG4vLyAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuLy8gICAgfTtcbi8vICAgICRzY29wZS5hbnN3ZXIgPSBmdW5jdGlvbihhbnN3ZXIpIHtcbi8vICAgICAgICAkbWREaWFsb2cuaGlkZShhbnN3ZXIpO1xuLy8gICAgfTtcbi8vfVxuXG4gICAgZnVuY3Rpb24gZGVsZXRlUHJvamVjdEl0ZW0oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGVsZXRpbmcuLi5cIiwgc2VsZi5wcm9qZWN0X2lkKTtcbiAgICAgICAgLy8kaHR0cC51cGRhdGUoJy9wcm9qZWN0Jywgc2VsZi5pZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgLy9maW5kT25lIGFuZCBkZWxldGUgYnkgaWQgdXNpbmcgcHJvamVjdGxpc3QuaWRcbiAgICAgICAgLy8gICAgY29uc29sZS5sb2coXCJJdGVtIHdhcyBkZWxldGVkLlwiLCByZXNwb25zZSk7XG4gICAgICAgIC8vICAgIHNlbGYuZ2V0UHJvamVjdExpc3QoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzYXZlUHJvamVjdCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJTYXZpbmcuLi5cIiwgc2VsZi5pZCk7XG4gICAgICAgIC8vc2F2ZSBhbGwgcHJvamVjdCBmaWVsZHM/IGhvdyBkbyBJIGV2ZW4gZG8gdGhpcz9cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gY2FsY3VsYXRlUHJvamVjdFRvdGFsKCkge1xuICAgICAgICBwcm9qZWN0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBwcm9qZWN0VG90YWwgKz0gaXRlbS5jbzJfb2Zmc2V0O1xuICAgICAgICAgICAgY29uc29sZS5sb2cocHJvamVjdFRvdGFsKTtcbiAgICAgICAgcmV0dXJuIHByb2plY3RUb3RhbDtcblxuICAgIH0pXG4gICAgfVxuXG5cblxufV0pOyIsIi8vIFNlcnZpY2VzIGZvciBhdXRoZW50aWNhdGlvblxuYXBwLnNlcnZpY2UoJ2F1dGhTZXJ2aWNlJywgWyckd2luZG93JywgZnVuY3Rpb24gKCR3aW5kb3cpe1xuICAgIHRoaXMucGFyc2VKd3QgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgYmFzZTY0VXJsID0gdG9rZW4uc3BsaXQoJy4nKVsxXTtcbiAgICAgICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSgkd2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgICAgIH0gZWxzZSByZXR1cm4ge307XG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuID0gdG9rZW47XG4gICAgICAgIGNvbnNvbGUubG9nKCdTYXZlZCB0b2tlbjonLCR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuKTtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICB0aGlzLmlzQXV0aGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7XG4gICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMucGFyc2VKd3QodG9rZW4pO1xuICAgICAgICAgICAgdmFyIG5vdEV4cGlyZWQgPSBNYXRoLnJvdW5kKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCkgPD0gcGFyYW1zLmV4cDtcbiAgICAgICAgICAgIGlmICghbm90RXhwaXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90RXhwaXJlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICR3aW5kb3cubG9jYWxTdG9yYWdlLmp3dFRva2VuO1xuICAgIH07XG5cbiAgICAvLyBleHBvc2UgdXNlciBhcyBhbiBvYmplY3RcbiAgICB0aGlzLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlSnd0KHRoaXMuZ2V0VG9rZW4oKSlcbiAgICB9O1xufV0pO1xuXG5hcHAuZmFjdG9yeSgnYXV0aEludGVyY2VwdG9yJywgWyckcScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHEsICRsb2NhdGlvbiwgYXV0aFNlcnZpY2UpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLmlzQXV0aGVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYXV0aFNlcnZpY2UuZ2V0VG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWRcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG59XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
