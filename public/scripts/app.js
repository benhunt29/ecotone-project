<<<<<<< HEAD
var app=angular.module("ecotoneApp",["ngRoute","ngMaterial","ngMessages","validation.match"]);app.config(["$mdThemingProvider","$routeProvider","$locationProvider","$httpProvider",function(t,e,o,n){o.html5Mode(!0),t.theme("default").primaryPalette("green").accentPalette("blue-grey",{"default":"600"}).warnPalette("orange"),e.when("/",{templateUrl:"/views/calculator.html",controller:"calculateCtrl as ctrl"}).when("/login",{templateUrl:"/views/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:"/views/register.html",controller:"createAccountCtrl"}).when("/admin",{templateUrl:"/views/admin.html",controller:"adminCtrl as ctrl"}).when("/account",{templateUrl:"/views/account.html",controller:""}).when("/dashboard",{templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).when("/projects",{templateUrl:"/views/project.html",controller:"projectsCtrl as ctrl"}).when("/about",{templateUrl:"/views/about.html"}).when("/contact",{templateUrl:"/views/contact.html",controller:""}).when("/privacy",{templateUrl:"/views/privacy.html"}).when("/sources",{templateUrl:"/views/sources.html"}).otherwise({redirectTo:"/"})}]),app.controller("calculateCtrl",["$http","$mdDialog",function(t,e){function o(t){console.log("Text changed to ",t)}function n(t){void 0==t&&(s.category="",s.subcategory="",s.warmId="",s.weight="",s.conversion="",s.result="")}function r(){var e={warmId:s.warmId||s.category.secondaries[0].warm_id,weight:parseFloat(s.weight)*s.conversion};t.post("/calculations",e).then(function(t){s.result=Math.floor(1e3*Math.abs(t.data))/1e3})}function a(t){return t?s.list.filter(c(t)):s.list}function c(t){var e=t.toLowerCase();return function(t){return-1!=t.primary_cat.indexOf(e)}}function l(){console.log("SUBMIT!"),console.log(s.submission),t.post("/suggestion",s.submission).then(function(t){e.hide()})}function i(t){console.log("NEW SUGGESTION!",s.searchText),e.show({templateUrl:"/views/submit-modal.html",clickOutsideToClose:!0,controller:"calculateCtrl",controllerAs:"ctrl",locals:{material:s.searchText}})}t.get("/materials").then(function(t){var e=t.data;e.forEach(function(t){t.primary_cat=t.primary_cat.toLowerCase()}),s.list=e});var s=this;s.list="",s.result="",s.querySearch=a,s.selectedItemChange=n,s.searchTextChange=o,s.newSuggestion=i,s.submitSuggestion=l,s.units=[{name:"lbs",conversion:5e-4},{name:"kilos",conversion:.00110231},{name:"tons",conversion:1},{name:"metric tons",conversion:1.10231}],s.submission={email:"",material:"",notes:""},s.newCalculation=r}]),app.controller("adminCtrl",["$http",function(t){function e(e){var n=e.id;console.log(n),t.put("/suggestion/complete/"+n).then(function(t){o()})}function o(){t.get("/suggestion").then(function(t){var e=t.data;console.log(e),n.suggestions=e})}o();var n=this;n.suggestions="",n.markComplete=e}]),app.controller("createAccountCtrl",["$scope","$http","$location",function(t,e,o){t.user={},t.processForm=function(n){console.log("Posting..."),e({method:"POST",url:"/register",data:t.user,dataType:"json"}).then(function(t){console.log(t),o.path("/login"),alert("Your account has been created.")})}}]),app.controller("loginCtrl",["$scope","$http","authService","$location","$rootScope",function(t,e,o,n,r){t.login=function(){e({method:"POST",url:"/login",data:t.form}).then(function(t){o.saveToken(t.data.token),r.user=o.getUser(),n.path("/")})}}]),app.controller("navCtrl",["authService","$scope","$rootScope","$location","$http",function(t,e,o,n,r){o.user=t.getUser(),o.user&&o.user.username&&n.path("/"),e.logout=function(){t.logout(),o.user=t.getUser(),n.path("/")}}]),app.controller("projectsCtrl",["$scope","$http",function(t,e){function o(t){return t?l.projectList.filter(n(t)):l.projectList}function n(t){var e=t.toLowerCase();return function(t){return-1!=t.primary_cat.indexOf(e)}}function r(t){console.log("Text changed to ",t)}function a(t){void 0==t&&(l.project_name="",l.project_description="")}function c(){console.log("Deleting...",l.projectList.ID)}var l=this;l.projectList="",l.result="",l.querySearch=o,l.selectedItemChange=a,l.searchTextChange=r,l.projectTotal=0,l.deleteProjectItem=c,l.id=0,l.getProjectList=function(){e.get("/project",userid).then(function(t){console.log(t);var e=t.data;e.forEach(function(t){t.project_name=t.project_name.toLowerCase(),t.project_description=t.project_description,t.id=t.id}),l.projectList=e})}}]),app.controller("dashboardCtrl",["$scope","$http",function(t,e){e.get("/project").then(function(e){console.log(e),t.projectList=e.data})}]),app.service("authService",["$window",function(t){this.parseJwt=function(e){if(e){var o=e.split(".")[1],n=o.replace("-","+").replace("_","/");return JSON.parse(t.atob(n))}return{}},this.saveToken=function(e){t.localStorage.jwtToken=e,console.log("Saved token:",t.localStorage.jwtToken)},this.getToken=function(){return t.localStorage.jwtToken},this.isAuthed=function(){var t=this.getToken();if(t){var e=this.parseJwt(t),o=Math.round((new Date).getTime()/1e3)<=e.exp;return o||this.logout(),o}return!1},this.logout=function(){delete t.localStorage.jwtToken},this.getUser=function(){return this.parseJwt(this.getToken())}}]),app.factory("authInterceptor",["$q","$location","authService",function(t,e,o){return{request:function(t){return t.headers=t.headers||{},o.isAuthed()&&(t.headers.Authorization="Bearer "+o.getToken()),t},response:function(o){return 401===o.status&&e.path("/login"),o||t.when(o)},responseError:function(o){return 401===o.status?e.path("/login"):console.log(o),t.reject(o)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvYXBwLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkcm91dGVQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsImh0bWw1TW9kZSIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiZGVmYXVsdCIsIndhcm5QYWxldHRlIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCIkaHR0cCIsIiRtZERpYWxvZyIsInNlYXJjaFRleHRDaGFuZ2UiLCJ0ZXh0IiwiY29uc29sZSIsImxvZyIsInNlbGVjdGVkSXRlbUNoYW5nZSIsIml0ZW0iLCJ1bmRlZmluZWQiLCJzZWxmIiwiY2F0ZWdvcnkiLCJzdWJjYXRlZ29yeSIsIndhcm1JZCIsIndlaWdodCIsImNvbnZlcnNpb24iLCJyZXN1bHQiLCJuZXdDYWxjdWxhdGlvbiIsImNhbGN1bGF0ZSIsInNlY29uZGFyaWVzIiwid2FybV9pZCIsInBhcnNlRmxvYXQiLCJwb3N0IiwidGhlbiIsInJlc3BvbnNlIiwiTWF0aCIsImZsb29yIiwiYWJzIiwiZGF0YSIsInF1ZXJ5U2VhcmNoIiwicXVlcnkiLCJsaXN0IiwiZmlsdGVyIiwiY3JlYXRlRmlsdGVyRm9yIiwibG93ZXJjYXNlUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsIm9iaiIsInByaW1hcnlfY2F0IiwiaW5kZXhPZiIsInN1Ym1pdFN1Z2dlc3Rpb24iLCJzdWJtaXNzaW9uIiwicmVzIiwiaGlkZSIsIm5ld1N1Z2dlc3Rpb24iLCJzdWdnZXN0aW9uIiwic2VhcmNoVGV4dCIsInNob3ciLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiY29udHJvbGxlckFzIiwibG9jYWxzIiwibWF0ZXJpYWwiLCJnZXQiLCJmb3JFYWNoIiwidGhpcyIsInVuaXRzIiwibmFtZSIsImVtYWlsIiwibm90ZXMiLCJtYXJrQ29tcGxldGUiLCJpZCIsInB1dCIsImluaXQiLCJzdWdnZXN0aW9ucyIsIiRzY29wZSIsIiRsb2NhdGlvbiIsInVzZXIiLCJwcm9jZXNzRm9ybSIsIm1ldGhvZCIsInVybCIsImRhdGFUeXBlIiwicGF0aCIsImFsZXJ0IiwiYXV0aFNlcnZpY2UiLCIkcm9vdFNjb3BlIiwibG9naW4iLCJmb3JtIiwic2F2ZVRva2VuIiwidG9rZW4iLCJnZXRVc2VyIiwidXNlcm5hbWUiLCJsb2dvdXQiLCJwcm9qZWN0TGlzdCIsInByb2plY3RfbmFtZSIsInByb2plY3RfZGVzY3JpcHRpb24iLCJkZWxldGVQcm9qZWN0SXRlbSIsIklEIiwicHJvamVjdFRvdGFsIiwiZ2V0UHJvamVjdExpc3QiLCJ1c2VyaWQiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInBhcnNlSnd0IiwiYmFzZTY0VXJsIiwic3BsaXQiLCJiYXNlNjQiLCJyZXBsYWNlIiwiSlNPTiIsInBhcnNlIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImp3dFRva2VuIiwiZ2V0VG9rZW4iLCJpc0F1dGhlZCIsInBhcmFtcyIsIm5vdEV4cGlyZWQiLCJyb3VuZCIsIkRhdGUiLCJnZXRUaW1lIiwiZXhwIiwiZmFjdG9yeSIsIiRxIiwicmVxdWVzdCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwic3RhdHVzIiwicmVzcG9uc2VFcnJvciIsInJlamVjdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsS0FBTUMsUUFBUUMsT0FBTyxjQUFlLFVBQVcsYUFBYyxhQUFjLG9CQUUvRUYsS0FBSUcsUUFBUSxxQkFBc0IsaUJBQWtCLG9CQUFxQixnQkFBaUIsU0FBU0MsRUFBb0JDLEVBQWdCQyxFQUFtQkMsR0FDdEpELEVBQWtCRSxXQUFVLEdBRzVCSixFQUFtQkssTUFBTSxXQUNwQkMsZUFBZSxTQUNmQyxjQUFjLGFBQWNDLFVBQVUsUUFDdENDLFlBQWEsVUFHbEJSLEVBQWVTLEtBQUssS0FFWkMsWUFBYSx5QkFDYkMsV0FBWSwwQkFDYkYsS0FBSyxV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QixVQUFZekMsRUFBWTZCLFlBRXBEcEgsR0FFWHVDLFNBQVUsU0FBVUEsR0FPaEIsTUFMd0IsT0FBcEJBLEVBQVMwRixRQUdUbEQsRUFBVU0sS0FBSyxVQUVaOUMsR0FBWXNGLEVBQUdsSCxLQUFLNEIsSUFDNUIyRixjQUFlLFNBQVUzRixHQU94QixNQU53QixPQUFwQkEsRUFBUzBGLE9BQ1RsRCxFQUFVTSxLQUFLLFVBR2ZqRSxRQUFRQyxJQUFJa0IsR0FFVHNGLEVBQUdNLE9BQU81RiIsImZpbGUiOiJzY3JpcHRzL2FwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZWNvdG9uZUFwcCcsIFsnbmdSb3V0ZScsICduZ01hdGVyaWFsJywgJ25nTWVzc2FnZXMnLCAndmFsaWRhdGlvbi5tYXRjaCddKTtcblxuYXBwLmNvbmZpZyhbJyRtZFRoZW1pbmdQcm92aWRlcicsICckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJG1kVGhlbWluZ1Byb3ZpZGVyLCAkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICRodHRwUHJvdmlkZXIpe1xuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblxuICAgIC8vc2V0IHRoZW1lIGFuZCBjb2xvciBwYWxldHRlXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcbiAgICAgICAgLnByaW1hcnlQYWxldHRlKCdncmVlbicpXG4gICAgICAgIC5hY2NlbnRQYWxldHRlKCdibHVlLWdyZXknLCB7J2RlZmF1bHQnOic2MDAnfSlcbiAgICAgICAgLndhcm5QYWxldHRlICgnb3JhbmdlJyk7XG5cbiAgICAvL3JvdXRlcyBmb3Igdmlld3NcbiAgICAkcm91dGVQcm92aWRlci53aGVuKCcvJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvY2FsY3VsYXRvci5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWxjdWxhdGVDdHJsIGFzIGN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9sb2dpbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICAgICAgfSkud2hlbignL3JlZ2lzdGVyJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcmVnaXN0ZXIuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY3JlYXRlQWNjb3VudEN0cmwnXG4gICAgICAgIH0pLndoZW4oJy9hZG1pbicsXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2FkbWluLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2FkbWluQ3RybCBhcyBjdHJsJ1xuXG4gICAgICAgIH0pLndoZW4oJy9hY2NvdW50JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWNjb3VudC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICcnXG4gICAgICAgIH0pLndoZW4oJy9kYXNoYm9hcmQnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ3RybCdcbiAgICAgICAgfSkud2hlbignL3Byb2plY3RzJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcHJvamVjdC5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwcm9qZWN0c0N0cmwgYXMgY3RybCdcbiAgICAgICAgfSkud2hlbignL2Fib3V0JyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvYWJvdXQuaHRtbCdcbiAgICAgICAgfSkud2hlbignL2NvbnRhY3QnLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9jb250YWN0Lmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcbiAgICAgICAgfSkud2hlbignL3ByaXZhY3knLFxuICAgICAgICB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wcml2YWN5Lmh0bWwnXG4gICAgICAgIH0pLndoZW4oJy9zb3VyY2VzJyxcbiAgICAgICAge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3Mvc291cmNlcy5odG1sJ1xuICAgICAgICB9KS5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgcmVkaXJlY3RUbzogJy8nXG4gICAgICAgIH0pO1xuXG4gICAgLy8kaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdhdXRoSW50ZXJjZXB0b3InKTtcbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2NhbGN1bGF0ZUN0cmwnLCBbJyRodHRwJywgJyRtZERpYWxvZycsIGZ1bmN0aW9uKCAkaHR0cCwgJG1kRGlhbG9nICkge1xuICAgIC8vIElOSVRcbiAgICAkaHR0cC5nZXQoJy9tYXRlcmlhbHMnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHZhciBsaXN0ID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICBpdGVtLnByaW1hcnlfY2F0ID0gaXRlbS5wcmltYXJ5X2NhdC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgLy8gL2l0ZW0ucHJpbWFyeV9jYXQgPSBpdGVtLnByaW1hcnlfY2F0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgaXRlbS5wcmltYXJ5X2NhdC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLmxpc3QgPSBsaXN0O1xuXG4gICAgfSk7XG5cbiAgICAvLyBTZWxmIGRlY1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHNlbGYubGlzdCA9ICcnO1xuICAgIHNlbGYucmVzdWx0ID0gJyc7XG4gICAgc2VsZi5xdWVyeVNlYXJjaCA9IHF1ZXJ5U2VhcmNoO1xuICAgIHNlbGYuc2VsZWN0ZWRJdGVtQ2hhbmdlID0gc2VsZWN0ZWRJdGVtQ2hhbmdlO1xuICAgIHNlbGYuc2VhcmNoVGV4dENoYW5nZSAgID0gc2VhcmNoVGV4dENoYW5nZTtcbiAgICBzZWxmLm5ld1N1Z2dlc3Rpb24gPSBuZXdTdWdnZXN0aW9uO1xuICAgIHNlbGYuc3VibWl0U3VnZ2VzdGlvbiA9IHN1Ym1pdFN1Z2dlc3Rpb247XG4gICAgc2VsZi51bml0cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ2xicycsXG4gICAgICAgICAgICBjb252ZXJzaW9uOiAwLjAwMDVcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ2tpbG9zJyxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IDAuMDAxMTAyMzFcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ3RvbnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnbWV0cmljIHRvbnMnLFxuICAgICAgICAgICAgY29udmVyc2lvbjogMS4xMDIzMVxuICAgICAgICB9XG4gICAgXTtcbiAgICBzZWxmLnN1Ym1pc3Npb24gPSB7XG4gICAgICAgIGVtYWlsOiAnJyxcbiAgICAgICAgbWF0ZXJpYWw6ICcnLFxuICAgICAgICBub3RlczogJydcbiAgICB9O1xuICAgIHNlbGYubmV3Q2FsY3VsYXRpb24gPSBuZXdDYWxjdWxhdGlvbjtcblxuXG4gICAgZnVuY3Rpb24gc2VhcmNoVGV4dENoYW5nZSh0ZXh0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IGNoYW5nZWQgdG8gJywgdGV4dCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlKGl0ZW0pIHtcbiAgICAgICAgaWYgKCBpdGVtID09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHNlbGYuY2F0ZWdvcnkgPSAnJztcbiAgICAgICAgICAgIHNlbGYuc3ViY2F0ZWdvcnkgPSAnJztcbiAgICAgICAgICAgIHNlbGYud2FybUlkID0gJyc7XG4gICAgICAgICAgICBzZWxmLndlaWdodCA9ICcnO1xuICAgICAgICAgICAgc2VsZi5jb252ZXJzaW9uID0gJyc7XG4gICAgICAgICAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3Q2FsY3VsYXRpb24oKSB7XG5cbiAgICAgICAgdmFyIGNhbGN1bGF0ZSA9IHtcbiAgICAgICAgICAgIHdhcm1JZDogc2VsZi53YXJtSWQgfHwgc2VsZi5jYXRlZ29yeS5zZWNvbmRhcmllc1swXS53YXJtX2lkLFxuICAgICAgICAgICAgd2VpZ2h0OiBwYXJzZUZsb2F0KHNlbGYud2VpZ2h0KSAqIHNlbGYuY29udmVyc2lvblxuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwLnBvc3QoJy9jYWxjdWxhdGlvbnMnLCBjYWxjdWxhdGUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHNlbGYucmVzdWx0ID0gTWF0aC5mbG9vcihNYXRoLmFicyhyZXNwb25zZS5kYXRhKSAqIDEwMDApIC8gMTAwMDtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZVRvUHJvamVjdCgpe1xuICAgICAgICB2YXIgbGluZUl0ZW0gPSB7XG4gICAgICAgICAgICBjYXRlZ29yeTogc2VsZi5jYXRlZ29yeSxcbiAgICAgICAgICAgIHN1YmNhdGVnb3J5OiBzZWxmLnN1YmNhdGVnb3J5LFxuICAgICAgICAgICAgd2FybV9JZDogc2VsZi53YXJtSWQsXG4gICAgICAgICAgICB3ZWlnaHQ6IHBhcnNlRmxvYXQoc2VsZi53ZWlnaHQpKnNlbGYuY29udmVyc2lvbixcbiAgICAgICAgICAgIHVuaXRzOiBzZWxmLnVuaXQubmFtZVxuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmxvZyhsaW5lSXRlbSk7XG4gICAgICAgICRodHRwLnBvc3QoJy9hZGRUb1Byb2plY3QnKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYubGlzdC5maWx0ZXIoY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSkgOiBzZWxmLmxpc3Q7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRmlsdGVyRm9yKHF1ZXJ5KSB7XG4gICAgICAgIHZhciBsb3dlcmNhc2VRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vcXVlcnkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBxdWVyeS5zbGljZSgxKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZpbHRlckZuKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmoucHJpbWFyeV9jYXQuaW5kZXhPZihsb3dlcmNhc2VRdWVyeSkgIT0gLTEpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN1Ym1pdFN1Z2dlc3Rpb24oKXtcbiAgICAgICAgY29uc29sZS5sb2coJ1NVQk1JVCEnKTtcbiAgICAgICAgY29uc29sZS5sb2coc2VsZi5zdWJtaXNzaW9uKTtcbiAgICAgICAgJGh0dHAucG9zdCgnL3N1Z2dlc3Rpb24nLCBzZWxmLnN1Ym1pc3Npb24pLnRoZW4oZnVuY3Rpb24oIHJlcyApe1xuICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXdTdWdnZXN0aW9uKCBzdWdnZXN0aW9uICl7XG4gICAgICAgIGNvbnNvbGUubG9nKCdORVcgU1VHR0VTVElPTiEnLCBzZWxmLnNlYXJjaFRleHQpO1xuXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3N1Ym1pdC1tb2RhbC5odG1sJyxcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FsY3VsYXRlQ3RybCcsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6ICdjdHJsJyxcbiAgICAgICAgICAgIGxvY2Fsczoge21hdGVyaWFsOiBzZWxmLnNlYXJjaFRleHR9XG4gICAgICAgIH0pXG5cbiAgICB9XG5cblxufV0pO1xuXG4vKipcbiAqIEFETUlOXG4gKi9cbmFwcC5jb250cm9sbGVyKCdhZG1pbkN0cmwnLCBbJyRodHRwJywgZnVuY3Rpb24oICRodHRwICl7XG4gICAgLy8gSU5JVFxuICAgIGluaXQoKTtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLnN1Z2dlc3Rpb25zID0gJyc7XG4gICAgc2VsZi5tYXJrQ29tcGxldGUgPSBtYXJrQ29tcGxldGU7XG5cbiAgICBmdW5jdGlvbiBtYXJrQ29tcGxldGUoIHN1Z2dlc3Rpb24gKSB7XG4gICAgICAgIHZhciBpZCA9IHN1Z2dlc3Rpb24uaWQ7XG4gICAgICAgIGNvbnNvbGUubG9nKGlkKTtcbiAgICAgICAgJGh0dHAucHV0KCcvc3VnZ2VzdGlvbi9jb21wbGV0ZS8nICsgaWQpLnRoZW4oZnVuY3Rpb24oIHJlcyApIHtcbiAgICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgJGh0dHAuZ2V0KCcvc3VnZ2VzdGlvbicpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgdmFyIHN1Z2dlc3Rpb25zID0gcmVzLmRhdGE7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdWdnZXN0aW9ucyk7XG4gICAgICAgICAgICBzZWxmLnN1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbnM7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG59XSk7XG5cbi8vIFJlZ2lzdGVyIEhUTUwgLSBNYWRlbGluZVxuYXBwLmNvbnRyb2xsZXIoJ2NyZWF0ZUFjY291bnRDdHJsJywgWyckc2NvcGUnLCAnJGh0dHAnLCAnJGxvY2F0aW9uJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB7fTtcblxuICAgICRzY29wZS5wcm9jZXNzRm9ybSA9IGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUG9zdGluZy4uLlwiKTtcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgICAgICAgZGF0YTogJHNjb3BlLnVzZXIsXG4gICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG4gICAgICAgICAgICBhbGVydChcIllvdXIgYWNjb3VudCBoYXMgYmVlbiBjcmVhdGVkLlwiKVxuICAgICAgICB9KVxuICAgIH07XG59XSk7XG5cblxuLy8gTG9naW4gSFRNTCAtIEthdGVcbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBbJyRzY29wZScsICckaHR0cCcsICdhdXRoU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIGF1dGhTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpIHtcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgICAgIGRhdGE6ICRzY29wZS5mb3JtXG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgYXV0aFNlcnZpY2Uuc2F2ZVRva2VuKHJlc3BvbnNlLmRhdGEudG9rZW4pO1xuICAgICAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgfSlcbiAgICB9XG59XSk7XG5cbi8vIENoYW5nZSBOYXZpZ2F0aW9uIE9wdGlvbnMgd2l0aCBMb2dpblxuYXBwLmNvbnRyb2xsZXIoJ25hdkN0cmwnLCBbJ2F1dGhTZXJ2aWNlJywgJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbicsICckaHR0cCcsIGZ1bmN0aW9uKGF1dGhTZXJ2aWNlLCAkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbiwgJGh0dHApe1xuICAgICRyb290U2NvcGUudXNlciA9IGF1dGhTZXJ2aWNlLmdldFVzZXIoKTtcblxuICAgIGlmKCRyb290U2NvcGUudXNlciAmJiAkcm9vdFNjb3BlLnVzZXIudXNlcm5hbWUpe1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cblxuICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgJHJvb3RTY29wZS51c2VyID0gYXV0aFNlcnZpY2UuZ2V0VXNlcigpO1xuICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgIH1cbn1dKTtcblxuLy8gUHJvamVjdCBQYWdlIC0gIEtpbS9NYWRlbGVpbmVcbmFwcC5jb250cm9sbGVyKCdwcm9qZWN0c0N0cmwnLCBbJyRzY29wZScsICckaHR0cCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApIHtcblxuICAgIC8vIFNlbGYgZGVjXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYucHJvamVjdExpc3QgPSAnJztcbiAgICBzZWxmLnJlc3VsdCA9ICcnO1xuICAgIHNlbGYucXVlcnlTZWFyY2ggPSBxdWVyeVNlYXJjaDtcbiAgICBzZWxmLnNlbGVjdGVkSXRlbUNoYW5nZSA9IHNlbGVjdGVkSXRlbUNoYW5nZTtcbiAgICBzZWxmLnNlYXJjaFRleHRDaGFuZ2UgPSBzZWFyY2hUZXh0Q2hhbmdlO1xuICAgIHNlbGYucHJvamVjdFRvdGFsPSAwO1xuICAgIHNlbGYuZGVsZXRlUHJvamVjdEl0ZW0gPSBkZWxldGVQcm9qZWN0SXRlbTtcbiAgICBzZWxmLmlkID0gMDtcblxuXG4gICAgLy9sb2FkIHByb2plY3QgbGlzdCBvbiBwYWdlIGxvYWRcbiAgICBzZWxmLmdldFByb2plY3RMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vbmVlZCB0byBmaWd1cmUgb3V0IGhvdyB0byBwYXNzIHRoZSB1c2VyaWQgZnJvbSB0aGUgbG9naW4gcGFnZS0tdXNlIHRoZSBzYW1lIGNvbnRyb2xsZXI/XG4gICAgICAgICRodHRwLmdldCgnL3Byb2plY3QnLCB1c2VyaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgICAgICB2YXIgcHJvamVjdExpc3QgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgcHJvamVjdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGl0ZW0ucHJvamVjdF9uYW1lID0gaXRlbS5wcm9qZWN0X25hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBpdGVtLnByb2plY3RfZGVzY3JpcHRpb24gPSBpdGVtLnByb2plY3RfZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgaXRlbS5pZCA9IGl0ZW0uaWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlbGYucHJvamVjdExpc3QgPSBwcm9qZWN0TGlzdDtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHF1ZXJ5U2VhcmNoKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBxdWVyeSA/IHNlbGYucHJvamVjdExpc3QuZmlsdGVyKGNyZWF0ZUZpbHRlckZvcihxdWVyeSkpIDogc2VsZi5wcm9qZWN0TGlzdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVGaWx0ZXJGb3IocXVlcnkpIHtcbiAgICAgICAgdmFyIGxvd2VyY2FzZVF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy9xdWVyeS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHF1ZXJ5LnNsaWNlKDEpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZmlsdGVyRm4ob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gKG9iai5wcmltYXJ5X2NhdC5pbmRleE9mKGxvd2VyY2FzZVF1ZXJ5KSAhPSAtMSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VhcmNoVGV4dENoYW5nZSh0ZXh0KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdUZXh0IGNoYW5nZWQgdG8gJywgdGV4dCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VsZWN0ZWRJdGVtQ2hhbmdlKGl0ZW0pIHtcbiAgICAgICAgaWYgKCBpdGVtID09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHNlbGYucHJvamVjdF9uYW1lID0gJyc7XG4gICAgICAgICAgICBzZWxmLnByb2plY3RfZGVzY3JpcHRpb24gPSAnJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkZWxldGVQcm9qZWN0SXRlbSgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEZWxldGluZy4uLlwiLCBzZWxmLnByb2plY3RMaXN0LklEKTtcbiAgICAgICAgLy8kaHR0cC51cGRhdGUoJy9wcm9qZWN0JykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgLy9maW5kT25lIGFuZCBkZWxldGUgYnkgaWQgdXNpbmcgcHJvamVjdGxpc3QuaWRcbiAgICAgICAgLy8gICAgY29uc29sZS5sb2coXCJJdGVtIHdhcyBkZWxldGVkLlwiLCByZXNwb25zZSk7XG4gICAgICAgIC8vICAgIHNlbGYuZ2V0UHJvamVjdExpc3QoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL3NlbGYuY2FsY3VsYXRlUHJvamVjdFRvdGFsKCl7XG4gICAgICAgIC8vLy9mb3JFYWNoIHByb2plY3RcbiAgICAgICAgLy8gICAgdmFyIHByb2plY3RUb3RhbCs9cHJvamVjdExpc3QuY28yX29mZnNldDtcbiAgICAgICAgLy8gICAgcmV0dXJuIHByb2plY3RUb3RhbDtcbiAgICAgICAgLy99XG4gICAgLy99O1xufV0pO1xuXG5cbi8vRGFzaGJvYXJkIFBhZ2UgLSBLaW0vTWFkZWxlaW5lXG5hcHAuY29udHJvbGxlcignZGFzaGJvYXJkQ3RybCcsIFsnJHNjb3BlJywgJyRodHRwJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCkge1xuICAgIC8vbG9hZCBwcm9qZWN0IGxpc3Qgb24gcGFnZSBsb2FkXG4gICAgJGh0dHAuZ2V0KCcvcHJvamVjdCcpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAkc2NvcGUucHJvamVjdExpc3QgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAvL3Jlc3BvbnNlLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgLy8gICAgaXRlbS5wcm9qZWN0X25hbWUgPSBpdGVtLnByaW1hcnlfY2F0LnRvTG93ZXJDYXNlKCk7XG4gICAgfSk7XG59XSk7XG5cblxuLy8gU2VydmljZXMgZm9yIGF1dGhlbnRpY2F0aW9uXG5hcHAuc2VydmljZSgnYXV0aFNlcnZpY2UnLCBbJyR3aW5kb3cnLCBmdW5jdGlvbiAoJHdpbmRvdyl7XG4gICAgdGhpcy5wYXJzZUp3dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgdmFyIGJhc2U2NCA9IGJhc2U2NFVybC5yZXBsYWNlKCctJywgJysnKS5yZXBsYWNlKCdfJywgJy8nKTtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKCR3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICAgICAgfSBlbHNlIHJldHVybiB7fTtcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlVG9rZW4gPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4gPSB0b2tlbjtcbiAgICAgICAgY29uc29sZS5sb2coJ1NhdmVkIHRva2VuOicsJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW4pO1xuICAgIH07XG5cbiAgICB0aGlzLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIHRoaXMuaXNBdXRoZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRoaXMuZ2V0VG9rZW4oKTtcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5wYXJzZUp3dCh0b2tlbik7XG4gICAgICAgICAgICB2YXIgbm90RXhwaXJlZCA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSA8PSBwYXJhbXMuZXhwO1xuICAgICAgICAgICAgaWYgKCFub3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub3RFeHBpcmVkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkZWxldGUgJHdpbmRvdy5sb2NhbFN0b3JhZ2Uuand0VG9rZW47XG4gICAgfTtcblxuICAgIC8vIGV4cG9zZSB1c2VyIGFzIGFuIG9iamVjdFxuICAgIHRoaXMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VKd3QodGhpcy5nZXRUb2tlbigpKVxuICAgIH07XG59XSk7XG5cbmFwcC5mYWN0b3J5KCdhdXRoSW50ZXJjZXB0b3InLCBbJyRxJywgJyRsb2NhdGlvbicsICdhdXRoU2VydmljZScsIGZ1bmN0aW9uICgkcSwgJGxvY2F0aW9uLCBhdXRoU2VydmljZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XG4gICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UuaXNBdXRoZWQoKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyBhdXRoU2VydmljZS5nZXRUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcbiAgICAgICAgfSxcbiAgICAgICAgcmVzcG9uc2U6IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcblxuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSB0aGUgY2FzZSB3aGVyZSB0aGUgdXNlciBpcyBub3QgYXV0aGVudGljYXRlZFxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8ICRxLndoZW4ocmVzcG9uc2UpO1xuICAgICAgICB9LCByZXNwb25zZUVycm9yOiBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
=======
>>>>>>> 6b73591a521de00bdb886ab14b02976a6a6de5fa
